(function() {
    'use strict';

    angular
        .module('notosplus', [
            //shared modules
            'notosplus.core',
            'notosplus.widgets',
            'notosplus.auth',
            'notosplus.data',
            'notosplus.layout',

            //app modules
            'notosplus.dashboard',
            'notosplus.manage',
            'notosplus.library',
            'notosplus.curricula',
            'notosplus.tags'
        ]);
})();

angular
    .module('notosplus.core', [
        //Angular
        'ngAnimate', 'ngSanitize', 'ngResource',

        //3rd party
        'ui.bootstrap',
        'ncy-angular-breadcrumb',
        'breeze.angular',   // tells breeze to use $q instead of Q.js
        'breeze.directives',// breeze validation directive (zValidate),
        'ngzWip',
        'ngplus',
        'restangular',
        'checklist-model',
        'ngTagsInput',

        //cross app modules
        'blocks.exception',
        'blocks.logger',
        'blocks.router'
    ]);
(function () {
    'use strict';

    angular
        .module('notosplus.data', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.auth', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.curricula', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.dashboard', [

        ]);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.layout', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.library', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.manage', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.tags', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.widgets', []);
})();
(function () {
    'use strict';

    angular
        .module('blocks.exception', ['blocks.logger']);
})();
(function () {
    'use strict';

    angular
        .module('blocks.logger', []);
})();
(function () {
    'use strict';

    angular
        .module('blocks.router', [
            'ui.router'
        ]);
})();
/**
 * notosplus.core
 * FACTORY: bootstrap.dialog
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('Dialog', modalDialog);

    /* @ngInject */
    function modalDialog($modal, $templateCache) {
        var service = {
            deleteDialog: deleteDialog,
            confirmationDialog: confirmationDialog,
            resetPasswordDialog: resetPasswordDialog
        };

        registerModelDialog($templateCache);
        registerResetPasswordDialog($templateCache);

        return service;
        ////////////////

        function deleteDialog(itemName) {
            var title = 'Ben je zeker?';
            itemName = itemName || 'item';
            var msg = 'Verwijder ' + itemName + '?';

            return confirmationDialog(title, msg);
        }

        function confirmationDialog(title, msg, okText, cancelText) {
            var modalOptions = {
                templateUrl: 'modalDialog.tpl.html',
                controller: ModalInstance,
                keyboard: true,
                resolve: {
                    options: function () {
                        return {
                            title: title,
                            message: msg,
                            okText: okText,
                            cancelText: cancelText,
                            password: '',
                            confirmPassword: ''
                        };
                    }
                }
            };

            return $modal.open(modalOptions).result;
        }

        function resetPasswordDialog(title, msg, okText, cancelText) {
            var modalOptions = {
                templateUrl: 'resetPasswordDialog.tpl.html',
                controller: ResetPasswordModalInstance,
                keyboard: true,
                resolve: {
                    options: function () {
                        return {
                            title: title,
                            message: msg,
                            okText: okText,
                            cancelText: cancelText,
                            password: '',
                            confirmPassword: ''
                        };
                    }
                }
            };

            return $modal.open(modalOptions).result;
        }


    }
    modalDialog.$inject = ["$modal", "$templateCache"];

    /* @ngInject */
    function ModalInstance($scope, $modalInstance, options) {
        $scope.title = options.title || 'Titel';
        $scope.message = options.message || '';
        $scope.okText = options.okText || 'Ok';
        $scope.cancelText = options.cancelText || 'Annuleren';
        $scope.ok = function () {
            $modalInstance.close('ok');
        };
        $scope.cancel = function () {
            $modalInstance.dismiss('cancel');
        };
    }
    ModalInstance.$inject = ["$scope", "$modalInstance", "options"];

    /* @ngInject */
    function ResetPasswordModalInstance($scope, $modalInstance, options) {
        $scope.title = options.title || 'Paswoord opnieuw instellen';
        $scope.message = options.message || 'Geef het nieuwe paswoord in.';
        $scope.okText = options.okText || 'Wijzig';
        $scope.cancelText = options.cancelText || 'Annuleren';
        $scope.password = '';
        $scope.confirmPassword = '';
        $scope.ok = function () {
            $modalInstance.close({password: $scope.password});
        };
        $scope.cancel = function () {
            $modalInstance.dismiss('cancel');
        };
    }
    ResetPasswordModalInstance.$inject = ["$scope", "$modalInstance", "options"];

    function registerModelDialog($templateCache) {
        $templateCache.put('modalDialog.tpl.html',
            '<div>' +
            '    <div class="modal-header">' +
            '        <button type="button" class="close" data-dismiss="modal" ' +
            '            aria-hidden="true" data-ng-click="cancel()">&times;</button>' +
            '        <h3>{{title}}</h3>' +
            '    </div>' +
            '    <div class="modal-body">' +
            '        <p>{{message}}</p>' +
            '    </div>' +
            '    <div class="modal-footer">' +
            '        <button class="btn btn-primary" data-ng-click="ok()">{{okText}}</button>' +
            '        <button class="btn btn-info" data-ng-click="cancel()">{{cancelText}}</button>' +
            '    </div>' +
            '</div>');
    }

    function registerResetPasswordDialog($templateCache) {
        $templateCache.put('resetPasswordDialog.tpl.html',
            '<div>' +
            '    <div class="modal-header">' +
            '        <button type="button" class="close" data-dismiss="modal" ' +
            '            aria-hidden="true" data-ng-click="cancel()">&times;</button>' +
            '        <h3>{{title}}</h3>' +
            '    </div>' +
            '    <div class="modal-body">' +
            '        <p>{{message}}</p>' +
            '        <div class="form-group">' +
            '           <label class="control-label">Paswoord</label>' +
            '           <input type="password" data-ng-model="password" placeholder="Nieuw paswoord" class="form-control">' +
            '        </div>' +
            '        <div class="form-group">' +
            '           <label class="control-label">Herhaal password</label>' +
            '           <input type="password" data-ng-model="confirmPassword" placeholder="Herhaal paswoord" class="form-control">' +
            '        </div>' +
            '        <div class="form-group">' +
            '           <span class="text-danger" data-ng-show="password !== confirmPassword && password !== \'\'">De paswoorden komen niet overeen.</span>' +
            '        </div>' +
            '    </div>' +
            '    <div class="modal-footer">' +
            '        <button class="btn btn-primary" data-ng-click="ok()" data-ng-disabled="password !== confirmPassword || password === \'\'">{{okText}}</button>' +
            '        <button class="btn btn-info" data-ng-click="cancel()">{{cancelText}}</button>' +
            '    </div>' +
            '</div>');
    }
})();
/**
 * notosplus.core
 * FACTORY: common
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('common', common);

    function common($q, $rootScope, $timeout, logger) {
        var throttles = {};

        var service = {
            // common angular dependencies
            $broadcast: $broadcast,
            $q: $q,
            $timeout: $timeout,
            // generic
            isNumber: isNumber,
            debouncedThrottle: debouncedThrottle,
            logger: logger,
            textContains: textContains
        }

        return service;
        ////////////////////////

        function $broadcast() {
            return $rootScope.$broadcast.apply($rootScope, arguments);
        }


        function debouncedThrottle(key, callback, delay, immediate) {
            // Perform some action (callback) after a delay.
            // Track the callback by key, so if the same callback
            // is issued again, restart the delay.
            var defaultDelay = 1000;
            delay = delay || defaultDelay;
            if (throttles[key]) {
                $timeout.cancel(throttles[key]);
                throttles[key] = undefined;
            }
            if (immediate) {
                callback();
            } else {
                throttles[key] = $timeout(callback, delay);
            }
        }

        function isNumber(val) {
            // negative or positive
            return (/^[-]?\d+$/).test(val);
        }

        function textContains(text, searchText) {
            return text && -1 !== text.toLowerCase().indexOf(searchText.toLowerCase());
        }
    }
    common.$inject = ["$q", "$rootScope", "$timeout", "logger"];
})();
/**
 * notosplus.data
 * FACTORY: breezeConfig
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('breezeConfig', breezeConfig);

    /* @ngInject */
    function breezeConfig(breeze) {
        var service = {
            remoteServiceName: '/api/breeze',
            breeze: breeze
        }

        return service;
        ////////////////
    }
    breezeConfig.$inject = ["breeze"];

})();
(function () {
    'use strict';

    var core = angular.module('notosplus.core');

    core.config(toastrConfig);

    /* @ngInject */
    function toastrConfig(toastr) {
        toastr.options.timeOut = 4000;
        toastr.options.closeButton = true;
        toastr.options.progressBar = true;
        toastr.options.positionClass = 'toast-bottom-right';
    }
    toastrConfig.$inject = ["toastr"];

    var keyCodes = {
        backspace: 8,
        tab: 9,
        enter: 13,
        esc: 27,
        space: 32,
        pageup: 33,
        pagedown: 34,
        end: 35,
        home: 36,
        left: 37,
        up: 38,
        right: 39,
        down: 40,
        insert: 45,
        del: 46
    };

    var events = {
        controllerActivateSuccess: 'controller.activateSuccess',
        entitiesChanged: 'datacontext.entitiesChanged',
        entitiesImported: 'datacontext.entitiesImported',
        hasChangesChanged: 'datacontext.hasChangesChanged',
        storage: {
            error: 'store.error',
            storeChanged: 'store.changed',
            wipChanged: 'wip.changed'
        },
        loggedInOrganizationChanged: 'profile.loggedInAtChanged'
    };


    var config = {
        appErrorPrefix: '[noTos+ Fout] ',
        appTitle: 'noTos+',
        keyCodes: keyCodes,
        version: '1.0.0',
        events: events
    };

    core.value('config', config);

    core.config(configure);

    /* @ngInject */
    function configure($urlRouterProvider, $stateProvider,
                       routehelperConfigProvider, $breadcrumbProvider,
                       zStorageConfigProvider, zDirectivesConfigProvider,
                       RestangularProvider) {

        configureRouting();
        configureBreadcrumb();

        configureZStorage();
        configureZValidate();

        configureRestangular();


        function configureRouting() {
            routehelperConfigProvider.config.$urlRouterProvider = $urlRouterProvider;
            routehelperConfigProvider.config.$stateProvider = $stateProvider;

            routehelperConfigProvider.config.title = config.appTitle;
        }

        function configureBreadcrumb() {
            $breadcrumbProvider.setOptions({
                prefixStateName: 'index',
                template: 'bootstrap3',
                includeAbstract: true
            });
        }

        function configureZStorage() {
            // Setup our Breeze-based offline storage
            zStorageConfigProvider.config = {
                // zStorage
                enabled: false,
                key: 'noTosPlus',
                events: config.events.storage,

                // zStorageWip
                wipKey: 'noTosPlus.wip',
                appErrorPrefix: config.appErrorPrefix,
                newGuid: breeze.core.getUuid,

                // zStorageCore
                version: config.version
            };
        }

        function configureZValidate() {
            zDirectivesConfigProvider.zValidateTemplate =
                '<span class="invalid"><i class="fa fa-warning-sign"></i>' +
                'Onbegrijpelijk! %error%</span>';

        }

        function configureRestangular() {
            var baseUrl = '/api';

            RestangularProvider.setBaseUrl(baseUrl);
        }
    }
    configure.$inject = ["$urlRouterProvider", "$stateProvider", "routehelperConfigProvider", "$breadcrumbProvider", "zStorageConfigProvider", "zDirectivesConfigProvider", "RestangularProvider"];
})();
/* global toastr:false, moment:false */
(function() {
    'use strict';

    angular
        .module('notosplus.core')
        .constant('toastr', toastr)
        .constant('moment', moment)
        .constant('_', window._);
})();
/**
 * notosplus.core
 * FACTORY: Init
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('Init', Init);

    /* @ngInject */
    function Init() {
        var wasInitialized = false;

        var service = {
            isInitialized: isInitialized,
            initializing: initializing
        }

        return service;
        ////////////////

        function isInitialized() {
            return wasInitialized;
        }
        function initializing(init) {
            wasInitialized = init;
        }

    }
})();
    /**
 * notosplus.core
 * FILTER: Highlight
 */
(function () {
    'use strict';

    angular
        .module('notosplus.data')
        .filter('Highlight', Highlight);

    /**
     *
     */
    function Highlight($sce) {
        return function (str, termsToHighlight) {
            if (termsToHighlight === '') {
                return $sce.trustAsHtml(str);
            }
            // Sort terms by length
            termsToHighlight = termsToHighlight.split(" ");
            termsToHighlight.sort(function (a, b) {
                return b.length - a.length;
            });

            // Regex to simultaneously replace terms
            var regex = new RegExp('(?!<[^>]*?>)' + termsToHighlight.join('|') + '(?![^<]*?</[^>]*?>)', 'gi');
            return $sce.trustAsHtml(str.replace(regex, '<span class="match">$&</span>'));
        };
    }
    Highlight.$inject = ["$sce"];

})();
/**
 * notosplus.data
 * FACTORY: HTTPCache
 */

(function () {
    'use strict';

    angular
        .module('notosplus.data')
        .factory('HTTPCache', HTTPCache);

    /* @ngInject */
    function HTTPCache(Restangular, $cacheFactory) {
        var cache;
        cache = $cacheFactory('http');

        return Restangular.withConfig(function (RestangularConfigurer) {
            RestangularConfigurer.setDefaultHttpFields({cache: cache});
            RestangularConfigurer.setResponseInterceptor(function (response, operation) {
                if (operation === 'put' || operation === 'post' || operation === 'delete') {
                    cache.removeAll();
                }
                return response;
            });

            // Custom Global Method(s) for Restangularized Elements.
            RestangularConfigurer.setOnElemRestangularized(function(elem, isCollection) {
                elem.clearCache = function() {
                    cache.removeAll();
                }
                return elem;
            });
        });
    }
    HTTPCache.$inject = ["Restangular", "$cacheFactory"];
})();
/**
 * notosplus.auth
 * FACTORY: Profile
 */

(function () {
    'use strict';

    angular
        .module('notosplus.auth')
        .factory('ProfileService', ProfileService);

    /* @ngInject */
    function ProfileService($http, exception, $q, common, config) {
        var cache = null;
        var _realm = null;
        var events = config.events;

        var service = {
            current: current,
            realm: realm,
            setRealm: setRealm
        };

        return service;
        //////////////

        function current(forceRefresh) {
            if (cache && !forceRefresh) {
                //should return promise
                return $q.when(cache);
            }

            return $http.get('/api/user/profile')
                .then(getCurrentComplete)
                .catch(function (message) {
                    exception.catcher('Profiel van de huidige gebruiker opvragen, lukt niet.')(message);
                });


            function getCurrentComplete(response, status, headers, config) {
                cache = response.data;
                service.setRealm(response.data.realm);
                return response.data;
            }

        }

        function realm() {
            return _realm; //synchronous, as async data was here at initialization
        }

        function setRealm(realm) {
            //realm.domain_name= realm.domain_name.replace(/\./g, '_');
            _realm = realm;
            common.$broadcast(events.realmChanged, realm);
        }

    }
    ProfileService.$inject = ["$http", "exception", "$q", "common", "config"];
})();
/**
 * notosplus.curricula
 * FACTORY: Curriculum
 */

(function () {
    'use strict';

    angular
        .module('notosplus.curricula')
        .factory('Curriculum', Curriculum);

    /* @ngInject */
    function Curriculum(HTTPCache) {

        var service= {
            get: get,
            objectives: objectives
        }


        return service;
        //////////////

        function get(course) {
            return HTTPCache.one('/curricula', course);
        }
        function objectives(course) {
            return get(course).getList('objectives');
        }
    }
    Curriculum.$inject = ["HTTPCache"];
})();
/**
 * notosplus.dashboard
 * CONTROLLER: DashboardController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.dashboard')
        .controller('DashboardController', DashboardController);

    /* @ngInject */
    function DashboardController(common, config) {
        /*jshint validthis: true */
        var vm = this;

        var events = config.events;

        activate();
        /////////////

        function activate() {
            common.$broadcast(events.controllerActivateSuccess);
        }
    }
    DashboardController.$inject = ["common", "config"];
})();
/**
 * ROUTES: notosplus.dashboard
 */
(function () {
    'use strict';

    angular
        .module('notosplus.dashboard')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'index',
                config: {
                    abstract: true,
                    url: '/index',
                    ncyBreadcrumb: {
                        label: 'start'
                    }
                }
            },
            {
                state: 'index.dashboard',
                config: {
                    url: '/dashboard',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/dashboard/dashboard.html',
                            controller: 'DashboardController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Dashboard'
                }
            }
        ];
    };
})();
/**
 * notosplus.layout
 * CONTROLLER: shell
 */
(function () {
    'use strict';

    angular
        .module('notosplus.layout')
        .controller('ShellController', ShellController);

    /* @ngInject */
    function ShellController(Init, $rootScope, config, ProfileService, logger) {
        /*jshint validthis: true */
        var vm = this;

        vm.busyMessage = 'Even geduld...';
        vm.isBusy = true;
        vm.showSplash = false;
        vm.avatar = null;
        vm.profile = {};
        vm.loggedInOrganization = null;

        var events = config.events;

        activate();
        /////////////

        function activate() {

            if (!Init.isInitialized()) {
                vm.showSplash = true;
                Init.initializing(true);
                getProfile().then(function (data) {

                    vm.profile = data;
                    vm.profile.fullName = vm.profile.first_name + ' ' + vm.profile.last_name;
                    //vm.profile.organizations = profile.organizations;

                    vm.avatar =
                        vm.profile.avatar ||
                        (vm.profile.gender === 'F' ? '/img/user/female.png' : '/img/user/male.png') ||
                        '/img/user/male.png';

                    initialized();
                });
            }
        }

        function getProfile() {
            return ProfileService.current().then(function (data) {
                vm.profile = data;
                return vm.profile;
            });
        }

        function toggleSpinner(on) {
            vm.isBusy = on;
        }

        $rootScope.$on('$stateChangeStart',
            function (event, next, current) {
                toggleSpinner(true);
            }
        );

        $rootScope.$on(events.controllerActivateSuccess,
            function (data) {
                toggleSpinner(false);
            }
        );
        $rootScope.$on(events.realmChanged,
            function (scope, realm) {
                vm.realm = realm;
            });

        function initialized() {
            vm.showSplash = false;

            logger.info('Welkom ' + vm.profile.first_name);
        }

    }
    ShellController.$inject = ["Init", "$rootScope", "config", "ProfileService", "logger"];
})();
/**
 * ROUTES: notosplus.library
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'library',
                config: {
                    abstract: true,
                    url: '/library'
                }
            },
            {
                state: 'library.books',
                config: {
                    url: '/books',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/library/books/books.html',
                            controller: 'BooksController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Boeken'
                }
            },
            {
                state: 'library.websites',
                config: {
                    url: '/websites',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/library/websites/websites.html',
                            controller: 'WebsitesController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Websites'
                }
            },
            {
                state: 'library.websites.detail',
                config: {
                    url: '/:id',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/library/websites/websitedetail.html',
                            controller: 'WebsiteDetailController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Website bewerken'
                }
            },
            {
                state: 'library.websites.detail.objectives',
                config: {
                    url:'/objectives',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/curricula/objectives/select_objectives.html',
                            controller: 'SelectObjectivesController',
                            controllerAs: 'vm'
                        }
                    }
                },
                title: 'Doelen selecteren'
            }
        ];
    };
})();
/**
 * ROUTES: notosplus.manage
 */
(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'manage',
                config: {
                    abstract: true,
                    url: '/manage',
                    title: 'Beheer'
                }
            },
            {
                state: 'manage.users',
                config: {
                    url: '/users',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/manage/users/users.html',
                            controller: 'UsersController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Gebruikers'
                }
            },
            {
                state: 'manage.users.detail',
                config: {
                    url: '/:id',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/manage/users/userdetail.html',
                            controller: 'UserDetailController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Gebruiker bewerken'
                }
            }
        ];
    };
})();
/**
 * notosplus.tags
 * FACTORY: Tag
 */

(function () {
    'use strict';

    angular
        .module('notosplus.tags')
        .factory('Tag', Tag);

    /* @ngInject */
    function Tag(HTTPCache) {
        var service = HTTPCache.service('tags');

        return service;

    }
    Tag.$inject = ["HTTPCache"];
})();
// Include in index.html so that app level exceptions are handled.
// Exclude from testRunner.html which should run exactly what it wants to run
(function() {
    'use strict';

    angular
        .module('blocks.exception')
        .provider('exceptionHandler', exceptionHandlerProvider)
        .config(config);

    /**
     * Must configure the exception handling
     * @return {[type]}
     */
    function exceptionHandlerProvider() {
        /* jshint validthis:true */
        this.config = {
            appErrorPrefix: undefined
        };

        this.configure = function (appErrorPrefix) {
            this.config.appErrorPrefix = appErrorPrefix;
        };

        this.$get = function() {
            return {config: this.config};
        };
    }

    /**
     * Configure by setting an optional string value for appErrorPrefix.
     * Accessible via config.appErrorPrefix (via config value).
     * @param  {[type]} $provide
     * @return {[type]}
     * @ngInject
     */
    function config($provide) {
        $provide.decorator('$exceptionHandler', extendExceptionHandler);
    }
    config.$inject = ["$provide"];

    /**
     * Extend the $exceptionHandler service to also display a toast.
     * @param  {Object} $delegate
     * @param  {Object} exceptionHandler
     * @param  {Object} logger
     * @return {Function} the decorated $exceptionHandler service
     */
    function extendExceptionHandler($delegate, exceptionHandler, logger) {
        return function(exception, cause) {
            var appErrorPrefix = exceptionHandler.config.appErrorPrefix || '';
            var errorData = {exception: exception, cause: cause};
            exception.message = appErrorPrefix + exception.message;
            $delegate(exception, cause);
            /**
             * Could add the error to a service's collection,
             * add errors to $rootScope, log errors to remote web server,
             * or log locally. Or throw hard. It is entirely up to you.
             * throw exception;
             *
             * @example
             *     throw { message: 'error message we added' };
             */
            logger.error(exception.message, errorData);
        };
    }
    extendExceptionHandler.$inject = ["$delegate", "exceptionHandler", "logger"];
})();
/**
 * blocks.exception
 * FACTORY: exception
 */

(function () {
    'use strict';

    angular
        .module('blocks.exception')
        .factory('exception', exception);

    /* @ngInject */
    function exception(logger) {
        var service = {
            catcher: catcher
        };
        return service;

        function catcher(message) {
            return function(reason) {
                logger.error(message, reason);
            };
        }
    }
    exception.$inject = ["logger"];
})();
/**
 * blocks.logger
 * FACTORY: logger
 */

(function () {
    'use strict';

    angular
        .module('blocks.logger')
        .factory('logger', logger);

    logger.$inject = ['$log', 'toastr'];

    function logger($log, toastr) {
        var service = {
            showToasts: true,

            error: error,
            info: info,
            success: success,
            warning: warning,

            removed: removed,
            saved: saved,

            // straight to console; bypass toastr
            log: $log.log
        };

        return service;
        /////////////////////

        function error(message, data, title) {
            toastr.error(message, title);
            $log.error('Fout: ' + message, data);
        }

        function info(message, data, title) {
            toastr.info(message, title);
            $log.info('Info: ' + message, data);
        }

        function success(message, data, title) {
            toastr.success(message, title);
            $log.info('Succes: ' + message, data);
        }

        function warning(message, data, title) {
            toastr.warning(message, title);
            $log.warn('Let op: ' + message, data);
        }

        function removed(message, data, title) {
            toastr.warning(message, title);
            $log.warn('Verwijderd: ' + message, data);
        }

        function saved(message, data, title) {
            toastr.success(message, title);
            $log.info('Bewaard: ' + message, data);
        }
    }
})();
/**
 * notosplus.router
 * FACTORY: routehelper
 */

(function () {
    'use strict';

    angular
        .module('blocks.router')
        .provider('routehelperConfig', routehelperConfig)
        .factory('routehelper', routehelper);

    routehelper.$inject = ['routehelperConfig', '$rootScope', '$state'];

    function routehelperConfig() {
        /* jshint validthis:true */
        this.config = {};

        this.$get = function () {
            return {
                config: this.config
            };
        };
    }

    function routehelper(routehelperConfig, $rootScope, $state) {
        var $urlRouterProvider = routehelperConfig.config.$urlRouterProvider;
        var $stateProvider = routehelperConfig.config.$stateProvider;

        var service = {
            configureStates: configureStates,
            states: states,
            get: get
        };

        init();

        return service;
        //////////////////

        function configureStates(states) {
            states.forEach(function (state) {
                if (state.config.title) {
                    state.config.ncyBreadcrumb = {
                        label: state.config.title.toLowerCase()
                    }
                }

                $stateProvider.state(state.state, state.config);
            });
        }

        function states() {
            return $state.get();
        }

        function get(pattern) {
            var result = null;
            states().forEach(function (state) {
                if (state.name === pattern) {
                    result = state;
                }
            });
            return result;
        }


        function init() {
            updateDocTitle();
            $urlRouterProvider.otherwise('/index/dashboard');
        }

        function updateDocTitle() {
            $rootScope.$on('$stateChangeSuccess',
                function (event, current, previous) {
                    var title = routehelperConfig.config.title + (current.title ? ' | ' + current.title : '');
                    $rootScope.title = title; // data bind to <title>
                    $rootScope.$state = current;
                }
            );
        }

    }
})();
/**
 * notosplus.curricula
 * CONTROLLER: SelectObjectivesController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.curricula')
        .controller('SelectObjectivesController', SelectObjectivesController);

    /* @ngInject */
    function SelectObjectivesController(common, config, WebsiteDraft, Curriculum,
                                        $state, $scope, SearchSiblingsIncludedFilter) {
        /*jshint validthis: true */
        var vm = this;

        vm.objectives = [];
        vm.filtered = [];
        vm.selectedItems = [];
        vm.website = null;

        vm.save = save;
        vm.cancel = cancel;
        vm.compareObjective = compareObjective;

        vm.itemsPerPage = 10;
        vm.currentPage = 1;
        vm.totalItems = 0;

        vm.search = '';

        var events = config.events;

        activate();
        ////////////

        function activate() {
            getItems().then(function () {
                loadDraft();
                common.$broadcast(events.controllerActivateSuccess);
            });

            /*
             * Search functions
             */
            $scope.$watch('vm.search', function (term) {
                if (vm.objectives) {
                    vm.filtered = SearchSiblingsIncludedFilter(vm.objectives, term);
                    vm.totalItems = vm.filtered.length;
                }
            });
        }

        function getItems() {
            return Curriculum.objectives('wiskunde').then(function (data) {
                vm.totalItems = data.length;
                return vm.objectives = vm.filtered = data;
            });
        }

        function loadDraft() {
            vm.website = WebsiteDraft.load();
            if (vm.website && vm.website.objectives) {
                return vm.selectedItems = vm.website.objectives;
            }
        }

        function compareObjective(o1, o2) {
            return o1.id === o2.id;
        }

        function save() {
            vm.website.objectives = vm.selectedItems;
            WebsiteDraft.draft(vm.website);
            gotoWebsite();
        }

        function cancel() {
            gotoWebsite();
        }

        function gotoWebsite() {
            $state.go('library.websites.detail', {id: vm.website.id});
        }
    }
    SelectObjectivesController.$inject = ["common", "config", "WebsiteDraft", "Curriculum", "$state", "$scope", "SearchSiblingsIncludedFilter"];
})();
/**
 * notosplus.data
 * FILTER: SearchSiblingsIncluded
 */
(function () {
    'use strict';

    angular
        .module('notosplus.curricula')
        .filter('SearchSiblingsIncluded', SearchSiblingsIncluded);

    /**
     *
     */
    function SearchSiblingsIncluded() {
        return function (input, searchText) {

            if (searchText === undefined)
           f

            var filtered = [],
                filteredIds = [];
            angular.forEach(input, function (item) {
                var lower_code = angular.lowercase(item.code);
                var lower_name = angular.lowercase(item.name);
                var lower_searchText = angular.lowercase(searchText);

                if (lower_name.indexOf(lower_searchText) > -1 ||
                    lower_code.indexOf(lower_searchText) > -1) {

                    if (item.parent_id) {
                        angular.forEach(input, function (pitem) {
                            if (pitem.id === item.parent_id) {
                                if (filteredIds.indexOf(pitem.id) === -1) {
                                    filtered.push(pitem);
                                    filteredIds.push(pitem.id);
                                }
                            }
                        });
                    }
                    if (filteredIds.indexOf(item.id) === -1) {
                        filtered.push(item);
                        filteredIds.push(item.id);
                    }
                    if (!item.parent_id) {
                        angular.forEach(input, function (chitem) {
                            if (chitem.parent_id === item.id) {
                                if (filteredIds.indexOf(chitem.id) === -1) {
                                    filtered.push(chitem);
                                    filteredIds.push(chitem.id);
                                }
                            }
                        });
                    }

                }
            });
            return filtered;
        }

    }
})();
/**
 * notosplus.library
 * CONTROLLER: BooksController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .controller('BooksController', BooksController);

    /* @ngInject */
    function BooksController(common, config) {
        /*jshint validthis: true */
        var vm = this;

        vm.refresh = refresh;

        var events = config.events;

        activate();
        ////////////

        function activate() {
            common.$broadcast(events.controllerActivateSuccess);
        }

        function getBooks(forceRefresh) {

        }

        function refresh() {
            getBooks(true);
        }
    }
    BooksController.$inject = ["common", "config"];
})();
/**
 * notosplus.websites
 * FILTER: SearchWebsites
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .filter('SearchWebsites', SearchWebsites);

    /**
     *
     */
    function SearchWebsites(_) {
        return function(websites, terms) {
            terms = terms.split(' ');
            return _.select(websites, function(website) {
                return _.some(terms, function(t) {
                    return _.contains(website.name.toLowerCase(), t.toLowerCase()) ||
                        _.contains(website.url.toLowerCase(), t.toLowerCase());
                });
            });
        }
    }
    SearchWebsites.$inject = ["_"];
})();
/**
 * notos-plus.library
 * FACTORY: WebsiteDraft
 */

(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .factory('WebsiteDraft', WebsiteDraft);

    /* @ngInject */
    function WebsiteDraft() {
        var website = null;

        var service = {
            draft: draft,
            load: load,
            clear: clear,
            pull: pull
        }

        return service;
        /////////////////

        function draft(website) {
            this.website = website;
        }
        function load() {
            return this.website;
        }
        function clear() {
            this.website = null;
        }
        function pull() {
            var w = this.load();
            this.clear();
            return w;
        }
    }
})();
/**
 * notosplus.library
 * FACTORY: Website
 */

(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .factory('Website', Website);

    /* @ngInject */
    function Website(HTTPCache) {
        var service = HTTPCache.service('/websites');

        return service;
    }
    Website.$inject = ["HTTPCache"];
})();
/**
 * notosplus.library
 * CONTROLLER: WebsiteDetailController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .controller('WebsiteDetailController', WebsiteDetailController);

    /* @ngInject */
    function WebsiteDetailController($state, $stateParams,
                                     common, config, Tag,
                                     Website, Dialog, WebsiteDraft, _) {
        /*jshint validthis: true */
        var vm = this;
        var logger = common.logger;
        var $q = common.$q;
        var events = config.events;

        vm.cancel = cancel;
        vm.hasChanges = false;
        vm.loading = false;
        vm.isSaving = false;
        vm.save = save;
        vm.remove = remove;
        vm.gotoObjectives = gotoObjectives;
        vm.website = null;
        vm.objectives_changed = false;

        vm.tags = [];
        vm.loadTags = loadTags;


        Object.defineProperty(vm, 'canSave', {get: canSave});

        activate();
        ////////////

        function activate() {

            preloadTags();
            getRequestedWebsite();

            common.$broadcast(events.controllerActivateSuccess);
        }

        function preloadTags() {
            return Tag.getList().then(tagsCompleted);

            function tagsCompleted(response) {
                return vm.tags = response;
            }
        }

        function loadTags(query) {
            return _.select(vm.tags, function(t) {
               return _.contains(t.name.toLowerCase(), query.toLowerCase());
            });
        }

        function cancel() {
            gotoWebsites();
        }

        function canSave() {
            return !vm.isSaving;
        }

        function getRequestedWebsite() {
            vm.loading = true;

            if (WebsiteDraft.load()) {
                vm.website = WebsiteDraft.pull();
                vm.objectives_changed = true;
                vm.loading = false;
                return vm.website;
            }

            var val = $stateParams.id;
            if (val === 'new') {
                vm.website = Website.one();
                vm.loading = false;

                return vm.website;
            }


            Website.one(val).get()
                .then(function (data) {
                    if (data) {
                        vm.website = data;

                        vm.loading = false;
                        return vm.website;
                    } else {
                        logger.warning('Could not find website id = ' + val);
                        gotoWebsites();
                    }
                    vm.loading = false;
                })
                .catch(function (error) {
                    logger.error('Error while getting website id= ' + val + '; ' + error);
                    gotoWebsites();
                })
        }

        function gotoWebsites() {
            $state.go('library.websites');
        }

        function save() {
            if (!canSave()) {
                return $q.when(null);
            } // Must return a promise

            vm.isSaving = true;

            return vm.website.save().then(function () {
                vm.isSaving = false;

                gotoWebsites();
            }).catch(function (error) {
                vm.isSaving = false;
                logger.error('Kon website niet opslaan. [' + error + ']');
            });
        }

        function remove() {
            return Dialog.deleteDialog(vm.website.name + ' [' + vm.website.url + ']')
                .then(removeWebsite);

            function removeWebsite() {
                vm.website.remove().then(function () {
                    vm.website.clearCache();
                    logger.warning(vm.website.name + ' werd met succes verwijderd.');
                    gotoWebsites();
                }).catch(function (error) {
                    Dialog.confirmationDialog('Verwijderen mislukt',
                        'Het verwijderen van ' + vm.website.name + ' is mislukt. Probeer het later opnieuw.');
                });
            }
        }

        function gotoObjectives() {
            WebsiteDraft.draft(vm.website);
            $state.go('library.websites.detail.objectives');
        }

    }
    WebsiteDetailController.$inject = ["$state", "$stateParams", "common", "config", "Tag", "Website", "Dialog", "WebsiteDraft", "_"];
})();
/**
 * notosplus.library
 * CONTROLLER: WebsitesController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .controller('WebsitesController', WebsitesController);

    /* @ngInject */
    function WebsitesController(common, config, $state, Website, $scope, SearchWebsitesFilter) {
        /*jshint validthis: true */
        var vm = this;

        vm.websites = [];
        vm.filteredWebsites = [];
        vm.gotoWebsite = gotoWebsite;
        vm.refresh = refresh;

        vm.filter = {
            terms: null
        };

        var events = config.events;

        activate();
        ////////////////
        $scope.$watch('vm.filter', doFilter, true);

        function activate() {
            common.$broadcast(events.controllerActivateSuccess);
            getWebsites();
        }

        function getWebsites(forceRefresh) {
            vm.loading = true;

            if (forceRefresh) {
                if (vm.websites) {
                    vm.websites.clearCache();
                }
            }
            Website.getList().then(function (data) {
                vm.websites = vm.filteredWebsites = data;
                vm.loading = false;
                return vm.websites;
            });
        }

        function gotoWebsite(website) {
            if (website && website.id) {
                $state.go('library.websites.detail', {id: website.id});
            }
        }

        function refresh() {
            getWebsites(true);
        }

        function doFilter() {
            if (vm.filter.terms && vm.filter.terms !== '') {
                vm.filteredWebsites = SearchWebsitesFilter(vm.websites, vm.filter.terms);
            } else {
                vm.filteredWebsites = vm.websites;
            }
        }
    }
    WebsitesController.$inject = ["common", "config", "$state", "Website", "$scope", "SearchWebsitesFilter"];
})();
/*
 if (_.some(terms, function (t) {
 return nameContainsTerm(website.name, t) ||
 descriptionContainsTerm(website.description, t) ||
 objectivesContainsTerm(website.objectives, t);
 })) {
 addUnique(website, filtered);
 }

 */
/**
 * notosplus.manage
 * FACTORY: User
 */

(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .factory('User', User);


    /* @ngInject */
    function User(HTTPCache, ProfileService) {

        var service = HTTPCache.service('/organization/' + ProfileService.realm().id + '/user');


        return service;
    }
    User.$inject = ["HTTPCache", "ProfileService"];
})();
/**
 * notosplus.manage
 * CONTROLLER: UserAddController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .controller('UserDetailController', UserDetailController);

    /* @ngInject */
    function UserDetailController($state, $stateParams,
                                  common, config, User, Dialog, ProfileService) {
        /*jshint validthis: true */
        var vm = this;
        var logger = common.logger;
        var $q = common.$q;
        var events = config.events;


        vm.cancel = cancel;
        vm.hasChanges = false;
        vm.loading = false;
        vm.isSaving = false;
        vm.isResetPwd = false;
        vm.resetPwd = resetPassword;
        vm.save = save;
        vm.remove = remove;
        vm.user = null;
        vm.users = [];
        vm.defaultUsername = defaultUsername;
        vm.defaultDomain = ProfileService.current().domain_name;

        Object.defineProperty(vm, 'canSave', {get: canSave});

        activate();

        function activate() {
            //onDestroy();
            //onHasChanges();

            getRequestedUser();

            common.$broadcast(events.controllerActivateSuccess);
        }

        function cancel() {
            goToUsers();
        }

        function canSave() {
            return !vm.isSaving;
        }

        function getRequestedUser() {
            vm.loading = true;
            var val = $stateParams.id;
            if (val === 'new') {
                vm.user = User.one();
                vm.isResetPwd = true;
                vm.loading = false;

                return vm.user;
            }

            User.one(val).get()
                .then(function (data) {
                    if (data) {
                        vm.user = data;

                        vm.loading = false;
                        return vm.user;

                    } else {
                        logger.warning('Could not find user id = ' + val);
                        goToUsers();
                    }
                    vm.loading = false;
                })
                .catch(function (error) {
                    logger.error('Error while getting user id = ' + val + '; ' + error);
                    goToUsers();
                });
        }

        function goToUsers() {
            $state.go('manage.users');
        }

        function save() {

            if (!canSave()) {
                return $q.when(null);
            } // Must return a promise

            vm.isSaving = true;

            return vm.user.save().then(function () {
                vm.isSaving = false;

                goToUsers();
            }).catch(function (error) {
                vm.isSaving = false;
                logger.error('Kon gebruiker niet opslaan. [' + error + ']');
            });

        }

        function resetPassword() {
            return Dialog.resetPasswordDialog()
                .then(patchResettedPassword);

            function patchResettedPassword(data) {
                vm.user.one('password').patch(data)
                    .then(passwordWasResetted);

                function passwordWasResetted(user) {
                    common.logger.info('Paswoord opnieuw ingesteld voor ' + user.full_name);
                }
            }
        }

        function remove() {
            return Dialog.deleteDialog(vm.user.full_name)
                .then(removeUser);

            function removeUser() {
                vm.user.remove().then(function () {
                    vm.user.clearCache();
                    logger.warning(vm.user.full_name + ' werd met succes verwijderd.');
                    goToUsers();
                }).catch(function (response) {
                    Dialog.confirmationDialog('Verwijderen mislukt',
                        'Het verwijderen van ' + vm.user.full_name + ' is mislukt. Probeer het later opnieuw.');
                });
            }
        }

        function defaultUsername() {
            if(vm.user.username) {
                return vm.user.username;
            }
            return vm.user.first
        }
    }
    UserDetailController.$inject = ["$state", "$stateParams", "common", "config", "User", "Dialog", "ProfileService"];
})();
/**
 * notosplus.manage
 * CONTROLLER: UsersController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .controller('UsersController', UsersController);


    /* @ngInject */
    function UsersController($state, config, common, User) {
        /*jshint validthis: true */
        var vm = this;

        var keyCodes = config.keyCodes;
        var events = config.events;

        vm.filteredUsers = [];
        vm.gotoUser = gotoUser;
        vm.refresh = refresh;
        vm.search = search;
        vm.userSearch = '';
        vm.users = [];


        activate();

        function activate() {
            common.$broadcast(events.controllerActivateSuccess);
            getUsers();
        }

        function applyFilter() {
            vm.filteredUsers = vm.users.filter(userFilter);
        }


        function getUsers(forceRefresh) {
            vm.loading = true;

            if (forceRefresh) {
                if (vm.users) {
                    vm.users.clearCache();
                }
            }
            User.getList().then(function (data) {
                vm.users = vm.filteredUsers = data;
                vm.loading = false;

                return vm.users;
            });
        }


        function gotoUser(user) {
            if (user && user.id) {
                $state.go('manage.users.detail', {id: user.id});
            }
        }

        function refresh() {
            vm.userSearch = '';
            getUsers(true);
        }

        function search($event) {
            if ($event.keyCode === keyCodes.esc) {
                vm.userSearch = '';
            }
            applyFilter();
        }

        function userFilter(user) {
            var isMatch = true;
            if (vm.userSearch) {
                isMatch = common.textContains(user.name, vm.userSearch);
                isMatch |= common.textContains(user.username, vm.userSearch);
            }

            return isMatch;
        }
    }
    UsersController.$inject = ["$state", "config", "common", "User"];
})();
/**
 * notosplus.widgets
 * DIRECTIVE: ntFa
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntFa', ntFa);

    ntFa.$inject = [];

    function ntFa() {
        var directive = {
            restrict: 'E',
            link: linkFunc
        };

        return directive;
        //////////////////////

        function linkFunc(scope, element, attrs) {
            var i = angular.element('<i class="fa" />');
            var classes = attrs.name.split(' ');

            angular.forEach(classes, function (value) {
                i.addClass('fa-' + value);
            });

            element.replaceWith(i);
        }
    }
})();


/**
 * notosplus.widgets
 * DIRECTIVE: ntSpinner
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntSpinner', ntSpinner);

    /* @ngInject */
    function ntSpinner() {
        var directive = {
            restrict: 'EA',
            compile: compile
        };

        return directive;
        //////////////////////
        function compile(elem, attrs) {
            if (elem[0].tagName === 'TABLE') {
                addSpinnerToTBody(elem, attrs);
            } else {
                addSpinnerToElement(elem, attrs);
            }
        }

        function addSpinnerToTBody(element, attrs) {
            var tbody = element.find('tbody');
            var html = ['<tr ng-show="' + attrs.spinnerShow + '">',
                            '<td ',
                                (attrs.hasOwnProperty('colspan') ? 'colspan="' + attrs.colspan + '" ' : ''),
                            ' style="text-align:center">',
                                '<img src="/img/busy/busyatom.gif" style="width:40px;height:40px;">',
                            '</td>',
                        '</tr>'].join('');

            tbody.prepend(html);
        }
        function addSpinnerToElement(element, attrs) {
            var html = ['<div ng-show="' + attrs.spinnerShow + '" class="col-md-12 text-center">',
                    '<img src="/img/busy/busyatom.gif" style="width:40px;height:40px;">',
                '</div>',
                '<div class="clearfix"></div>'].join('');

            element.prepend(html);
        }
    }
})();


/**
 * notosplus.widgets
 * FACTORY: spinnerService
 */

(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .factory('spinnerService', spinnerService);

    /* @ngInject */
    function spinnerService() {
        var spinners = {};
        var service = {
            _register: register,
            _unregister: unregister,
            _unregisterAll: unregisterAll,
            show: show,
            hide: hide,
            showGroup: showGroup,
            hideGroup: hideGroup,
            showAll: showAll,
            hideAll: hideAll
        }

        return service;
        //////////////
        function register(data) {
            if(!data.hasOwnProperty('name')) {
                throw new Error('Spinner must specify a name when registering with the spinner service.');
            }
            if(spinners.hasOwnProperty(data.name)) {
                throw new Error('A spinner with the name "' + data.name + '" has already been registered.');
            }
            spinners[data.name] = data;
        }

        function unregister(name) {
            if(spinners.hasOwnProperty(name)) {
                delete spinners[name];
            }
        }

        function unregisterAll() {
            for(var name in spinners) {
                delete spinners[name];
            }
        }

        function show(name) {
            var spinner  = spinners[name];
            if(!spinner) {
                throw  new Error('No spinner named "' + name + '" is registered.');
            }
            spinner.show();
        }

        function hide(name) {
            var spinner  = spinners[name];
            if(!spinner) {
                throw  new Error('No spinner named "' + name + '" is registered.');
            }
            spinner.hide();
        }

        function showGroup(group) {
            var groupExists = false;
            for(var name in spinners) {
                var spinner = spinners[name];
                if(spinner.group === group) {
                    spinner.show();
                    groupExists = true;
                }
            }
            if(!groupExists) {
                throw new Error('No spinners found with group "' + group + '".');
            }
        }
        function hideGroup(group) {
            var groupExists = false;
            for(var name in spinners) {
                var spinner = spinners[name];
                if(spinner.group === group) {
                    spinner.hide();
                    groupExists = true;
                }
            }
            if(!groupExists) {
                throw new Error('No spinners found with group "' + group + '".');
            }
        }
        function showAll() {
            for(var name in spinners) {
                spinners[name].show();
            }
        }
        function hideAll() {
            for(var name in spinners) {
                spinners[name].hide();
            }
        }
    }
})();
/**
 * notosplus.widgets
 * DIRECTIVE: ntMiniSideBar
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntMiniSidebar', ntMiniSidebar);

    function ntMiniSidebar() {
        var directive = {
            restrict: 'A',
            template: [
                '<a class="navbar-minimalize minimalize-styl-2 btn btn-primary" href="" ng-click="vm.minimalize()">',
                '<i class="fa fa-bars"></i>',
                '</a>'
            ].join(''),

            controller: MinimizeController,
            controllerAs: 'vm',
            bindToController: true // because the scope is isolated
        };

        MinimizeController.$inject = ["$timeout"];
        return directive;
        //////////////////////

        /* @ngInject */
        function MinimizeController($timeout) {
            var vm = this;
            vm.minimalize = minimalize;

            //////////////////////////////////
            function minimalize() {
                angular.element('body').toggleClass('mini-navbar');
                if (!angular.element('body').hasClass('mini-navbar') || angular.element('body').hasClass('body-small')) {
                    // Hide menu in order to smoothly turn on when maximize menu
                    angular.element('#side-menu').hide();
                    // For smoothly turn on menu
                    $timeout(
                        function () {
                            angular.element('#side-menu').fadeIn(500);
                        }, 100);
                } else if (angular.element('body').hasClass('fixed-sidebar')) {
                    angular.element('#side-menu').hide();
                    $timeout(
                        function () {
                            angular.element('#side-menu').fadeIn(500);
                        }, 300);
                } else {
                    // Remove all inline style from jquery fadeIn function to reset menu state
                    angular.element('#side-menu').removeAttr('style');
                }
            }
        }
    }
})();


/**
 * notosplus.widgets
 * DIRECTIVE: ntPagination
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntPagination', ntPagination);

    /* @ngInject */
    function ntPagination($compile) {
        var directive = {
            restrict: 'EA',
            scope: {
                totalItems: '=',
                itemsPerPage: '=',
                currentPage: '='
            },
            link: linkFunc,
            controller: PaginateController,
            controllerAs: 'vm',
            bindToController: true // because the scope is isolated
        };

        PaginateController.$inject = ["$scope"];
        return directive;
        //////////////////////

        function linkFunc(scope, element, attrs) {
            var pagination = angular.element('<pagination />')
            pagination.attr('data-boundary-links', true);
            pagination.attr('data-total-items', 'totalItems');
            pagination.attr('data-items-per-page', 'itemsPerPage');
            pagination.attr('data-max-size', 5);
            pagination.attr('data-ng-model', 'currentPage');
            pagination.attr('data-previous-text', '');
            pagination.attr('data-next-text', '');
            pagination.attr('data-first-text', '');
            pagination.attr('data-last-text', '');
            pagination.attr('data-ng-hide', 'hide');
            if (attrs['class']) {
                pagination.attr('class', attrs['class']);
            }

            $compile(pagination)(scope);
            element.replaceWith(pagination);
        }

        /* @ngInject */
        function PaginateController($scope) {
            var vm = this;

            vm.hide = false;
            vm.itemsPerPage = 10;
            vm.currentPge = 0;

            $scope.$watch('vm.totalItems', function () {
                vm.hide = (vm.totalItems <= vm.itemsPerPage);
            });
        }
    }
    ntPagination.$inject = ["$compile"];
})();


/**
 * notosplus
 * DIRECTIVE: ntSideNavigation
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntSideNavigation', ntSideNavigation);

    /* @ngInject */
    function ntSideNavigation($timeout) {
        var directive = {
            restrict: 'EA',
            link: linkFunc
        };

        return directive;
        //////////////////////

        function linkFunc(scope, element) {
            $timeout(function () {
                $(element).metisMenu();
            })
        };
    }
    ntSideNavigation.$inject = ["$timeout"];
})();


/**
 * notosplus.widgets
 * FILTER: offset
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .filter('offset', filter);


    function filter() {
        return function offset(input, start) {
            if (input) {
                start = parseInt(start, 10);
                return input.slice(start);
            }
            return [];
        };
    }
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vdG9zcGx1cy5tb2R1bGUuanMiLCJjb3JlLm1vZHVsZS5qcyIsImRhdGEubW9kdWxlLmpzIiwiYXV0aC9hdXRoLm1vZHVsZS5qcyIsImN1cnJpY3VsYS9jdXJyaWN1bGEubW9kdWxlLmpzIiwiZGFzaGJvYXJkL2Rhc2hib2FyZC5tb2R1bGUuanMiLCJsYXlvdXQvbGF5b3V0Lm1vZHVsZS5qcyIsImxpYnJhcnkvbGlicmFyeS5tb2R1bGUuanMiLCJtYW5hZ2UvbWFuYWdlLm1vZHVsZS5qcyIsInRhZ3MvdGFncy5tb2R1bGUuanMiLCJ3aWRnZXRzL3dpZGdldHMubW9kdWxlLmpzIiwiYmxvY2tzL2V4Y2VwdGlvbi9leGNlcHRpb24ubW9kdWxlLmpzIiwiYmxvY2tzL2xvZ2dlci9sb2dnZXIubW9kdWxlLmpzIiwiYmxvY2tzL3JvdXRlci9yb3V0ZXIubW9kdWxlLmpzIiwiYm9vdHN0cmFwLmRpYWxvZy5qcyIsImNvbW1vbi5qcyIsImNvbmZpZy5icmVlemUuanMiLCJjb25maWcuanMiLCJjb25zdGFudHMuanMiLCJpbml0LmpzIiwiaGlnaGxpZ2h0LmpzIiwicmVzdGFuZ3VsYXIuY2FjaGUuanMiLCJhdXRoL3Byb2ZpbGUuanMiLCJjdXJyaWN1bGEvY3VycmljdWx1bS5qcyIsImRhc2hib2FyZC9kYXNoYm9hcmQuY29udHJvbGxlci5qcyIsImRhc2hib2FyZC9kYXNoYm9hcmQucm91dGVzLmpzIiwibGF5b3V0L3NoZWxsLmNvbnRyb2xsZXIuanMiLCJsaWJyYXJ5L2xpYnJhcnkucm91dGVzLmpzIiwibWFuYWdlL21hbmFnZS5yb3V0ZXMuanMiLCJ0YWdzL3RhZy5qcyIsImJsb2Nrcy9leGNlcHRpb24vZXhjZXB0aW9uLWhhbmRsZXIucHJvdmlkZXIuanMiLCJibG9ja3MvZXhjZXB0aW9uL2V4Y2VwdGlvbi5qcyIsImJsb2Nrcy9sb2dnZXIvbG9nZ2VyLmpzIiwiYmxvY2tzL3JvdXRlci9yb3V0ZWhlbHBlci5qcyIsImN1cnJpY3VsYS9vYmplY3RpdmVzL3NlbGVjdC5vYmplY3RpdmVzLmNvbnRyb2xsZXIuanMiLCJjdXJyaWN1bGEvb2JqZWN0aXZlcy9zaWJsaW5nSW5jbHVkZWQuanMiLCJsaWJyYXJ5L2Jvb2tzL2Jvb2tzLmNvbnRyb2xsZXIuanMiLCJsaWJyYXJ5L3dlYnNpdGVzL3NlYXJjaFdlYnNpdGVzLmZpbHRlci5qcyIsImxpYnJhcnkvd2Vic2l0ZXMvd2Vic2l0ZS5kcmFmdC5qcyIsImxpYnJhcnkvd2Vic2l0ZXMvd2Vic2l0ZS5qcyIsImxpYnJhcnkvd2Vic2l0ZXMvd2Vic2l0ZWRldGFpbC5jb250cm9sbGVyLmpzIiwibGlicmFyeS93ZWJzaXRlcy93ZWJzaXRlcy5jb250cm9sbGVyLmpzIiwibWFuYWdlL3VzZXJzL3VzZXIuanMiLCJtYW5hZ2UvdXNlcnMvdXNlcmRldGFpbC5jb250cm9sbGVyLmpzIiwibWFuYWdlL3VzZXJzL3VzZXJzLmNvbnRyb2xsZXIuanMiLCJ3aWRnZXRzL2ljb25zL250RmEuanMiLCJ3aWRnZXRzL2xvYWRpbmcvbnRTcGlubmVyLmpzIiwid2lkZ2V0cy9sb2FkaW5nL3NwaW5uZXJTZXJ2aWNlLmpzIiwid2lkZ2V0cy9uYXZpZ2F0aW9uL250TWluaVNpZGViYXIuanMiLCJ3aWRnZXRzL25hdmlnYXRpb24vbnRQYWdpbmF0aW9uLmpzIiwid2lkZ2V0cy9uYXZpZ2F0aW9uL250U2lkZU5hdmlnYXRpb24uanMiLCJ3aWRnZXRzL25hdmlnYXRpb24vb2Zmc2V0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUEsV0FBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxhQUFBOztZQUVBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7OztZQUdBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7Ozs7QUNoQkE7S0FDQSxPQUFBLGtCQUFBOztRQUVBLGFBQUEsY0FBQTs7O1FBR0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBOzs7UUFHQTtRQUNBO1FBQ0E7O0FDcEJBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0Es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QUE7UUFDQSxlQUFBLElBQUE7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTs7Ozs7Ozs7QUN0SkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxVQUFBOztJQUVBLFNBQUEsT0FBQSxJQUFBLFlBQUEsVUFBQSxRQUFBO1FBQ0EsSUFBQSxZQUFBOztRQUVBLElBQUEsVUFBQTs7WUFFQSxZQUFBO1lBQ0EsSUFBQTtZQUNBLFVBQUE7O1lBRUEsVUFBQTtZQUNBLG1CQUFBO1lBQ0EsUUFBQTtZQUNBLGNBQUE7OztRQUdBLE9BQUE7OztRQUdBLFNBQUEsYUFBQTtZQUNBLE9BQUEsV0FBQSxXQUFBLE1BQUEsWUFBQTs7OztRQUlBLFNBQUEsa0JBQUEsS0FBQSxVQUFBLE9BQUEsV0FBQTs7OztZQUlBLElBQUEsZUFBQTtZQUNBLFFBQUEsU0FBQTtZQUNBLElBQUEsVUFBQSxNQUFBO2dCQUNBLFNBQUEsT0FBQSxVQUFBO2dCQUNBLFVBQUEsT0FBQTs7WUFFQSxJQUFBLFdBQUE7Z0JBQ0E7bUJBQ0E7Z0JBQ0EsVUFBQSxPQUFBLFNBQUEsVUFBQTs7OztRQUlBLFNBQUEsU0FBQSxLQUFBOztZQUVBLE9BQUEsQ0FBQSxhQUFBLEtBQUE7OztRQUdBLFNBQUEsYUFBQSxNQUFBLFlBQUE7WUFDQSxPQUFBLFFBQUEsQ0FBQSxNQUFBLEtBQUEsY0FBQSxRQUFBLFdBQUE7Ozs7Ozs7Ozs7QUNyREEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxnQkFBQTs7O0lBR0EsU0FBQSxhQUFBLFFBQUE7UUFDQSxJQUFBLFVBQUE7WUFDQSxtQkFBQTtZQUNBLFFBQUE7OztRQUdBLE9BQUE7Ozs7OztBQ25CQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxJQUFBLE9BQUEsUUFBQSxPQUFBOztJQUVBLEtBQUEsT0FBQTs7O0lBR0EsU0FBQSxhQUFBLFFBQUE7UUFDQSxPQUFBLFFBQUEsVUFBQTtRQUNBLE9BQUEsUUFBQSxjQUFBO1FBQ0EsT0FBQSxRQUFBLGNBQUE7UUFDQSxPQUFBLFFBQUEsZ0JBQUE7Ozs7SUFHQSxJQUFBLFdBQUE7UUFDQSxXQUFBO1FBQ0EsS0FBQTtRQUNBLE9BQUE7UUFDQSxLQUFBO1FBQ0EsT0FBQTtRQUNBLFFBQUE7UUFDQSxVQUFBO1FBQ0EsS0FBQTtRQUNBLE1BQUE7UUFDQSxNQUFBO1FBQ0EsSUFBQTtRQUNBLE9BQUE7UUFDQSxNQUFBO1FBQ0EsUUFBQTtRQUNBLEtBQUE7OztJQUdBLElBQUEsU0FBQTtRQUNBLDJCQUFBO1FBQ0EsaUJBQUE7UUFDQSxrQkFBQTtRQUNBLG1CQUFBO1FBQ0EsU0FBQTtZQUNBLE9BQUE7WUFDQSxjQUFBO1lBQ0EsWUFBQTs7UUFFQSw2QkFBQTs7OztJQUlBLElBQUEsU0FBQTtRQUNBLGdCQUFBO1FBQ0EsVUFBQTtRQUNBLFVBQUE7UUFDQSxTQUFBO1FBQ0EsUUFBQTs7O0lBR0EsS0FBQSxNQUFBLFVBQUE7O0lBRUEsS0FBQSxPQUFBOzs7SUFHQSxTQUFBLFVBQUEsb0JBQUE7dUJBQ0EsMkJBQUE7dUJBQ0Esd0JBQUE7dUJBQ0EscUJBQUE7O1FBRUE7UUFDQTs7UUFFQTtRQUNBOztRQUVBOzs7UUFHQSxTQUFBLG1CQUFBO1lBQ0EsMEJBQUEsT0FBQSxxQkFBQTtZQUNBLDBCQUFBLE9BQUEsaUJBQUE7O1lBRUEsMEJBQUEsT0FBQSxRQUFBLE9BQUE7OztRQUdBLFNBQUEsc0JBQUE7WUFDQSxvQkFBQSxXQUFBO2dCQUNBLGlCQUFBO2dCQUNBLFVBQUE7Z0JBQ0EsaUJBQUE7Ozs7UUFJQSxTQUFBLG9CQUFBOztZQUVBLHVCQUFBLFNBQUE7O2dCQUVBLFNBQUE7Z0JBQ0EsS0FBQTtnQkFDQSxRQUFBLE9BQUEsT0FBQTs7O2dCQUdBLFFBQUE7Z0JBQ0EsZ0JBQUEsT0FBQTtnQkFDQSxTQUFBLE9BQUEsS0FBQTs7O2dCQUdBLFNBQUEsT0FBQTs7OztRQUlBLFNBQUEscUJBQUE7WUFDQSwwQkFBQTtnQkFDQTtnQkFDQTs7OztRQUlBLFNBQUEsdUJBQUE7WUFDQSxJQUFBLFVBQUE7O1lBRUEsb0JBQUEsV0FBQTs7Ozs7O0FDcEhBLENBQUEsV0FBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFNBQUEsVUFBQTtTQUNBLFNBQUEsVUFBQTtTQUNBLFNBQUEsS0FBQSxPQUFBOzs7Ozs7O0FDSEEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxRQUFBOzs7SUFHQSxTQUFBLE9BQUE7UUFDQSxJQUFBLGlCQUFBOztRQUVBLElBQUEsVUFBQTtZQUNBLGVBQUE7WUFDQSxjQUFBOzs7UUFHQSxPQUFBOzs7UUFHQSxTQUFBLGdCQUFBO1lBQ0EsT0FBQTs7UUFFQSxTQUFBLGFBQUEsTUFBQTtZQUNBLGlCQUFBOzs7Ozs7Ozs7QUN4QkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsT0FBQSxhQUFBOzs7OztJQUtBLFNBQUEsVUFBQSxNQUFBO1FBQ0EsT0FBQSxVQUFBLEtBQUEsa0JBQUE7WUFDQSxJQUFBLHFCQUFBLElBQUE7Z0JBQ0EsT0FBQSxLQUFBLFlBQUE7OztZQUdBLG1CQUFBLGlCQUFBLE1BQUE7WUFDQSxpQkFBQSxLQUFBLFVBQUEsR0FBQSxHQUFBO2dCQUNBLE9BQUEsRUFBQSxTQUFBLEVBQUE7Ozs7WUFJQSxJQUFBLFFBQUEsSUFBQSxPQUFBLGlCQUFBLGlCQUFBLEtBQUEsT0FBQSx1QkFBQTtZQUNBLE9BQUEsS0FBQSxZQUFBLElBQUEsUUFBQSxPQUFBOzs7Ozs7Ozs7OztBQ3RCQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLGFBQUE7OztJQUdBLFNBQUEsVUFBQSxhQUFBLGVBQUE7UUFDQSxJQUFBO1FBQ0EsUUFBQSxjQUFBOztRQUVBLE9BQUEsWUFBQSxXQUFBLFVBQUEsdUJBQUE7WUFDQSxzQkFBQSxxQkFBQSxDQUFBLE9BQUE7WUFDQSxzQkFBQSx1QkFBQSxVQUFBLFVBQUEsV0FBQTtnQkFDQSxJQUFBLGNBQUEsU0FBQSxjQUFBLFVBQUEsY0FBQSxVQUFBO29CQUNBLE1BQUE7O2dCQUVBLE9BQUE7Ozs7WUFJQSxzQkFBQSx5QkFBQSxTQUFBLE1BQUEsY0FBQTtnQkFDQSxLQUFBLGFBQUEsV0FBQTtvQkFDQSxNQUFBOztnQkFFQSxPQUFBOzs7Ozs7Ozs7OztBQzFCQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLGtCQUFBOzs7SUFHQSxTQUFBLGVBQUEsT0FBQSxXQUFBLElBQUEsUUFBQSxRQUFBO1FBQ0EsSUFBQSxRQUFBO1FBQ0EsSUFBQSxTQUFBO1FBQ0EsSUFBQSxTQUFBLE9BQUE7O1FBRUEsSUFBQSxVQUFBO1lBQ0EsU0FBQTtZQUNBLE9BQUE7WUFDQSxVQUFBOzs7UUFHQSxPQUFBOzs7UUFHQSxTQUFBLFFBQUEsY0FBQTtZQUNBLElBQUEsU0FBQSxDQUFBLGNBQUE7O2dCQUVBLE9BQUEsR0FBQSxLQUFBOzs7WUFHQSxPQUFBLE1BQUEsSUFBQTtpQkFDQSxLQUFBO2lCQUNBLE1BQUEsVUFBQSxTQUFBO29CQUNBLFVBQUEsUUFBQSx5REFBQTs7OztZQUlBLFNBQUEsbUJBQUEsVUFBQSxRQUFBLFNBQUEsUUFBQTtnQkFDQSxRQUFBLFNBQUE7Z0JBQ0EsUUFBQSxTQUFBLFNBQUEsS0FBQTtnQkFDQSxPQUFBLFNBQUE7Ozs7O1FBS0EsU0FBQSxRQUFBO1lBQ0EsT0FBQTs7O1FBR0EsU0FBQSxTQUFBLE9BQUE7O1lBRUEsU0FBQTtZQUNBLE9BQUEsV0FBQSxPQUFBLGNBQUE7Ozs7Ozs7Ozs7O0FDbERBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsY0FBQTs7O0lBR0EsU0FBQSxXQUFBLFdBQUE7O1FBRUEsSUFBQSxTQUFBO1lBQ0EsS0FBQTtZQUNBLFlBQUE7Ozs7UUFJQSxPQUFBOzs7UUFHQSxTQUFBLElBQUEsUUFBQTtZQUNBLE9BQUEsVUFBQSxJQUFBLGNBQUE7O1FBRUEsU0FBQSxXQUFBLFFBQUE7WUFDQSxPQUFBLElBQUEsUUFBQSxRQUFBOzs7Ozs7Ozs7QUN4QkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsV0FBQSx1QkFBQTs7O0lBR0EsU0FBQSxvQkFBQSxRQUFBLFFBQUE7O1FBRUEsSUFBQSxLQUFBOztRQUVBLElBQUEsU0FBQSxPQUFBOztRQUVBOzs7UUFHQSxTQUFBLFdBQUE7WUFDQSxPQUFBLFdBQUEsT0FBQTs7Ozs7Ozs7QUNuQkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsSUFBQTs7O0lBR0EsU0FBQSxhQUFBLGFBQUE7UUFDQSxZQUFBLGdCQUFBOzsyQ0FDQTs7SUFFQSxTQUFBLFlBQUE7UUFDQSxPQUFBO1lBQ0E7Z0JBQ0EsT0FBQTtnQkFDQSxRQUFBO29CQUNBLFVBQUE7b0JBQ0EsS0FBQTtvQkFDQSxlQUFBO3dCQUNBLE9BQUE7Ozs7WUFJQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsS0FBQTtvQkFDQSxPQUFBO3dCQUNBLFlBQUE7NEJBQ0EsYUFBQTs0QkFDQSxZQUFBOzRCQUNBLGNBQUE7OztvQkFHQSxPQUFBOzs7O0tBSUE7Ozs7OztBQ3RDQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxXQUFBLG1CQUFBOzs7SUFHQSxTQUFBLGdCQUFBLE1BQUEsWUFBQSxRQUFBLGdCQUFBLFFBQUE7O1FBRUEsSUFBQSxLQUFBOztRQUVBLEdBQUEsY0FBQTtRQUNBLEdBQUEsU0FBQTtRQUNBLEdBQUEsYUFBQTtRQUNBLEdBQUEsU0FBQTtRQUNBLEdBQUEsVUFBQTtRQUNBLEdBQUEsdUJBQUE7O1FBRUEsSUFBQSxTQUFBLE9BQUE7O1FBRUE7OztRQUdBLFNBQUEsV0FBQTs7WUFFQSxJQUFBLENBQUEsS0FBQSxpQkFBQTtnQkFDQSxHQUFBLGFBQUE7Z0JBQ0EsS0FBQSxhQUFBO2dCQUNBLGFBQUEsS0FBQSxVQUFBLE1BQUE7O29CQUVBLEdBQUEsVUFBQTtvQkFDQSxHQUFBLFFBQUEsV0FBQSxHQUFBLFFBQUEsYUFBQSxNQUFBLEdBQUEsUUFBQTs7O29CQUdBLEdBQUE7d0JBQ0EsR0FBQSxRQUFBO3lCQUNBLEdBQUEsUUFBQSxXQUFBLE1BQUEseUJBQUE7d0JBQ0E7O29CQUVBOzs7OztRQUtBLFNBQUEsYUFBQTtZQUNBLE9BQUEsZUFBQSxVQUFBLEtBQUEsVUFBQSxNQUFBO2dCQUNBLEdBQUEsVUFBQTtnQkFDQSxPQUFBLEdBQUE7Ozs7UUFJQSxTQUFBLGNBQUEsSUFBQTtZQUNBLEdBQUEsU0FBQTs7O1FBR0EsV0FBQSxJQUFBO1lBQ0EsVUFBQSxPQUFBLE1BQUEsU0FBQTtnQkFDQSxjQUFBOzs7O1FBSUEsV0FBQSxJQUFBLE9BQUE7WUFDQSxVQUFBLE1BQUE7Z0JBQ0EsY0FBQTs7O1FBR0EsV0FBQSxJQUFBLE9BQUE7WUFDQSxVQUFBLE9BQUEsT0FBQTtnQkFDQSxHQUFBLFFBQUE7OztRQUdBLFNBQUEsY0FBQTtZQUNBLEdBQUEsYUFBQTs7WUFFQSxPQUFBLEtBQUEsWUFBQSxHQUFBLFFBQUE7Ozs7Ozs7OztBQzVFQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxJQUFBOzs7SUFHQSxTQUFBLGFBQUEsYUFBQTtRQUNBLFlBQUEsZ0JBQUE7OzJDQUNBOztJQUVBLFNBQUEsWUFBQTtRQUNBLE9BQUE7WUFDQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsVUFBQTtvQkFDQSxLQUFBOzs7WUFHQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsS0FBQTtvQkFDQSxPQUFBO3dCQUNBLFlBQUE7NEJBQ0EsYUFBQTs0QkFDQSxZQUFBOzRCQUNBLGNBQUE7OztvQkFHQSxPQUFBOzs7WUFHQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsS0FBQTtvQkFDQSxPQUFBO3dCQUNBLFlBQUE7NEJBQ0EsYUFBQTs0QkFDQSxZQUFBOzRCQUNBLGNBQUE7OztvQkFHQSxPQUFBOzs7WUFHQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsS0FBQTtvQkFDQSxPQUFBO3dCQUNBLFlBQUE7NEJBQ0EsYUFBQTs0QkFDQSxZQUFBOzRCQUNBLGNBQUE7OztvQkFHQSxPQUFBOzs7WUFHQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsSUFBQTtvQkFDQSxPQUFBO3dCQUNBLFlBQUE7NEJBQ0EsYUFBQTs0QkFDQSxZQUFBOzRCQUNBLGNBQUE7Ozs7Z0JBSUEsT0FBQTs7O0tBR0E7Ozs7O0FDOUVBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLElBQUE7OztJQUdBLFNBQUEsYUFBQSxhQUFBO1FBQ0EsWUFBQSxnQkFBQTs7MkNBQ0E7O0lBRUEsU0FBQSxZQUFBO1FBQ0EsT0FBQTtZQUNBO2dCQUNBLE9BQUE7Z0JBQ0EsUUFBQTtvQkFDQSxVQUFBO29CQUNBLEtBQUE7b0JBQ0EsT0FBQTs7O1lBR0E7Z0JBQ0EsT0FBQTtnQkFDQSxRQUFBO29CQUNBLEtBQUE7b0JBQ0EsT0FBQTt3QkFDQSxZQUFBOzRCQUNBLGFBQUE7NEJBQ0EsWUFBQTs0QkFDQSxjQUFBOzs7b0JBR0EsT0FBQTs7O1lBR0E7Z0JBQ0EsT0FBQTtnQkFDQSxRQUFBO29CQUNBLEtBQUE7b0JBQ0EsT0FBQTt3QkFDQSxZQUFBOzRCQUNBLGFBQUE7NEJBQ0EsWUFBQTs0QkFDQSxjQUFBOzs7b0JBR0EsT0FBQTs7OztLQUlBOzs7Ozs7O0FDakRBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsT0FBQTs7O0lBR0EsU0FBQSxJQUFBLFdBQUE7UUFDQSxJQUFBLFVBQUEsVUFBQSxRQUFBOztRQUVBLE9BQUE7Ozs7Ozs7QUNkQSxDQUFBLFdBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxTQUFBLG9CQUFBO1NBQ0EsT0FBQTs7Ozs7O0lBTUEsU0FBQSwyQkFBQTs7UUFFQSxLQUFBLFNBQUE7WUFDQSxnQkFBQTs7O1FBR0EsS0FBQSxZQUFBLFVBQUEsZ0JBQUE7WUFDQSxLQUFBLE9BQUEsaUJBQUE7OztRQUdBLEtBQUEsT0FBQSxXQUFBO1lBQ0EsT0FBQSxDQUFBLFFBQUEsS0FBQTs7Ozs7Ozs7Ozs7SUFXQSxTQUFBLE9BQUEsVUFBQTtRQUNBLFNBQUEsVUFBQSxxQkFBQTs7Ozs7Ozs7Ozs7SUFVQSxTQUFBLHVCQUFBLFdBQUEsa0JBQUEsUUFBQTtRQUNBLE9BQUEsU0FBQSxXQUFBLE9BQUE7WUFDQSxJQUFBLGlCQUFBLGlCQUFBLE9BQUEsa0JBQUE7WUFDQSxJQUFBLFlBQUEsQ0FBQSxXQUFBLFdBQUEsT0FBQTtZQUNBLFVBQUEsVUFBQSxpQkFBQSxVQUFBO1lBQ0EsVUFBQSxXQUFBOzs7Ozs7Ozs7O1lBVUEsT0FBQSxNQUFBLFVBQUEsU0FBQTs7Ozs7Ozs7OztBQ3pEQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLGFBQUE7OztJQUdBLFNBQUEsVUFBQSxRQUFBO1FBQ0EsSUFBQSxVQUFBO1lBQ0EsU0FBQTs7UUFFQSxPQUFBOztRQUVBLFNBQUEsUUFBQSxTQUFBO1lBQ0EsT0FBQSxTQUFBLFFBQUE7Z0JBQ0EsT0FBQSxNQUFBLFNBQUE7Ozs7Ozs7Ozs7O0FDaEJBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsVUFBQTs7SUFFQSxPQUFBLFVBQUEsQ0FBQSxRQUFBOztJQUVBLFNBQUEsT0FBQSxNQUFBLFFBQUE7UUFDQSxJQUFBLFVBQUE7WUFDQSxZQUFBOztZQUVBLE9BQUE7WUFDQSxNQUFBO1lBQ0EsU0FBQTtZQUNBLFNBQUE7O1lBRUEsU0FBQTtZQUNBLE9BQUE7OztZQUdBLEtBQUEsS0FBQTs7O1FBR0EsT0FBQTs7O1FBR0EsU0FBQSxNQUFBLFNBQUEsTUFBQSxPQUFBO1lBQ0EsT0FBQSxNQUFBLFNBQUE7WUFDQSxLQUFBLE1BQUEsV0FBQSxTQUFBOzs7UUFHQSxTQUFBLEtBQUEsU0FBQSxNQUFBLE9BQUE7WUFDQSxPQUFBLEtBQUEsU0FBQTtZQUNBLEtBQUEsS0FBQSxXQUFBLFNBQUE7OztRQUdBLFNBQUEsUUFBQSxTQUFBLE1BQUEsT0FBQTtZQUNBLE9BQUEsUUFBQSxTQUFBO1lBQ0EsS0FBQSxLQUFBLGFBQUEsU0FBQTs7O1FBR0EsU0FBQSxRQUFBLFNBQUEsTUFB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QSxLQUFBLE9BQUE7Ozs7Ozs7O1lBUUEsT0FBQTs7Ozs7Ozs7O0FDckRBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFdBQUEsbUJBQUE7OztJQUdBLFNBQUEsZ0JBQUEsUUFBQSxRQUFBOztRQUVBLElBQUEsS0FBQTs7UUFFQSxHQUFBLFVBQUE7O1FBRUEsSUFBQSxTQUFBLE9BQUE7O1FBRUE7OztRQUdBLFNBQUEsV0FBQTtZQUNBLE9BQUEsV0FBQSxPQUFBOzs7UUFHQSxTQUFBLFNBQUEsY0FBQTs7OztRQUlBLFNBQUEsVUFBQTtZQUNBLFNBQUE7Ozs7Ozs7OztBQzVCQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxPQUFBLGtCQUFBOzs7OztJQUtBLFNBQUEsZUFBQSxHQUFBO1FBQ0EsT0FBQSxTQUFBLFVBQUEsT0FBQTtZQUNBLFFBQUEsTUFBQSxNQUFBO1lBQ0EsT0FBQSxFQUFBLE9BQUEsVUFBQSxTQUFBLFNBQUE7Z0JBQ0EsT0FBQSxFQUFBLEtBQUEsT0FBQSxTQUFBLEdBQUE7b0JBQ0EsT0FBQSxFQUFBLFNBQUEsUUFBQSxLQUFBLGVBQUEsRUFBQTt3QkFDQSxFQUFBLFNBQUEsUUFBQSxJQUFBLGVBQUEsRUFBQTs7Ozs7Ozs7Ozs7O0FDZkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxnQkFBQTs7O0lBR0EsU0FBQSxlQUFBO1FBQ0EsSUFBQSxVQUFBOztRQUVBLElBQUEsVUFBQTtZQUNBLE9BQUE7WUFDQSxNQUFBO1lBQ0EsT0FBQTtZQUNBLE1BQUE7OztRQUdBLE9BQUE7OztRQUdBLFNBQUEsTUFBQSxTQUFBO1lBQ0EsS0FBQSxVQUFBOztRQUVBLFNBQUEsT0FBQTtZQUNBLE9BQUEsS0FBQTs7UUFFQSxTQUFBLFFBQUE7WUFDQSxLQUFBLFVBQUE7O1FBRUEsU0FBQSxPQUFBO1lBQ0EsSUFBQSxJQUFBLEtBQUE7WUFDQSxLQUFBO1lBQ0EsT0FBQTs7Ozs7Ozs7O0FDakNBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsV0FBQTs7O0lBR0EsU0FBQSxRQUFBLFdBQUE7UUFDQSxJQUFBLFVBQUEsVUFBQSxRQUFBOztRQUVBLE9BQUE7Ozs7Ozs7O0FDWkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsV0FBQSwyQkFBQTs7O0lBR0EsU0FBQSx3QkFBQSxRQUFBO3FDQUNBLFFBQUEsUUFBQTtxQ0FDQSxTQUFBLFFBQUEsY0FBQSxHQUFBOztRQUVBLElBQUEsS0FBQTtRQUNBLElBQUEsU0FBQSxPQUFBO1FBQ0EsSUFBQSxLQUFBLE9BQUE7UUFDQSxJQUFBLFNBQUEsT0FBQTs7UUFFQSxHQUFBLFNBQUE7UUFDQSxHQUFBLGFBQUE7UUFDQSxHQUFBLFVBQUE7UUFDQSxHQUFBLFdBQUE7UUFDQSxHQUFBLE9BQUE7UUFDQSxHQUFBLFNBQUE7UUFDQSxHQUFBLGlCQUFBO1FBQ0EsR0FBQSxVQUFBO1FBQ0EsR0FBQSxxQkFBQTs7UUFFQSxHQUFBLE9BQUE7UUFDQSxHQUFBLFdBQUE7OztRQUdBLE9BQUEsZUFBQSxJQUFBLFdBQUEsQ0FBQSxLQUFBOztRQUVBOzs7UUFHQSxTQUFBLFdBQUE7O1lBRUE7WUFDQTs7WUFFQSxPQUFBLFdBQUEsT0FBQTs7O1FBR0EsU0FBQSxjQUFBO1lBQ0EsT0FBQSxJQUFBLFVBQUEsS0FBQTs7WUFFQSxTQUFBLGNBQUEsVUFBQTtnQkFDQSxPQUFBLEdBQUEsT0FBQTs7OztRQUlBLFNBQUEsU0FBQSxPQUFBO1lBQ0EsT0FBQSxFQUFBLE9BQUEsR0FBQSxNQUFBLFNBQUEsR0FBQTtlQUNBLE9BQUEsRUFBQSxTQUFBLEVBQUEsS0FBQSxlQUFBLE1BQUE7Ozs7UUFJQSxTQUFBLFNBQUE7WUFDQTs7O1FBR0EsU0FBQSxVQUFBO1lBQ0EsT0FBQSxDQUFBLEdBQUE7OztRQUdBLFNBQUEsc0JBQUE7WUFDQSxHQUFBLFVBQUE7O1lBRUEsSUFBQSxhQUFBLFFBQUE7Z0JBQ0EsR0FBQSxVQUFBLGFBQUE7Z0JBQ0EsR0FBQSxxQkFBQTtnQkFDQSxHQUFBLFVBQUE7Z0JBQ0EsT0FBQSxHQUFBOzs7WUFHQSxJQUFBLE1BQUEsYUFBQTtZQUNBLElBQUEsUUFBQSxPQUFBO2dCQUNBLEdBQUEsVUFBQSxRQUFBO2dCQUNBLEdBQUEsVUFBQTs7Z0JBRUEsT0FBQSxHQUFBOzs7O1lBSUEsUUFBQSxJQUFBLEtBQUE7aUJBQ0EsS0FBQSxVQUFBLE1BQUE7b0JBQ0EsSUFBQSxNQUFBO3dCQUNBLEdBQUEsVUFBQTs7d0JBRUEsR0FBQSxVQUFBO3dCQUNBLE9BQUEsR0FBQTsyQkFDQTt3QkFDQSxPQUFBLFFBQUEsaUNBQUE7d0JBQ0E7O29CQUVBLEdBQUEsVUFBQTs7aUJBRUEsTUFBQSxVQUFBLE9BQUE7b0JBQ0EsT0FBQSxNQUFBLHFDQUFBLE1BQUEsT0FBQTtvQkFDQTs7OztRQUlBLFNBQUEsZUFBQTtZQUNBLE9BQUEsR0FBQTs7O1FBR0EsU0FBQSxPQUFBO1lBQ0EsSUFBQSxDQUFBLFdBQUE7Z0JBQ0EsT0FBQSxHQUFBLEtBQUE7OztZQUdBLEdBQUEsV0FBQTs7WUFFQSxPQUFBLEdBQUEsUUFBQSxPQUFBLEtBQUEsWUFBQTtnQkFDQSxHQUFBLFdBQUE7O2dCQUVBO2VBQ0EsTUFBQSxVQUFBLE9BQUE7Z0JBQ0EsR0FBQSxXQUFBO2dCQUNBLE9BQUEsTUFBQSxnQ0FBQSxRQUFBOzs7O1FBSUEsU0FBQSxTQUFBO1lBQ0EsT0FBQSxPQUFBLGFBQUEsR0FBQSxRQUFBLE9BQUEsT0FBQSxHQUFBLFFBQUEsTUFBQTtpQkFDQSxLQUFBOztZQUVBLFNBQUEsZ0JBQUE7Z0JBQ0EsR0FBQSxRQUFBLFNBQUEsS0FBQSxZQUFBO29CQUNBLEdBQUEsUUFBQTtvQkFDQSxPQUFBLFFBQUEsR0FBQSxRQUFBLE9BQUE7b0JBQ0E7bUJBQ0EsTUFBQSxVQUFBLE9BQUE7b0JBQ0EsT0FBQSxtQkFBQTt3QkFDQSx5QkFBQSxHQUFBLFFBQUEsT0FBQTs7Ozs7UUFLQSxTQUFBLGlCQUFBO1lBQ0EsYUFBQSxNQUFBLEdBQUE7WUFDQSxPQUFBLEdBQUE7Ozs7Ozs7Ozs7QUMvSUEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsV0FBQSxzQkFBQTs7O0lBR0EsU0FBQSxtQkFBQSxRQUFBLFFBQUEsUUFBQSxTQUFBLFFBQUEsc0JBQUE7O1FBRUEsSUFBQSxLQUFBOztRQUVBLEdBQUEsV0FBQTtRQUNBLEdBQUEsbUJBQUE7UUFDQSxHQUFBLGNBQUE7UUFDQSxHQUFBLFVBQUE7O1FBRUEsR0FBQSxTQUFBO1lBQ0EsT0FBQTs7O1FBR0EsSUFBQSxTQUFBLE9BQUE7O1FBRUE7O1FBRUEsT0FBQSxPQUFBLGFBQUEsVUFBQTs7UUFFQSxTQUFBLFdBQUE7WUFDQSxPQUFBLFdBQUEsT0FBQTtZQUNBOzs7UUFHQSxTQUFBLFlBQUEsY0FBQTtZQUNBLEdBQUEsVUFBQTs7WUFFQSxJQUFBLGNBQUE7Z0JBQ0EsSUFBQSxHQUFBLFVBQUE7b0JBQ0EsR0FBQSxTQUFBOzs7WUFHQSxRQUFBLFVBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsR0FBQSxXQUFBLEdBQUEsbUJBQUE7Z0JBQ0EsR0FBQSxVQUFBO2dCQUNBLE9BQUEsR0FBQTs7OztRQUlBLFNBQUEsWUFBQSxTQUFBO1lBQ0EsSUFBQSxXQUFBLFFBQUEsSUFBQTtnQkFDQSxPQUFBLEdBQUEsMkJBQUEsQ0FBQSxJQUFBLFFBQUE7Ozs7UUFJQSxTQUFBLFVBQUE7WUFDQSxZQUFBOzs7UUFHQSxTQUFBLFdBQUE7WUFDQSxJQUFBLEdBQUEsT0FBQSxTQUFBLEdBQUEsT0FBQSxVQUFBLElBQUE7Z0JBQ0EsR0FBQSxtQkFBQSxxQkFBQSxHQUFBLFVBQUEsR0FBQSxPQUFBO21CQUNBO2dCQUNBLEdBQUEsbUJBQUEsR0FBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDNURBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsUUFBQTs7OztJQUlBLFNBQUEsS0FBQSxXQUFBLGdCQUFBOztRQUVBLElBQUEsVUFBQSxVQUFBLFFBQUEsbUJBQUEsZUFBQSxRQUFBLEtBQUE7OztRQUdBLE9BQUE7Ozs7Ozs7O0FDZkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFB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QUEsUUFBQTs7O1FBR0E7O1FBRUEsU0FBQSxXQUFBO1lBQ0EsT0FBQSxXQUFBLE9BQUE7WUFDQTs7O1FBR0EsU0FBQSxjQUFBO1lBQ0EsR0FBQSxnQkFBQSxHQUFBLE1BQUEsT0FBQTs7OztRQUlBLFNBQUEsU0FBQSxjQUFBO1lBQ0EsR0FBQSxVQUFBOztZQUVBLElBQUEsY0FBQTtnQkFDQSxJQUFBLEdBQUEsT0FBQTtvQkFDQSxHQUFBLE1BQUE7OztZQUdBLEtBQUEsVUFBQSxLQUFBLFVBQUEsTUFBQTtnQkFDQSxHQUFBLFFBQUEsR0FBQSxnQkFBQTtnQkFDQSxHQUFBLFVBQUE7O2dCQUVBLE9BQUEsR0FBQTs7Ozs7UUFLQSxTQUFBLFNBQUEsTUFBQTtZQUNBLElBQUEsUUFBQSxLQUFBLElBQUE7Z0JBQ0EsT0FBQSxHQUFBLHVCQUFBLENBQUEsSUFBQSxLQUFBOzs7O1FBSUEsU0FBQSxVQUFBO1lBQ0EsR0FBQSxhQUFBO1lBQ0EsU0FBQTs7O1FBR0EsU0FBQSxPQUFBLFFBQUE7WUFDQSxJQUFBLE9BQUEsWUFBQSxTQUFBLEtBQUE7Z0JBQ0EsR0FBQSxhQUFBOztZQUVBOzs7UUFHQSxTQUFBLFdBQUEsTUFBQTtZQUNBLElBQUEsVUFBQTtZQUNBLElBQUEsR0FBQSxZQUFBO2dCQUNBLFVBQUEsT0FBQSxhQUFBLEtBQUEsTUFBQSxHQUFBO2dCQUNBLFdBQUEsT0FBQSxhQUFBLEtBQUEsVUFBQSxHQUFBOzs7WUFHQSxPQUFBOzs7Ozs7Ozs7QUM5RUEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsVUFBQSxRQUFBOztJQUVBLEtBQUEsVUFBQTs7SUFFQSxTQUFBLE9BQUE7UUFDQSxJQUFBLFlBQUE7WUFDQSxVQUFBO1lBQ0EsTUFBQTs7O1FBR0EsT0FBQTs7O1FBR0EsU0FBQSxTQUFBLE9BQUEsU0FBQSxPQUFBO1lBQ0EsSUFBQSxJQUFBLFFBQUEsUUFBQTtZQUNBLElBQUEsVUFBQSxNQUFBLEtBQUEsTUFBQTs7WUFFQSxRQUFBLFFBQUEsU0FBQSxVQUFBLE9BQUE7Z0JBQ0EsRUFBQSxTQUFBLFFBQUE7OztZQUdBLFFBQUEsWUFBQTs7Ozs7Ozs7OztBQzFCQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxVQUFBLGFBQUE7OztJQUdBLFNBQUEsWUFBQTtRQUNBLElBQUEsWUFBQTtZQUNBLFVBQUE7WUFDQSxTQUFBOzs7UUFHQSxPQUFBOztRQUVBLFNBQUEsUUFBQSxNQUFBLE9BQUE7WUFDQSxJQUFBLEtBQUEsR0FBQSxZQUFBLFNBQUE7Z0JBQ0Esa0JBQUEsTUFBQTttQkFDQTtnQkFDQSxvQkFBQSxNQUFBOzs7O1FBSUEsU0FBQSxrQkFBQSxTQUFBLE9BQUE7WUFDQSxJQUFBLFFBQUEsUUFBQSxLQUFBO1lBQ0EsSUFBQSxPQUFBLENBQUEsa0JBQUEsTUFBQSxjQUFBOzRCQUNBO2lDQUNBLE1BQUEsZUFBQSxhQUFBLGNBQUEsTUFBQSxVQUFBLE9BQUE7NEJBQ0E7Z0NBQ0E7NEJBQ0E7d0JBQ0EsU0FBQSxLQUFBOztZQUVBLE1BQUEsUUFBQTs7UUFFQSxTQUFBLG9CQUFBLFNBQUEsT0FBQTtZQUNBLElBQUEsT0FBQSxDQUFBLG1CQUFBLE1BQUEsY0FBQTtvQkFDQTtnQkFDQTtnQkFDQSxnQ0FBQSxLQUFBOztZQUVBLFFBQUEsUUFBQTs7Ozs7Ozs7Ozs7QUN6Q0EsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxrQkFBQTs7O0lBR0EsU0FBQSxpQkFBQTtRQUNBLElBQUEsV0FBQTtRQUNBLElBQUEsVUFBQTtZQUNBLFdBQUE7WUFDQSxhQUFBO1lBQ0EsZ0JBQUE7WUFDQSxNQUFBO1lBQ0EsTUFBQTtZQUNBLFdBQUE7WUFDQSxXQUFBO1lBQ0EsU0FBQTtZQUNBLFNBQUE7OztRQUdBLE9BQUE7O1FBRUEsU0FBQSxTQUFBLE1BQUE7WUFDQSxHQUFBLENBQUEsS0FBQSxlQUFBLFNBQUE7Z0JBQ0EsTUFBQSxJQUFBLE1BQUE7O1lBRUEsR0FBQSxTQUFBLGVBQUEsS0FBQSxPQUFBO2dCQUNBLE1BQUEsSUFBQSxNQUFBLDhCQUFBLEtBQUEsT0FBQTs7WUFFQSxTQUFBLEtBQUEsUUFBQTs7O1FBR0EsU0FBQSxXQUFBLE1BQUE7WUFDQSxHQUFBLFNBQUEsZUFBQSxPQUFBO2dCQUNBLE9BQUEsU0FBQTs7OztRQUlBLFNBQUEsZ0JBQUE7WUFDQSxJQUFBLElBQUEsUUFBQSxVQUFBO2dCQUNBLE9BQUEsU0FBQTs7OztRQUlBLFNBQUEsS0FBQSxNQUFBO1lBQ0EsSUFBQSxXQUFBLFNBQUE7WUFDQSxHQUFBLENBQUEsU0FBQTtnQkFDQSxPQUFBLElBQUEsTUFBQSx1QkFBQSxPQUFBOztZQUVBLFFBQUE7OztRQUdBLFNBQUEsS0FBQSxNQUFBO1lBQ0EsSUFBQSxXQUFBLFNBQUE7WUFDQSxHQUFBLENBQUEsU0FBQTtnQkFDQSxPQUFBLElBQUEsTUFBQSx1QkFBQSxPQUFBOztZQUVBLFFBQUE7OztRQUdBLFNBQUEsVUFBQSxPQUFBO1lBQ0EsSUFBQSxjQUFBO1lBQ0EsSUFBQSxJQUFBLFFBQUEsVUFBQTtnQkFDQSxJQUFBLFVBQUEsU0FBQTtnQkFDQSxHQUFBLFFBQUEsVUFBQSxPQUFBO29CQUNBLFFBQUE7b0JBQ0EsY0FBQTs7O1lBR0EsR0FBQSxDQUFBLGFBQUE7Z0JBQ0EsTUFBQSxJQUFBLE1BQUEsbUNBQUEsUUFBQTs7O1FBR0EsU0FBQSxVQUFBLE9BQUE7WUFDQSxJQUFBLGNBQUE7WUFDQSxJQUFBLElBQUEsUUFBQSxVQUFBO2dCQUNBLElBQUEsVUFBQSxTQUFBO2dCQUNBLEdBQUEsUUFBQSxVQUFBLE9BQUE7b0JBQ0EsUUFBQTtvQkFDQSxjQUFBOzs7WUFHQSxHQUFBLENBQUEsYUFBQTtnQkFDQSxNQUFBLElBQUEsTUFBQSxtQ0FBQSxRQUFBOzs7UUFHQSxTQUFBLFVBQUE7WUFDQSxJQUFBLElBQUEsUUFBQSxVQUFBO2dCQUNBLFNBQUEsTUFBQTs7O1FBR0EsU0FBQSxVQUFBO1lBQ0EsSUFBQSxJQUFBLFFBQUEsVUFBQTtnQkFDQSxTQUFBLE1BQUE7Ozs7Ozs7OztBQ2hHQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxVQUFBLGlCQUFBOztJQUVBLFNBQUEsZ0JBQUE7UUFDQSxJQUFBLFlBQUE7WUFDQSxVQUFBO1lBQ0EsVUFBQTtnQkFDQTtnQkFDQTtnQkFDQTtjQUNBLEtBQUE7O1lBRUEsWUFBQTtZQUNBLGNBQUE7WUFDQSxrQkFBQTs7OztRQUdBLE9BQUE7Ozs7UUFJQSxTQUFBLG1CQUFBLFVBQUE7WUFDQSxJQUFBLEtBQUE7WUFDQSxHQUFBLGFBQUE7OztZQUdBLFNBQUEsYUFBQTtnQkFDQSxRQUFBLFFBQUEsUUFBQSxZQUFBO2dCQUNBLElBQUEsQ0FBQSxRQUFBLFFBQUEsUUFBQSxTQUFBLGtCQUFBLFFBQUEsUUFBQSxRQUFBLFNBQUEsZUFBQTs7b0JBRUEsUUFBQSxRQUFBLGNBQUE7O29CQUVBO3dCQUNBLFlBQUE7NEJBQ0EsUUFBQSxRQUFBLGNBQUEsT0FBQTsyQkFDQTt1QkFDQSxJQUFBLFFBQUEsUUFBQSxRQUFBLFNBQUEsa0JBQUE7b0JBQ0EsUUFBQSxRQUFBLGNBQUE7b0JBQ0E7d0JBQ0EsWUFBQTs0QkFDQSxRQUFBLFFBQUEsY0FBQSxPQUFBOzJCQUNBO3VCQUNBOztvQkFFQSxRQUFBLFFBQUEsY0FBQSxXQUFBOzs7Ozs7Ozs7Ozs7QUNoREEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsVUFBQSxnQkFBQTs7O0lBR0EsU0FBQSxhQUFBLFVBQUE7UUFDQSxJQUFBLFlBQUE7WUFDQSxVQUFBO1lBQ0EsT0FBQTtnQkFDQSxZQUFBO2dCQUNBLGNBQUE7Z0JBQ0EsYUFBQTs7WUFFQSxNQUFBO1lBQ0EsWUFBQTtZQUNBLGNBQUE7WUFDQSxrQkFBQTs7OztRQUdBLE9BQUE7OztRQUdBLFNBQUEsU0FBQSxPQUFBLFNBQUEsT0FBQTtZQUNBLElBQUEsYUFBQSxRQUFBLFFBQUE7WUFDQSxXQUFBLEtBQUEsdUJBQUE7WUFDQSxXQUFBLEtBQUEsb0JBQUE7WUFDQSxXQUFBLEtBQUEsdUJBQUE7WUFDQSxXQUFBLEtBQUEsaUJBQUE7WUFDQSxXQUFBLEtBQUEsaUJBQUE7WUFDQSxXQUFBLEtBQUEsc0JBQUE7WUFDQSxXQUFBLEtBQUEsa0JBQUE7WUFDQSxXQUFBLEtBQUEsbUJBQUE7WUFDQSxXQUFBLEtBQUEsa0JBQUE7WUFDQSxXQUFBLEtBQUEsZ0JBQUE7WUFDQSxJQUFBLE1BQUEsVUFBQTtnQkFDQSxXQUFBLEtBQUEsU0FBQSxNQUFBOzs7WUFHQSxTQUFBLFlBQUE7WUFDQSxRQUFBLFlBQUE7Ozs7UUFJQSxTQUFBLG1CQUFBLFFBQUE7WUFDQSxJQUFBLEtBQUE7O1lBRUEsR0FBQSxPQUFBO1lBQ0EsR0FBQSxlQUFBO1lBQ0EsR0FBQSxhQUFBOztZQUVBLE9BQUEsT0FBQSxpQkFBQSxZQUFBO2dCQUNBLEdBQUEsUUFBQSxHQUFBLGNBQUEsR0FBQTs7Ozs7Ozs7Ozs7O0FDdERBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFVBQUEsb0JBQUE7OztJQUdBLFNBQUEsaUJBQUEsVUFBQTtRQUNBLElBQUEsWUFBQTtZQUNBLFVBQUE7WUFDQSxNQUFBOzs7UUFHQSxPQUFBOzs7UUFHQSxTQUFBLFNBQUEsT0FBQSxTQUFBO1lBQ0EsU0FBQSxZQUFBO2dCQUNBLEVBQUEsU0FBQTs7U0FFQTs7Ozs7Ozs7OztBQ3JCQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxPQUFBLFVBQUE7OztJQUdBLFNBQUEsU0FBQTtRQUNBLE9BQUEsU0FBQSxPQUFBLE9BQUEsT0FBQTtZQUNBLElBQUEsT0FBQTtnQkFDQSxRQUFBLFNBQUEsT0FBQTtnQkFDQSxPQUFBLE1BQUEsTUFBQTs7WUFFQSxPQUFBOzs7S0FHQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzJywgW1xuICAgICAgICAgICAgLy9zaGFyZWQgbW9kdWxlc1xuICAgICAgICAgICAgJ25vdG9zcGx1cy5jb3JlJyxcbiAgICAgICAgICAgICdub3Rvc3BsdXMud2lkZ2V0cycsXG4gICAgICAgICAgICAnbm90b3NwbHVzLmF1dGgnLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy5kYXRhJyxcbiAgICAgICAgICAgICdub3Rvc3BsdXMubGF5b3V0JyxcblxuICAgICAgICAgICAgLy9hcHAgbW9kdWxlc1xuICAgICAgICAgICAgJ25vdG9zcGx1cy5kYXNoYm9hcmQnLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy5tYW5hZ2UnLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy5saWJyYXJ5JyxcbiAgICAgICAgICAgICdub3Rvc3BsdXMuY3VycmljdWxhJyxcbiAgICAgICAgICAgICdub3Rvc3BsdXMudGFncydcbiAgICAgICAgXSk7XG59KSgpOyIsIlxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jb3JlJywgW1xuICAgICAgICAvL0FuZ3VsYXJcbiAgICAgICAgJ25nQW5pbWF0ZScsICduZ1Nhbml0aXplJywgJ25nUmVzb3VyY2UnLFxuXG4gICAgICAgIC8vM3JkIHBhcnR5XG4gICAgICAgICd1aS5ib290c3RyYXAnLFxuICAgICAgICAnbmN5LWFuZ3VsYXItYnJlYWRjcnVtYicsXG4gICAgICAgICdicmVlemUuYW5ndWxhcicsICAgLy8gdGVsbHMgYnJlZXplIHRvIHVzZSAkcSBpbnN0ZWFkIG9mIFEuanNcbiAgICAgICAgJ2JyZWV6ZS5kaXJlY3RpdmVzJywvLyBicmVlemUgdmFsaWRhdGlvbiBkaXJlY3RpdmUgKHpWYWxpZGF0ZSksXG4gICAgICAgICduZ3pXaXAnLFxuICAgICAgICAnbmdwbHVzJyxcbiAgICAgICAgJ3Jlc3Rhbmd1bGFyJyxcbiAgICAgICAgJ2NoZWNrbGlzdC1tb2RlbCcsXG4gICAgICAgICduZ1RhZ3NJbnB1dCcsXG5cbiAgICAgICAgLy9jcm9zcyBhcHAgbW9kdWxlc1xuICAgICAgICAnYmxvY2tzLmV4Y2VwdGlvbicsXG4gICAgICAgICdibG9ja3MubG9nZ2VyJyxcbiAgICAgICAgJ2Jsb2Nrcy5yb3V0ZXInXG4gICAgXSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5kYXRhJywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmF1dGgnLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuY3VycmljdWxhJywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmRhc2hib2FyZCcsIFtcblxuICAgICAgICBdKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5sYXlvdXQnLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubGlicmFyeScsIFtdKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5tYW5hZ2UnLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMudGFncycsIFtdKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy53aWRnZXRzJywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicsIFsnYmxvY2tzLmxvZ2dlciddKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3Mucm91dGVyJywgW1xuICAgICAgICAgICAgJ3VpLnJvdXRlcidcbiAgICAgICAgXSk7XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmNvcmVcbiAqIEZBQ1RPUlk6IGJvb3RzdHJhcC5kaWFsb2dcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmNvcmUnKVxuICAgICAgICAuZmFjdG9yeSgnRGlhbG9nJywgbW9kYWxEaWFsb2cpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gbW9kYWxEaWFsb2coJG1vZGFsLCAkdGVtcGxhdGVDYWNoZSkge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGRlbGV0ZURpYWxvZzogZGVsZXRlRGlhbG9nLFxuICAgICAgICAgICAgY29uZmlybWF0aW9uRGlhbG9nOiBjb25maXJtYXRpb25EaWFsb2csXG4gICAgICAgICAgICByZXNldFBhc3N3b3JkRGlhbG9nOiByZXNldFBhc3N3b3JkRGlhbG9nXG4gICAgICAgIH07XG5cbiAgICAgICAgcmVnaXN0ZXJNb2RlbERpYWxvZygkdGVtcGxhdGVDYWNoZSk7XG4gICAgICAgIHJlZ2lzdGVyUmVzZXRQYXNzd29yZERpYWxvZygkdGVtcGxhdGVDYWNoZSk7XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBkZWxldGVEaWFsb2coaXRlbU5hbWUpIHtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9ICdCZW4gamUgemVrZXI/JztcbiAgICAgICAgICAgIGl0ZW1OYW1lID0gaXRlbU5hbWUgfHwgJ2l0ZW0nO1xuICAgICAgICAgICAgdmFyIG1zZyA9ICdWZXJ3aWpkZXIgJyArIGl0ZW1OYW1lICsgJz8nO1xuXG4gICAgICAgICAgICByZXR1cm4gY29uZmlybWF0aW9uRGlhbG9nKHRpdGxlLCBtc2cpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlybWF0aW9uRGlhbG9nKHRpdGxlLCBtc2csIG9rVGV4dCwgY2FuY2VsVGV4dCkge1xuICAgICAgICAgICAgdmFyIG1vZGFsT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZGFsRGlhbG9nLnRwbC5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBNb2RhbEluc3RhbmNlLFxuICAgICAgICAgICAgICAgIGtleWJvYXJkOiB0cnVlLFxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbXNnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9rVGV4dDogb2tUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbFRleHQ6IGNhbmNlbFRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1QYXNzd29yZDogJydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gJG1vZGFsLm9wZW4obW9kYWxPcHRpb25zKS5yZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZXNldFBhc3N3b3JkRGlhbG9nKHRpdGxlLCBtc2csIG9rVGV4dCwgY2FuY2VsVGV4dCkge1xuICAgICAgICAgICAgdmFyIG1vZGFsT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Jlc2V0UGFzc3dvcmREaWFsb2cudHBsLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFJlc2V0UGFzc3dvcmRNb2RhbEluc3RhbmNlLFxuICAgICAgICAgICAgICAgIGtleWJvYXJkOiB0cnVlLFxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbXNnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9rVGV4dDogb2tUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbFRleHQ6IGNhbmNlbFRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1QYXNzd29yZDogJydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gJG1vZGFsLm9wZW4obW9kYWxPcHRpb25zKS5yZXN1bHQ7XG4gICAgICAgIH1cblxuXG4gICAgfVxuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gTW9kYWxJbnN0YW5jZSgkc2NvcGUsICRtb2RhbEluc3RhbmNlLCBvcHRpb25zKSB7XG4gICAgICAgICRzY29wZS50aXRsZSA9IG9wdGlvbnMudGl0bGUgfHwgJ1RpdGVsJztcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBvcHRpb25zLm1lc3NhZ2UgfHwgJyc7XG4gICAgICAgICRzY29wZS5va1RleHQgPSBvcHRpb25zLm9rVGV4dCB8fCAnT2snO1xuICAgICAgICAkc2NvcGUuY2FuY2VsVGV4dCA9IG9wdGlvbnMuY2FuY2VsVGV4dCB8fCAnQW5udWxlcmVuJztcbiAgICAgICAgJHNjb3BlLm9rID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoJ29rJyk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBSZXNldFBhc3N3b3JkTW9kYWxJbnN0YW5jZSgkc2NvcGUsICRtb2RhbEluc3RhbmNlLCBvcHRpb25zKSB7XG4gICAgICAgICRzY29wZS50aXRsZSA9IG9wdGlvbnMudGl0bGUgfHwgJ1Bhc3dvb3JkIG9wbmlldXcgaW5zdGVsbGVuJztcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBvcHRpb25zLm1lc3NhZ2UgfHwgJ0dlZWYgaGV0IG5pZXV3ZSBwYXN3b29yZCBpbi4nO1xuICAgICAgICAkc2NvcGUub2tUZXh0ID0gb3B0aW9ucy5va1RleHQgfHwgJ1dpanppZyc7XG4gICAgICAgICRzY29wZS5jYW5jZWxUZXh0ID0gb3B0aW9ucy5jYW5jZWxUZXh0IHx8ICdBbm51bGVyZW4nO1xuICAgICAgICAkc2NvcGUucGFzc3dvcmQgPSAnJztcbiAgICAgICAgJHNjb3BlLmNvbmZpcm1QYXNzd29yZCA9ICcnO1xuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSh7cGFzc3dvcmQ6ICRzY29wZS5wYXNzd29yZH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJNb2RlbERpYWxvZygkdGVtcGxhdGVDYWNoZSkge1xuICAgICAgICAkdGVtcGxhdGVDYWNoZS5wdXQoJ21vZGFsRGlhbG9nLnRwbC5odG1sJyxcbiAgICAgICAgICAgICc8ZGl2PicgK1xuICAgICAgICAgICAgJyAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCIgZGF0YS1kaXNtaXNzPVwibW9kYWxcIiAnICtcbiAgICAgICAgICAgICcgICAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIiBkYXRhLW5nLWNsaWNrPVwiY2FuY2VsKClcIj4mdGltZXM7PC9idXR0b24+JyArXG4gICAgICAgICAgICAnICAgICAgICA8aDM+e3t0aXRsZX19PC9oMz4nICtcbiAgICAgICAgICAgICcgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8cD57e21lc3NhZ2V9fTwvcD4nICtcbiAgICAgICAgICAgICcgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIiBkYXRhLW5nLWNsaWNrPVwib2soKVwiPnt7b2tUZXh0fX08L2J1dHRvbj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLWluZm9cIiBkYXRhLW5nLWNsaWNrPVwiY2FuY2VsKClcIj57e2NhbmNlbFRleHR9fTwvYnV0dG9uPicgK1xuICAgICAgICAgICAgJyAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICc8L2Rpdj4nKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWdpc3RlclJlc2V0UGFzc3dvcmREaWFsb2coJHRlbXBsYXRlQ2FjaGUpIHtcbiAgICAgICAgJHRlbXBsYXRlQ2FjaGUucHV0KCdyZXNldFBhc3N3b3JkRGlhbG9nLnRwbC5odG1sJyxcbiAgICAgICAgICAgICc8ZGl2PicgK1xuICAgICAgICAgICAgJyAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCIgZGF0YS1kaXNtaXNzPVwibW9kYWxcIiAnICtcbiAgICAgICAgICAgICcgICAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIiBkYXRhLW5nLWNsaWNrPVwiY2FuY2VsKClcIj4mdGltZXM7PC9idXR0b24+JyArXG4gICAgICAgICAgICAnICAgICAgICA8aDM+e3t0aXRsZX19PC9oMz4nICtcbiAgICAgICAgICAgICcgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8cD57e21lc3NhZ2V9fTwvcD4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICAgICA8bGFiZWwgY2xhc3M9XCJjb250cm9sLWxhYmVsXCI+UGFzd29vcmQ8L2xhYmVsPicgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgPGlucHV0IHR5cGU9XCJwYXNzd29yZFwiIGRhdGEtbmctbW9kZWw9XCJwYXNzd29yZFwiIHBsYWNlaG9sZGVyPVwiTmlldXcgcGFzd29vcmRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwiY29udHJvbC1sYWJlbFwiPkhlcmhhYWwgcGFzc3dvcmQ8L2xhYmVsPicgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgPGlucHV0IHR5cGU9XCJwYXNzd29yZFwiIGRhdGEtbmctbW9kZWw9XCJjb25maXJtUGFzc3dvcmRcIiBwbGFjZWhvbGRlcj1cIkhlcmhhYWwgcGFzd29vcmRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJ0ZXh0LWRhbmdlclwiIGRhdGEtbmctc2hvdz1cInBhc3N3b3JkICE9PSBjb25maXJtUGFzc3dvcmQgJiYgcGFzc3dvcmQgIT09IFxcJ1xcJ1wiPkRlIHBhc3dvb3JkZW4ga29tZW4gbmlldCBvdmVyZWVuLjwvc3Bhbj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDwvZGl2PicgK1xuICAgICAgICAgICAgJyAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICcgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIGRhdGEtbmctY2xpY2s9XCJvaygpXCIgZGF0YS1uZy1kaXNhYmxlZD1cInBhc3N3b3JkICE9PSBjb25maXJtUGFzc3dvcmQgfHwgcGFzc3dvcmQgPT09IFxcJ1xcJ1wiPnt7b2tUZXh0fX08L2J1dHRvbj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLWluZm9cIiBkYXRhLW5nLWNsaWNrPVwiY2FuY2VsKClcIj57e2NhbmNlbFRleHR9fTwvYnV0dG9uPicgK1xuICAgICAgICAgICAgJyAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICc8L2Rpdj4nKTtcbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmNvcmVcbiAqIEZBQ1RPUlk6IGNvbW1vblxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuY29yZScpXG4gICAgICAgIC5mYWN0b3J5KCdjb21tb24nLCBjb21tb24pO1xuXG4gICAgZnVuY3Rpb24gY29tbW9uKCRxLCAkcm9vdFNjb3BlLCAkdGltZW91dCwgbG9nZ2VyKSB7XG4gICAgICAgIHZhciB0aHJvdHRsZXMgPSB7fTtcblxuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIC8vIGNvbW1vbiBhbmd1bGFyIGRlcGVuZGVuY2llc1xuICAgICAgICAgICAgJGJyb2FkY2FzdDogJGJyb2FkY2FzdCxcbiAgICAgICAgICAgICRxOiAkcSxcbiAgICAgICAgICAgICR0aW1lb3V0OiAkdGltZW91dCxcbiAgICAgICAgICAgIC8vIGdlbmVyaWNcbiAgICAgICAgICAgIGlzTnVtYmVyOiBpc051bWJlcixcbiAgICAgICAgICAgIGRlYm91bmNlZFRocm90dGxlOiBkZWJvdW5jZWRUaHJvdHRsZSxcbiAgICAgICAgICAgIGxvZ2dlcjogbG9nZ2VyLFxuICAgICAgICAgICAgdGV4dENvbnRhaW5zOiB0ZXh0Q29udGFpbnNcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiAkYnJvYWRjYXN0KCkge1xuICAgICAgICAgICAgcmV0dXJuICRyb290U2NvcGUuJGJyb2FkY2FzdC5hcHBseSgkcm9vdFNjb3BlLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG5cblxuICAgICAgICBmdW5jdGlvbiBkZWJvdW5jZWRUaHJvdHRsZShrZXksIGNhbGxiYWNrLCBkZWxheSwgaW1tZWRpYXRlKSB7XG4gICAgICAgICAgICAvLyBQZXJmb3JtIHNvbWUgYWN0aW9uIChjYWxsYmFjaykgYWZ0ZXIgYSBkZWxheS5cbiAgICAgICAgICAgIC8vIFRyYWNrIHRoZSBjYWxsYmFjayBieSBrZXksIHNvIGlmIHRoZSBzYW1lIGNhbGxiYWNrXG4gICAgICAgICAgICAvLyBpcyBpc3N1ZWQgYWdhaW4sIHJlc3RhcnQgdGhlIGRlbGF5LlxuICAgICAgICAgICAgdmFyIGRlZmF1bHREZWxheSA9IDEwMDA7XG4gICAgICAgICAgICBkZWxheSA9IGRlbGF5IHx8IGRlZmF1bHREZWxheTtcbiAgICAgICAgICAgIGlmICh0aHJvdHRsZXNba2V5XSkge1xuICAgICAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aHJvdHRsZXNba2V5XSk7XG4gICAgICAgICAgICAgICAgdGhyb3R0bGVzW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW1tZWRpYXRlKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3R0bGVzW2tleV0gPSAkdGltZW91dChjYWxsYmFjaywgZGVsYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaXNOdW1iZXIodmFsKSB7XG4gICAgICAgICAgICAvLyBuZWdhdGl2ZSBvciBwb3NpdGl2ZVxuICAgICAgICAgICAgcmV0dXJuICgvXlstXT9cXGQrJC8pLnRlc3QodmFsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHRleHRDb250YWlucyh0ZXh0LCBzZWFyY2hUZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGV4dCAmJiAtMSAhPT0gdGV4dC50b0xvd2VyQ2FzZSgpLmluZGV4T2Yoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuZGF0YVxuICogRkFDVE9SWTogYnJlZXplQ29uZmlnXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jb3JlJylcbiAgICAgICAgLmZhY3RvcnkoJ2JyZWV6ZUNvbmZpZycsIGJyZWV6ZUNvbmZpZyk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBicmVlemVDb25maWcoYnJlZXplKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgcmVtb3RlU2VydmljZU5hbWU6ICcvYXBpL2JyZWV6ZScsXG4gICAgICAgICAgICBicmVlemU6IGJyZWV6ZVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy9cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgY29yZSA9IGFuZ3VsYXIubW9kdWxlKCdub3Rvc3BsdXMuY29yZScpO1xuXG4gICAgY29yZS5jb25maWcodG9hc3RyQ29uZmlnKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIHRvYXN0ckNvbmZpZyh0b2FzdHIpIHtcbiAgICAgICAgdG9hc3RyLm9wdGlvbnMudGltZU91dCA9IDQwMDA7XG4gICAgICAgIHRvYXN0ci5vcHRpb25zLmNsb3NlQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgdG9hc3RyLm9wdGlvbnMucHJvZ3Jlc3NCYXIgPSB0cnVlO1xuICAgICAgICB0b2FzdHIub3B0aW9ucy5wb3NpdGlvbkNsYXNzID0gJ3RvYXN0LWJvdHRvbS1yaWdodCc7XG4gICAgfVxuXG4gICAgdmFyIGtleUNvZGVzID0ge1xuICAgICAgICBiYWNrc3BhY2U6IDgsXG4gICAgICAgIHRhYjogOSxcbiAgICAgICAgZW50ZXI6IDEzLFxuICAgICAgICBlc2M6IDI3LFxuICAgICAgICBzcGFjZTogMzIsXG4gICAgICAgIHBhZ2V1cDogMzMsXG4gICAgICAgIHBhZ2Vkb3duOiAzNCxcbiAgICAgICAgZW5kOiAzNSxcbiAgICAgICAgaG9tZTogMzYsXG4gICAgICAgIGxlZnQ6IDM3LFxuICAgICAgICB1cDogMzgsXG4gICAgICAgIHJpZ2h0OiAzOSxcbiAgICAgICAgZG93bjogNDAsXG4gICAgICAgIGluc2VydDogNDUsXG4gICAgICAgIGRlbDogNDZcbiAgICB9O1xuXG4gICAgdmFyIGV2ZW50cyA9IHtcbiAgICAgICAgY29udHJvbGxlckFjdGl2YXRlU3VjY2VzczogJ2NvbnRyb2xsZXIuYWN0aXZhdGVTdWNjZXNzJyxcbiAgICAgICAgZW50aXRpZXNDaGFuZ2VkOiAnZGF0YWNvbnRleHQuZW50aXRpZXNDaGFuZ2VkJyxcbiAgICAgICAgZW50aXRpZXNJbXBvcnRlZDogJ2RhdGFjb250ZXh0LmVudGl0aWVzSW1wb3J0ZWQnLFxuICAgICAgICBoYXNDaGFuZ2VzQ2hhbmdlZDogJ2RhdGFjb250ZXh0Lmhhc0NoYW5nZXNDaGFuZ2VkJyxcbiAgICAgICAgc3RvcmFnZToge1xuICAgICAgICAgICAgZXJyb3I6ICdzdG9yZS5lcnJvcicsXG4gICAgICAgICAgICBzdG9yZUNoYW5nZWQ6ICdzdG9yZS5jaGFuZ2VkJyxcbiAgICAgICAgICAgIHdpcENoYW5nZWQ6ICd3aXAuY2hhbmdlZCdcbiAgICAgICAgfSxcbiAgICAgICAgbG9nZ2VkSW5Pcmdhbml6YXRpb25DaGFuZ2VkOiAncHJvZmlsZS5sb2dnZWRJbkF0Q2hhbmdlZCdcbiAgICB9O1xuXG5cbiAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICBhcHBFcnJvclByZWZpeDogJ1tub1RvcysgRm91dF0gJyxcbiAgICAgICAgYXBwVGl0bGU6ICdub1RvcysnLFxuICAgICAgICBrZXlDb2Rlczoga2V5Q29kZXMsXG4gICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgIGV2ZW50czogZXZlbnRzXG4gICAgfTtcblxuICAgIGNvcmUudmFsdWUoJ2NvbmZpZycsIGNvbmZpZyk7XG5cbiAgICBjb3JlLmNvbmZpZyhjb25maWd1cmUpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlndXJlKCR1cmxSb3V0ZXJQcm92aWRlciwgJHN0YXRlUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgIHJvdXRlaGVscGVyQ29uZmlnUHJvdmlkZXIsICRicmVhZGNydW1iUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgIHpTdG9yYWdlQ29uZmlnUHJvdmlkZXIsIHpEaXJlY3RpdmVzQ29uZmlnUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgIFJlc3Rhbmd1bGFyUHJvdmlkZXIpIHtcblxuICAgICAgICBjb25maWd1cmVSb3V0aW5nKCk7XG4gICAgICAgIGNvbmZpZ3VyZUJyZWFkY3J1bWIoKTtcblxuICAgICAgICBjb25maWd1cmVaU3RvcmFnZSgpO1xuICAgICAgICBjb25maWd1cmVaVmFsaWRhdGUoKTtcblxuICAgICAgICBjb25maWd1cmVSZXN0YW5ndWxhcigpO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlUm91dGluZygpIHtcbiAgICAgICAgICAgIHJvdXRlaGVscGVyQ29uZmlnUHJvdmlkZXIuY29uZmlnLiR1cmxSb3V0ZXJQcm92aWRlciA9ICR1cmxSb3V0ZXJQcm92aWRlcjtcbiAgICAgICAgICAgIHJvdXRlaGVscGVyQ29uZmlnUHJvdmlkZXIuY29uZmlnLiRzdGF0ZVByb3ZpZGVyID0gJHN0YXRlUHJvdmlkZXI7XG5cbiAgICAgICAgICAgIHJvdXRlaGVscGVyQ29uZmlnUHJvdmlkZXIuY29uZmlnLnRpdGxlID0gY29uZmlnLmFwcFRpdGxlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlQnJlYWRjcnVtYigpIHtcbiAgICAgICAgICAgICRicmVhZGNydW1iUHJvdmlkZXIuc2V0T3B0aW9ucyh7XG4gICAgICAgICAgICAgICAgcHJlZml4U3RhdGVOYW1lOiAnaW5kZXgnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnYm9vdHN0cmFwMycsXG4gICAgICAgICAgICAgICAgaW5jbHVkZUFic3RyYWN0OiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVpTdG9yYWdlKCkge1xuICAgICAgICAgICAgLy8gU2V0dXAgb3VyIEJyZWV6ZS1iYXNlZCBvZmZsaW5lIHN0b3JhZ2VcbiAgICAgICAgICAgIHpTdG9yYWdlQ29uZmlnUHJvdmlkZXIuY29uZmlnID0ge1xuICAgICAgICAgICAgICAgIC8vIHpTdG9yYWdlXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAga2V5OiAnbm9Ub3NQbHVzJyxcbiAgICAgICAgICAgICAgICBldmVudHM6IGNvbmZpZy5ldmVudHMuc3RvcmFnZSxcblxuICAgICAgICAgICAgICAgIC8vIHpTdG9yYWdlV2lwXG4gICAgICAgICAgICAgICAgd2lwS2V5OiAnbm9Ub3NQbHVzLndpcCcsXG4gICAgICAgICAgICAgICAgYXBwRXJyb3JQcmVmaXg6IGNvbmZpZy5hcHBFcnJvclByZWZpeCxcbiAgICAgICAgICAgICAgICBuZXdHdWlkOiBicmVlemUuY29yZS5nZXRVdWlkLFxuXG4gICAgICAgICAgICAgICAgLy8gelN0b3JhZ2VDb3JlXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogY29uZmlnLnZlcnNpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjb25maWd1cmVaVmFsaWRhdGUoKSB7XG4gICAgICAgICAgICB6RGlyZWN0aXZlc0NvbmZpZ1Byb3ZpZGVyLnpWYWxpZGF0ZVRlbXBsYXRlID1cbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJpbnZhbGlkXCI+PGkgY2xhc3M9XCJmYSBmYS13YXJuaW5nLXNpZ25cIj48L2k+JyArXG4gICAgICAgICAgICAgICAgJ09uYmVncmlqcGVsaWprISAlZXJyb3IlPC9zcGFuPic7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVJlc3Rhbmd1bGFyKCkge1xuICAgICAgICAgICAgdmFyIGJhc2VVcmwgPSAnL2FwaSc7XG5cbiAgICAgICAgICAgIFJlc3Rhbmd1bGFyUHJvdmlkZXIuc2V0QmFzZVVybChiYXNlVXJsKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyogZ2xvYmFsIHRvYXN0cjpmYWxzZSwgbW9tZW50OmZhbHNlICovXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuY29yZScpXG4gICAgICAgIC5jb25zdGFudCgndG9hc3RyJywgdG9hc3RyKVxuICAgICAgICAuY29uc3RhbnQoJ21vbWVudCcsIG1vbWVudClcbiAgICAgICAgLmNvbnN0YW50KCdfJywgd2luZG93Ll8pO1xufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5jb3JlXG4gKiBGQUNUT1JZOiBJbml0XG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jb3JlJylcbiAgICAgICAgLmZhY3RvcnkoJ0luaXQnLCBJbml0KTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEluaXQoKSB7XG4gICAgICAgIHZhciB3YXNJbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgaXNJbml0aWFsaXplZDogaXNJbml0aWFsaXplZCxcbiAgICAgICAgICAgIGluaXRpYWxpemluZzogaW5pdGlhbGl6aW5nXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGlzSW5pdGlhbGl6ZWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2FzSW5pdGlhbGl6ZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6aW5nKGluaXQpIHtcbiAgICAgICAgICAgIHdhc0luaXRpYWxpemVkID0gaW5pdDtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIgICAgLyoqXG4gKiBub3Rvc3BsdXMuY29yZVxuICogRklMVEVSOiBIaWdobGlnaHRcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5kYXRhJylcbiAgICAgICAgLmZpbHRlcignSGlnaGxpZ2h0JywgSGlnaGxpZ2h0KTtcblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgZnVuY3Rpb24gSGlnaGxpZ2h0KCRzY2UpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzdHIsIHRlcm1zVG9IaWdobGlnaHQpIHtcbiAgICAgICAgICAgIGlmICh0ZXJtc1RvSGlnaGxpZ2h0ID09PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKHN0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBTb3J0IHRlcm1zIGJ5IGxlbmd0aFxuICAgICAgICAgICAgdGVybXNUb0hpZ2hsaWdodCA9IHRlcm1zVG9IaWdobGlnaHQuc3BsaXQoXCIgXCIpO1xuICAgICAgICAgICAgdGVybXNUb0hpZ2hsaWdodC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGIubGVuZ3RoIC0gYS5sZW5ndGg7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gUmVnZXggdG8gc2ltdWx0YW5lb3VzbHkgcmVwbGFjZSB0ZXJtc1xuICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCgnKD8hPFtePl0qPz4pJyArIHRlcm1zVG9IaWdobGlnaHQuam9pbignfCcpICsgJyg/IVtePF0qPzwvW14+XSo/PiknLCAnZ2knKTtcbiAgICAgICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKHN0ci5yZXBsYWNlKHJlZ2V4LCAnPHNwYW4gY2xhc3M9XCJtYXRjaFwiPiQmPC9zcGFuPicpKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuZGF0YVxuICogRkFDVE9SWTogSFRUUENhY2hlXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5kYXRhJylcbiAgICAgICAgLmZhY3RvcnkoJ0hUVFBDYWNoZScsIEhUVFBDYWNoZSk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBIVFRQQ2FjaGUoUmVzdGFuZ3VsYXIsICRjYWNoZUZhY3RvcnkpIHtcbiAgICAgICAgdmFyIGNhY2hlO1xuICAgICAgICBjYWNoZSA9ICRjYWNoZUZhY3RvcnkoJ2h0dHAnKTtcblxuICAgICAgICByZXR1cm4gUmVzdGFuZ3VsYXIud2l0aENvbmZpZyhmdW5jdGlvbiAoUmVzdGFuZ3VsYXJDb25maWd1cmVyKSB7XG4gICAgICAgICAgICBSZXN0YW5ndWxhckNvbmZpZ3VyZXIuc2V0RGVmYXVsdEh0dHBGaWVsZHMoe2NhY2hlOiBjYWNoZX0pO1xuICAgICAgICAgICAgUmVzdGFuZ3VsYXJDb25maWd1cmVyLnNldFJlc3BvbnNlSW50ZXJjZXB0b3IoZnVuY3Rpb24gKHJlc3BvbnNlLCBvcGVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAob3BlcmF0aW9uID09PSAncHV0JyB8fCBvcGVyYXRpb24gPT09ICdwb3N0JyB8fCBvcGVyYXRpb24gPT09ICdkZWxldGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlLnJlbW92ZUFsbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gQ3VzdG9tIEdsb2JhbCBNZXRob2QocykgZm9yIFJlc3Rhbmd1bGFyaXplZCBFbGVtZW50cy5cbiAgICAgICAgICAgIFJlc3Rhbmd1bGFyQ29uZmlndXJlci5zZXRPbkVsZW1SZXN0YW5ndWxhcml6ZWQoZnVuY3Rpb24oZWxlbSwgaXNDb2xsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgZWxlbS5jbGVhckNhY2hlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlLnJlbW92ZUFsbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmF1dGhcbiAqIEZBQ1RPUlk6IFByb2ZpbGVcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmF1dGgnKVxuICAgICAgICAuZmFjdG9yeSgnUHJvZmlsZVNlcnZpY2UnLCBQcm9maWxlU2VydmljZSk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBQcm9maWxlU2VydmljZSgkaHR0cCwgZXhjZXB0aW9uLCAkcSwgY29tbW9uLCBjb25maWcpIHtcbiAgICAgICAgdmFyIGNhY2hlID0gbnVsbDtcbiAgICAgICAgdmFyIF9yZWFsbSA9IG51bGw7XG4gICAgICAgIHZhciBldmVudHMgPSBjb25maWcuZXZlbnRzO1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgY3VycmVudDogY3VycmVudCxcbiAgICAgICAgICAgIHJlYWxtOiByZWFsbSxcbiAgICAgICAgICAgIHNldFJlYWxtOiBzZXRSZWFsbVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGN1cnJlbnQoZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICBpZiAoY2FjaGUgJiYgIWZvcmNlUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgIC8vc2hvdWxkIHJldHVybiBwcm9taXNlXG4gICAgICAgICAgICAgICAgcmV0dXJuICRxLndoZW4oY2FjaGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXIvcHJvZmlsZScpXG4gICAgICAgICAgICAgICAgLnRoZW4oZ2V0Q3VycmVudENvbXBsZXRlKVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBleGNlcHRpb24uY2F0Y2hlcignUHJvZmllbCB2YW4gZGUgaHVpZGlnZSBnZWJydWlrZXIgb3B2cmFnZW4sIGx1a3QgbmlldC4nKShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRDdXJyZW50Q29tcGxldGUocmVzcG9uc2UsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgY2FjaGUgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgICAgIHNlcnZpY2Uuc2V0UmVhbG0ocmVzcG9uc2UuZGF0YS5yZWFsbSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlYWxtKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9yZWFsbTsgLy9zeW5jaHJvbm91cywgYXMgYXN5bmMgZGF0YSB3YXMgaGVyZSBhdCBpbml0aWFsaXphdGlvblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0UmVhbG0ocmVhbG0pIHtcbiAgICAgICAgICAgIC8vcmVhbG0uZG9tYWluX25hbWU9IHJlYWxtLmRvbWFpbl9uYW1lLnJlcGxhY2UoL1xcLi9nLCAnXycpO1xuICAgICAgICAgICAgX3JlYWxtID0gcmVhbG07XG4gICAgICAgICAgICBjb21tb24uJGJyb2FkY2FzdChldmVudHMucmVhbG1DaGFuZ2VkLCByZWFsbSk7XG4gICAgICAgIH1cblxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuY3VycmljdWxhXG4gKiBGQUNUT1JZOiBDdXJyaWN1bHVtXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jdXJyaWN1bGEnKVxuICAgICAgICAuZmFjdG9yeSgnQ3VycmljdWx1bScsIEN1cnJpY3VsdW0pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gQ3VycmljdWx1bShIVFRQQ2FjaGUpIHtcblxuICAgICAgICB2YXIgc2VydmljZT0ge1xuICAgICAgICAgICAgZ2V0OiBnZXQsXG4gICAgICAgICAgICBvYmplY3RpdmVzOiBvYmplY3RpdmVzXG4gICAgICAgIH1cblxuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldChjb3Vyc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBIVFRQQ2FjaGUub25lKCcvY3VycmljdWxhJywgY291cnNlKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBvYmplY3RpdmVzKGNvdXJzZSkge1xuICAgICAgICAgICAgcmV0dXJuIGdldChjb3Vyc2UpLmdldExpc3QoJ29iamVjdGl2ZXMnKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuZGFzaGJvYXJkXG4gKiBDT05UUk9MTEVSOiBEYXNoYm9hcmRDb250cm9sbGVyXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuZGFzaGJvYXJkJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0Rhc2hib2FyZENvbnRyb2xsZXInLCBEYXNoYm9hcmRDb250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIERhc2hib2FyZENvbnRyb2xsZXIoY29tbW9uLCBjb25maWcpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdmFyIGV2ZW50cyA9IGNvbmZpZy5ldmVudHM7XG5cbiAgICAgICAgYWN0aXZhdGUoKTtcbiAgICAgICAgLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICAgICAgY29tbW9uLiRicm9hZGNhc3QoZXZlbnRzLmNvbnRyb2xsZXJBY3RpdmF0ZVN1Y2Nlc3MpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIFJPVVRFUzogbm90b3NwbHVzLmRhc2hib2FyZFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmRhc2hib2FyZCcpXG4gICAgICAgIC5ydW4oY29uZmlnUm91dGVzKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZ1JvdXRlcyhyb3V0ZWhlbHBlcikge1xuICAgICAgICByb3V0ZWhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdpbmRleCcsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvaW5kZXgnLFxuICAgICAgICAgICAgICAgICAgICBuY3lCcmVhZGNydW1iOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ3N0YXJ0J1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2luZGV4LmRhc2hib2FyZCcsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvbW9kdWxlcy9kYXNoYm9hcmQvZGFzaGJvYXJkLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEYXNoYm9hcmQnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH07XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmxheW91dFxuICogQ09OVFJPTExFUjogc2hlbGxcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5sYXlvdXQnKVxuICAgICAgICAuY29udHJvbGxlcignU2hlbGxDb250cm9sbGVyJywgU2hlbGxDb250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFNoZWxsQ29udHJvbGxlcihJbml0LCAkcm9vdFNjb3BlLCBjb25maWcsIFByb2ZpbGVTZXJ2aWNlLCBsb2dnZXIpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0uYnVzeU1lc3NhZ2UgPSAnRXZlbiBnZWR1bGQuLi4nO1xuICAgICAgICB2bS5pc0J1c3kgPSB0cnVlO1xuICAgICAgICB2bS5zaG93U3BsYXNoID0gZmFsc2U7XG4gICAgICAgIHZtLmF2YXRhciA9IG51bGw7XG4gICAgICAgIHZtLnByb2ZpbGUgPSB7fTtcbiAgICAgICAgdm0ubG9nZ2VkSW5Pcmdhbml6YXRpb24gPSBudWxsO1xuXG4gICAgICAgIHZhciBldmVudHMgPSBjb25maWcuZXZlbnRzO1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG4gICAgICAgIC8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcblxuICAgICAgICAgICAgaWYgKCFJbml0LmlzSW5pdGlhbGl6ZWQoKSkge1xuICAgICAgICAgICAgICAgIHZtLnNob3dTcGxhc2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgIEluaXQuaW5pdGlhbGl6aW5nKHRydWUpO1xuICAgICAgICAgICAgICAgIGdldFByb2ZpbGUoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdm0ucHJvZmlsZSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIHZtLnByb2ZpbGUuZnVsbE5hbWUgPSB2bS5wcm9maWxlLmZpcnN0X25hbWUgKyAnICcgKyB2bS5wcm9maWxlLmxhc3RfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgLy92bS5wcm9maWxlLm9yZ2FuaXphdGlvbnMgPSBwcm9maWxlLm9yZ2FuaXphdGlvbnM7XG5cbiAgICAgICAgICAgICAgICAgICAgdm0uYXZhdGFyID1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLnByb2ZpbGUuYXZhdGFyIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAodm0ucHJvZmlsZS5nZW5kZXIgPT09ICdGJyA/ICcvaW1nL3VzZXIvZmVtYWxlLnBuZycgOiAnL2ltZy91c2VyL21hbGUucG5nJykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICcvaW1nL3VzZXIvbWFsZS5wbmcnO1xuXG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVkKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9maWxlKCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb2ZpbGVTZXJ2aWNlLmN1cnJlbnQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0ucHJvZmlsZSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLnByb2ZpbGU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZVNwaW5uZXIob24pIHtcbiAgICAgICAgICAgIHZtLmlzQnVzeSA9IG9uO1xuICAgICAgICB9XG5cbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN0YXJ0JyxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChldmVudCwgbmV4dCwgY3VycmVudCkge1xuICAgICAgICAgICAgICAgIHRvZ2dsZVNwaW5uZXIodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgJHJvb3RTY29wZS4kb24oZXZlbnRzLmNvbnRyb2xsZXJBY3RpdmF0ZVN1Y2Nlc3MsXG4gICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHRvZ2dsZVNwaW5uZXIoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICAkcm9vdFNjb3BlLiRvbihldmVudHMucmVhbG1DaGFuZ2VkLFxuICAgICAgICAgICAgZnVuY3Rpb24gKHNjb3BlLCByZWFsbSkge1xuICAgICAgICAgICAgICAgIHZtLnJlYWxtID0gcmVhbG07XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplZCgpIHtcbiAgICAgICAgICAgIHZtLnNob3dTcGxhc2ggPSBmYWxzZTtcblxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oJ1dlbGtvbSAnICsgdm0ucHJvZmlsZS5maXJzdF9uYW1lKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIvKipcbiAqIFJPVVRFUzogbm90b3NwbHVzLmxpYnJhcnlcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5saWJyYXJ5JylcbiAgICAgICAgLnJ1bihjb25maWdSb3V0ZXMpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlnUm91dGVzKHJvdXRlaGVscGVyKSB7XG4gICAgICAgIHJvdXRlaGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xpYnJhcnknLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2xpYnJhcnknXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xpYnJhcnkuYm9va3MnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYm9va3MnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvbW9kdWxlcy9saWJyYXJ5L2Jvb2tzL2Jvb2tzLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdCb29rc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0JvZWtlbidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGlicmFyeS53ZWJzaXRlcycsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy93ZWJzaXRlcycsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL2xpYnJhcnkvd2Vic2l0ZXMvd2Vic2l0ZXMuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1dlYnNpdGVzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnV2Vic2l0ZXMnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xpYnJhcnkud2Vic2l0ZXMuZGV0YWlsJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLzppZCcsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL2xpYnJhcnkvd2Vic2l0ZXMvd2Vic2l0ZWRldGFpbC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnV2Vic2l0ZURldGFpbENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1dlYnNpdGUgYmV3ZXJrZW4nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xpYnJhcnkud2Vic2l0ZXMuZGV0YWlsLm9iamVjdGl2ZXMnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6Jy9vYmplY3RpdmVzJyxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2pzL21vZHVsZXMvY3VycmljdWxhL29iamVjdGl2ZXMvc2VsZWN0X29iamVjdGl2ZXMuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlbGVjdE9iamVjdGl2ZXNDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdEb2VsZW4gc2VsZWN0ZXJlbidcbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9O1xufSkoKTsiLCIvKipcbiAqIFJPVVRFUzogbm90b3NwbHVzLm1hbmFnZVxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLm1hbmFnZScpXG4gICAgICAgIC5ydW4oY29uZmlnUm91dGVzKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZ1JvdXRlcyhyb3V0ZWhlbHBlcikge1xuICAgICAgICByb3V0ZWhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdtYW5hZ2UnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL21hbmFnZScsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnQmVoZWVyJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdtYW5hZ2UudXNlcnMnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvdXNlcnMnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvbW9kdWxlcy9tYW5hZ2UvdXNlcnMvdXNlcnMuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1VzZXJzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnR2VicnVpa2VycydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbWFuYWdlLnVzZXJzLmRldGFpbCcsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy86aWQnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvbW9kdWxlcy9tYW5hZ2UvdXNlcnMvdXNlcmRldGFpbC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVXNlckRldGFpbENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0dlYnJ1aWtlciBiZXdlcmtlbidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfTtcbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMudGFnc1xuICogRkFDVE9SWTogVGFnXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy50YWdzJylcbiAgICAgICAgLmZhY3RvcnkoJ1RhZycsIFRhZyk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBUYWcoSFRUUENhY2hlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0gSFRUUENhY2hlLnNlcnZpY2UoJ3RhZ3MnKTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgIH1cbn0pKCk7IiwiLy8gSW5jbHVkZSBpbiBpbmRleC5odG1sIHNvIHRoYXQgYXBwIGxldmVsIGV4Y2VwdGlvbnMgYXJlIGhhbmRsZWQuXG4vLyBFeGNsdWRlIGZyb20gdGVzdFJ1bm5lci5odG1sIHdoaWNoIHNob3VsZCBydW4gZXhhY3RseSB3aGF0IGl0IHdhbnRzIHRvIHJ1blxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicpXG4gICAgICAgIC5wcm92aWRlcignZXhjZXB0aW9uSGFuZGxlcicsIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcilcbiAgICAgICAgLmNvbmZpZyhjb25maWcpO1xuXG4gICAgLyoqXG4gICAgICogTXVzdCBjb25maWd1cmUgdGhlIGV4Y2VwdGlvbiBoYW5kbGluZ1xuICAgICAqIEByZXR1cm4ge1t0eXBlXX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIoKSB7XG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgICB0aGlzLmNvbmZpZyA9IHtcbiAgICAgICAgICAgIGFwcEVycm9yUHJlZml4OiB1bmRlZmluZWRcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uIChhcHBFcnJvclByZWZpeCkge1xuICAgICAgICAgICAgdGhpcy5jb25maWcuYXBwRXJyb3JQcmVmaXggPSBhcHBFcnJvclByZWZpeDtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB7Y29uZmlnOiB0aGlzLmNvbmZpZ307XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29uZmlndXJlIGJ5IHNldHRpbmcgYW4gb3B0aW9uYWwgc3RyaW5nIHZhbHVlIGZvciBhcHBFcnJvclByZWZpeC5cbiAgICAgKiBBY2Nlc3NpYmxlIHZpYSBjb25maWcuYXBwRXJyb3JQcmVmaXggKHZpYSBjb25maWcgdmFsdWUpLlxuICAgICAqIEBwYXJhbSAge1t0eXBlXX0gJHByb3ZpZGVcbiAgICAgKiBAcmV0dXJuIHtbdHlwZV19XG4gICAgICogQG5nSW5qZWN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlnKCRwcm92aWRlKSB7XG4gICAgICAgICRwcm92aWRlLmRlY29yYXRvcignJGV4Y2VwdGlvbkhhbmRsZXInLCBleHRlbmRFeGNlcHRpb25IYW5kbGVyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRlbmQgdGhlICRleGNlcHRpb25IYW5kbGVyIHNlcnZpY2UgdG8gYWxzbyBkaXNwbGF5IGEgdG9hc3QuXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAkZGVsZWdhdGVcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGV4Y2VwdGlvbkhhbmRsZXJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGxvZ2dlclxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSB0aGUgZGVjb3JhdGVkICRleGNlcHRpb25IYW5kbGVyIHNlcnZpY2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHRlbmRFeGNlcHRpb25IYW5kbGVyKCRkZWxlZ2F0ZSwgZXhjZXB0aW9uSGFuZGxlciwgbG9nZ2VyKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihleGNlcHRpb24sIGNhdXNlKSB7XG4gICAgICAgICAgICB2YXIgYXBwRXJyb3JQcmVmaXggPSBleGNlcHRpb25IYW5kbGVyLmNvbmZpZy5hcHBFcnJvclByZWZpeCB8fCAnJztcbiAgICAgICAgICAgIHZhciBlcnJvckRhdGEgPSB7ZXhjZXB0aW9uOiBleGNlcHRpb24sIGNhdXNlOiBjYXVzZX07XG4gICAgICAgICAgICBleGNlcHRpb24ubWVzc2FnZSA9IGFwcEVycm9yUHJlZml4ICsgZXhjZXB0aW9uLm1lc3NhZ2U7XG4gICAgICAgICAgICAkZGVsZWdhdGUoZXhjZXB0aW9uLCBjYXVzZSk7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvdWxkIGFkZCB0aGUgZXJyb3IgdG8gYSBzZXJ2aWNlJ3MgY29sbGVjdGlvbixcbiAgICAgICAgICAgICAqIGFkZCBlcnJvcnMgdG8gJHJvb3RTY29wZSwgbG9nIGVycm9ycyB0byByZW1vdGUgd2ViIHNlcnZlcixcbiAgICAgICAgICAgICAqIG9yIGxvZyBsb2NhbGx5LiBPciB0aHJvdyBoYXJkLiBJdCBpcyBlbnRpcmVseSB1cCB0byB5b3UuXG4gICAgICAgICAgICAgKiB0aHJvdyBleGNlcHRpb247XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICAgICAqICAgICB0aHJvdyB7IG1lc3NhZ2U6ICdlcnJvciBtZXNzYWdlIHdlIGFkZGVkJyB9O1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXhjZXB0aW9uLm1lc3NhZ2UsIGVycm9yRGF0YSk7XG4gICAgICAgIH07XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIGJsb2Nrcy5leGNlcHRpb25cbiAqIEZBQ1RPUlk6IGV4Y2VwdGlvblxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcbiAgICAgICAgLmZhY3RvcnkoJ2V4Y2VwdGlvbicsIGV4Y2VwdGlvbik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBleGNlcHRpb24obG9nZ2VyKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgY2F0Y2hlcjogY2F0Y2hlclxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBjYXRjaGVyKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IobWVzc2FnZSwgcmVhc29uKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogYmxvY2tzLmxvZ2dlclxuICogRkFDVE9SWTogbG9nZ2VyXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInKVxuICAgICAgICAuZmFjdG9yeSgnbG9nZ2VyJywgbG9nZ2VyKTtcblxuICAgIGxvZ2dlci4kaW5qZWN0ID0gWyckbG9nJywgJ3RvYXN0ciddO1xuXG4gICAgZnVuY3Rpb24gbG9nZ2VyKCRsb2csIHRvYXN0cikge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIHNob3dUb2FzdHM6IHRydWUsXG5cbiAgICAgICAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgICAgICAgIGluZm86IGluZm8sXG4gICAgICAgICAgICBzdWNjZXNzOiBzdWNjZXNzLFxuICAgICAgICAgICAgd2FybmluZzogd2FybmluZyxcblxuICAgICAgICAgICAgcmVtb3ZlZDogcmVtb3ZlZCxcbiAgICAgICAgICAgIHNhdmVkOiBzYXZlZCxcblxuICAgICAgICAgICAgLy8gc3RyYWlnaHQgdG8gY29uc29sZTsgYnlwYXNzIHRvYXN0clxuICAgICAgICAgICAgbG9nOiAkbG9nLmxvZ1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgdG9hc3RyLmVycm9yKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ0ZvdXQ6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluZm8obWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIHRvYXN0ci5pbmZvKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuaW5mbygnSW5mbzogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5pbmZvKCdTdWNjZXM6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cud2FybignTGV0IG9wOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVkKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICB0b2FzdHIud2FybmluZyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLndhcm4oJ1ZlcndpamRlcmQ6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVkKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmluZm8oJ0Jld2FhcmQ6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMucm91dGVyXG4gKiBGQUNUT1JZOiByb3V0ZWhlbHBlclxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3Mucm91dGVyJylcbiAgICAgICAgLnByb3ZpZGVyKCdyb3V0ZWhlbHBlckNvbmZpZycsIHJvdXRlaGVscGVyQ29uZmlnKVxuICAgICAgICAuZmFjdG9yeSgncm91dGVoZWxwZXInLCByb3V0ZWhlbHBlcik7XG5cbiAgICByb3V0ZWhlbHBlci4kaW5qZWN0ID0gWydyb3V0ZWhlbHBlckNvbmZpZycsICckcm9vdFNjb3BlJywgJyRzdGF0ZSddO1xuXG4gICAgZnVuY3Rpb24gcm91dGVoZWxwZXJDb25maWcoKSB7XG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgICB0aGlzLmNvbmZpZyA9IHt9O1xuXG4gICAgICAgIHRoaXMuJGdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY29uZmlnOiB0aGlzLmNvbmZpZ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByb3V0ZWhlbHBlcihyb3V0ZWhlbHBlckNvbmZpZywgJHJvb3RTY29wZSwgJHN0YXRlKSB7XG4gICAgICAgIHZhciAkdXJsUm91dGVyUHJvdmlkZXIgPSByb3V0ZWhlbHBlckNvbmZpZy5jb25maWcuJHVybFJvdXRlclByb3ZpZGVyO1xuICAgICAgICB2YXIgJHN0YXRlUHJvdmlkZXIgPSByb3V0ZWhlbHBlckNvbmZpZy5jb25maWcuJHN0YXRlUHJvdmlkZXI7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBjb25maWd1cmVTdGF0ZXM6IGNvbmZpZ3VyZVN0YXRlcyxcbiAgICAgICAgICAgIHN0YXRlczogc3RhdGVzLFxuICAgICAgICAgICAgZ2V0OiBnZXRcbiAgICAgICAgfTtcblxuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVN0YXRlcyhzdGF0ZXMpIHtcbiAgICAgICAgICAgIHN0YXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5jb25maWcudGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuY29uZmlnLm5jeUJyZWFkY3J1bWIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogc3RhdGUuY29uZmlnLnRpdGxlLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKHN0YXRlLnN0YXRlLCBzdGF0ZS5jb25maWcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzdGF0ZXMoKSB7XG4gICAgICAgICAgICByZXR1cm4gJHN0YXRlLmdldCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0KHBhdHRlcm4pIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xuICAgICAgICAgICAgc3RhdGVzKCkuZm9yRWFjaChmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUubmFtZSA9PT0gcGF0dGVybikge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBzdGF0ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB1cGRhdGVEb2NUaXRsZSgpO1xuICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2luZGV4L2Rhc2hib2FyZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlRG9jVGl0bGUoKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGV2ZW50LCBjdXJyZW50LCBwcmV2aW91cykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSByb3V0ZWhlbHBlckNvbmZpZy5jb25maWcudGl0bGUgKyAoY3VycmVudC50aXRsZSA/ICcgfCAnICsgY3VycmVudC50aXRsZSA6ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50aXRsZSA9IHRpdGxlOyAvLyBkYXRhIGJpbmQgdG8gPHRpdGxlPlxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRzdGF0ZSA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5jdXJyaWN1bGFcbiAqIENPTlRST0xMRVI6IFNlbGVjdE9iamVjdGl2ZXNDb250cm9sbGVyXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuY3VycmljdWxhJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1NlbGVjdE9iamVjdGl2ZXNDb250cm9sbGVyJywgU2VsZWN0T2JqZWN0aXZlc0NvbnRyb2xsZXIpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gU2VsZWN0T2JqZWN0aXZlc0NvbnRyb2xsZXIoY29tbW9uLCBjb25maWcsIFdlYnNpdGVEcmFmdCwgQ3VycmljdWx1bSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUsICRzY29wZSwgU2VhcmNoU2libGluZ3NJbmNsdWRlZEZpbHRlcikge1xuICAgICAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5vYmplY3RpdmVzID0gW107XG4gICAgICAgIHZtLmZpbHRlcmVkID0gW107XG4gICAgICAgIHZtLnNlbGVjdGVkSXRlbXMgPSBbXTtcbiAgICAgICAgdm0ud2Vic2l0ZSA9IG51bGw7XG5cbiAgICAgICAgdm0uc2F2ZSA9IHNhdmU7XG4gICAgICAgIHZtLmNhbmNlbCA9IGNhbmNlbDtcbiAgICAgICAgdm0uY29tcGFyZU9iamVjdGl2ZSA9IGNvbXBhcmVPYmplY3RpdmU7XG5cbiAgICAgICAgdm0uaXRlbXNQZXJQYWdlID0gMTA7XG4gICAgICAgIHZtLmN1cnJlbnRQYWdlID0gMTtcbiAgICAgICAgdm0udG90YWxJdGVtcyA9IDA7XG5cbiAgICAgICAgdm0uc2VhcmNoID0gJyc7XG5cbiAgICAgICAgdmFyIGV2ZW50cyA9IGNvbmZpZy5ldmVudHM7XG5cbiAgICAgICAgYWN0aXZhdGUoKTtcbiAgICAgICAgLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgICBnZXRJdGVtcygpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxvYWREcmFmdCgpO1xuICAgICAgICAgICAgICAgIGNvbW1vbi4kYnJvYWRjYXN0KGV2ZW50cy5jb250cm9sbGVyQWN0aXZhdGVTdWNjZXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogU2VhcmNoIGZ1bmN0aW9uc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCd2bS5zZWFyY2gnLCBmdW5jdGlvbiAodGVybSkge1xuICAgICAgICAgICAgICAgIGlmICh2bS5vYmplY3RpdmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLmZpbHRlcmVkID0gU2VhcmNoU2libGluZ3NJbmNsdWRlZEZpbHRlcih2bS5vYmplY3RpdmVzLCB0ZXJtKTtcbiAgICAgICAgICAgICAgICAgICAgdm0udG90YWxJdGVtcyA9IHZtLmZpbHRlcmVkLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEl0ZW1zKCkge1xuICAgICAgICAgICAgcmV0dXJuIEN1cnJpY3VsdW0ub2JqZWN0aXZlcygnd2lza3VuZGUnKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0udG90YWxJdGVtcyA9IGRhdGEubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHJldHVybiB2bS5vYmplY3RpdmVzID0gdm0uZmlsdGVyZWQgPSBkYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBsb2FkRHJhZnQoKSB7XG4gICAgICAgICAgICB2bS53ZWJzaXRlID0gV2Vic2l0ZURyYWZ0LmxvYWQoKTtcbiAgICAgICAgICAgIGlmICh2bS53ZWJzaXRlICYmIHZtLndlYnNpdGUub2JqZWN0aXZlcykge1xuICAgICAgICAgICAgICAgIHJldHVybiB2bS5zZWxlY3RlZEl0ZW1zID0gdm0ud2Vic2l0ZS5vYmplY3RpdmVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29tcGFyZU9iamVjdGl2ZShvMSwgbzIpIHtcbiAgICAgICAgICAgIHJldHVybiBvMS5pZCA9PT0gbzIuaWQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzYXZlKCkge1xuICAgICAgICAgICAgdm0ud2Vic2l0ZS5vYmplY3RpdmVzID0gdm0uc2VsZWN0ZWRJdGVtcztcbiAgICAgICAgICAgIFdlYnNpdGVEcmFmdC5kcmFmdCh2bS53ZWJzaXRlKTtcbiAgICAgICAgICAgIGdvdG9XZWJzaXRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjYW5jZWwoKSB7XG4gICAgICAgICAgICBnb3RvV2Vic2l0ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ290b1dlYnNpdGUoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2xpYnJhcnkud2Vic2l0ZXMuZGV0YWlsJywge2lkOiB2bS53ZWJzaXRlLmlkfSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmRhdGFcbiAqIEZJTFRFUjogU2VhcmNoU2libGluZ3NJbmNsdWRlZFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmN1cnJpY3VsYScpXG4gICAgICAgIC5maWx0ZXIoJ1NlYXJjaFNpYmxpbmdzSW5jbHVkZWQnLCBTZWFyY2hTaWJsaW5nc0luY2x1ZGVkKTtcblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgZnVuY3Rpb24gU2VhcmNoU2libGluZ3NJbmNsdWRlZCgpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChpbnB1dCwgc2VhcmNoVGV4dCkge1xuXG4gICAgICAgICAgICBpZiAoc2VhcmNoVGV4dCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICBmXG5cbiAgICAgICAgICAgIHZhciBmaWx0ZXJlZCA9IFtdLFxuICAgICAgICAgICAgICAgIGZpbHRlcmVkSWRzID0gW107XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goaW5wdXQsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxvd2VyX2NvZGUgPSBhbmd1bGFyLmxvd2VyY2FzZShpdGVtLmNvZGUpO1xuICAgICAgICAgICAgICAgIHZhciBsb3dlcl9uYW1lID0gYW5ndWxhci5sb3dlcmNhc2UoaXRlbS5uYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgbG93ZXJfc2VhcmNoVGV4dCA9IGFuZ3VsYXIubG93ZXJjYXNlKHNlYXJjaFRleHQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGxvd2VyX25hbWUuaW5kZXhPZihsb3dlcl9zZWFyY2hUZXh0KSA+IC0xIHx8XG4gICAgICAgICAgICAgICAgICAgIGxvd2VyX2NvZGUuaW5kZXhPZihsb3dlcl9zZWFyY2hUZXh0KSA+IC0xKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ucGFyZW50X2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goaW5wdXQsIGZ1bmN0aW9uIChwaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXRlbS5pZCA9PT0gaXRlbS5wYXJlbnRfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRlcmVkSWRzLmluZGV4T2YocGl0ZW0uaWQpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWQucHVzaChwaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZElkcy5wdXNoKHBpdGVtLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJlZElkcy5pbmRleE9mKGl0ZW0uaWQpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWQucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkSWRzLnB1c2goaXRlbS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpdGVtLnBhcmVudF9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGlucHV0LCBmdW5jdGlvbiAoY2hpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaXRlbS5wYXJlbnRfaWQgPT09IGl0ZW0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRlcmVkSWRzLmluZGV4T2YoY2hpdGVtLmlkKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkLnB1c2goY2hpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkSWRzLnB1c2goY2hpdGVtLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJlZDtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5saWJyYXJ5XG4gKiBDT05UUk9MTEVSOiBCb29rc0NvbnRyb2xsZXJcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5saWJyYXJ5JylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0Jvb2tzQ29udHJvbGxlcicsIEJvb2tzQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBCb29rc0NvbnRyb2xsZXIoY29tbW9uLCBjb25maWcpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0ucmVmcmVzaCA9IHJlZnJlc2g7XG5cbiAgICAgICAgdmFyIGV2ZW50cyA9IGNvbmZpZy5ldmVudHM7XG5cbiAgICAgICAgYWN0aXZhdGUoKTtcbiAgICAgICAgLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgICBjb21tb24uJGJyb2FkY2FzdChldmVudHMuY29udHJvbGxlckFjdGl2YXRlU3VjY2Vzcyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRCb29rcyhmb3JjZVJlZnJlc2gpIHtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVmcmVzaCgpIHtcbiAgICAgICAgICAgIGdldEJvb2tzKHRydWUpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy53ZWJzaXRlc1xuICogRklMVEVSOiBTZWFyY2hXZWJzaXRlc1xuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxpYnJhcnknKVxuICAgICAgICAuZmlsdGVyKCdTZWFyY2hXZWJzaXRlcycsIFNlYXJjaFdlYnNpdGVzKTtcblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgZnVuY3Rpb24gU2VhcmNoV2Vic2l0ZXMoXykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24od2Vic2l0ZXMsIHRlcm1zKSB7XG4gICAgICAgICAgICB0ZXJtcyA9IHRlcm1zLnNwbGl0KCcgJyk7XG4gICAgICAgICAgICByZXR1cm4gXy5zZWxlY3Qod2Vic2l0ZXMsIGZ1bmN0aW9uKHdlYnNpdGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKHRlcm1zLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfLmNvbnRhaW5zKHdlYnNpdGUubmFtZS50b0xvd2VyQ2FzZSgpLCB0LnRvTG93ZXJDYXNlKCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBfLmNvbnRhaW5zKHdlYnNpdGUudXJsLnRvTG93ZXJDYXNlKCksIHQudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvcy1wbHVzLmxpYnJhcnlcbiAqIEZBQ1RPUlk6IFdlYnNpdGVEcmFmdFxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubGlicmFyeScpXG4gICAgICAgIC5mYWN0b3J5KCdXZWJzaXRlRHJhZnQnLCBXZWJzaXRlRHJhZnQpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gV2Vic2l0ZURyYWZ0KCkge1xuICAgICAgICB2YXIgd2Vic2l0ZSA9IG51bGw7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBkcmFmdDogZHJhZnQsXG4gICAgICAgICAgICBsb2FkOiBsb2FkLFxuICAgICAgICAgICAgY2xlYXI6IGNsZWFyLFxuICAgICAgICAgICAgcHVsbDogcHVsbFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gZHJhZnQod2Vic2l0ZSkge1xuICAgICAgICAgICAgdGhpcy53ZWJzaXRlID0gd2Vic2l0ZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBsb2FkKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMud2Vic2l0ZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICAgICAgICAgIHRoaXMud2Vic2l0ZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcHVsbCgpIHtcbiAgICAgICAgICAgIHZhciB3ID0gdGhpcy5sb2FkKCk7XG4gICAgICAgICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICAgICAgICByZXR1cm4gdztcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMubGlicmFyeVxuICogRkFDVE9SWTogV2Vic2l0ZVxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubGlicmFyeScpXG4gICAgICAgIC5mYWN0b3J5KCdXZWJzaXRlJywgV2Vic2l0ZSk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBXZWJzaXRlKEhUVFBDYWNoZSkge1xuICAgICAgICB2YXIgc2VydmljZSA9IEhUVFBDYWNoZS5zZXJ2aWNlKCcvd2Vic2l0ZXMnKTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmxpYnJhcnlcbiAqIENPTlRST0xMRVI6IFdlYnNpdGVEZXRhaWxDb250cm9sbGVyXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubGlicmFyeScpXG4gICAgICAgIC5jb250cm9sbGVyKCdXZWJzaXRlRGV0YWlsQ29udHJvbGxlcicsIFdlYnNpdGVEZXRhaWxDb250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFdlYnNpdGVEZXRhaWxDb250cm9sbGVyKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1vbiwgY29uZmlnLCBUYWcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV2Vic2l0ZSwgRGlhbG9nLCBXZWJzaXRlRHJhZnQsIF8pIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZhciBsb2dnZXIgPSBjb21tb24ubG9nZ2VyO1xuICAgICAgICB2YXIgJHEgPSBjb21tb24uJHE7XG4gICAgICAgIHZhciBldmVudHMgPSBjb25maWcuZXZlbnRzO1xuXG4gICAgICAgIHZtLmNhbmNlbCA9IGNhbmNlbDtcbiAgICAgICAgdm0uaGFzQ2hhbmdlcyA9IGZhbHNlO1xuICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHZtLmlzU2F2aW5nID0gZmFsc2U7XG4gICAgICAgIHZtLnNhdmUgPSBzYXZlO1xuICAgICAgICB2bS5yZW1vdmUgPSByZW1vdmU7XG4gICAgICAgIHZtLmdvdG9PYmplY3RpdmVzID0gZ290b09iamVjdGl2ZXM7XG4gICAgICAgIHZtLndlYnNpdGUgPSBudWxsO1xuICAgICAgICB2bS5vYmplY3RpdmVzX2NoYW5nZWQgPSBmYWxzZTtcblxuICAgICAgICB2bS50YWdzID0gW107XG4gICAgICAgIHZtLmxvYWRUYWdzID0gbG9hZFRhZ3M7XG5cblxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodm0sICdjYW5TYXZlJywge2dldDogY2FuU2F2ZX0pO1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG4gICAgICAgIC8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuXG4gICAgICAgICAgICBwcmVsb2FkVGFncygpO1xuICAgICAgICAgICAgZ2V0UmVxdWVzdGVkV2Vic2l0ZSgpO1xuXG4gICAgICAgICAgICBjb21tb24uJGJyb2FkY2FzdChldmVudHMuY29udHJvbGxlckFjdGl2YXRlU3VjY2Vzcyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwcmVsb2FkVGFncygpIHtcbiAgICAgICAgICAgIHJldHVybiBUYWcuZ2V0TGlzdCgpLnRoZW4odGFnc0NvbXBsZXRlZCk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHRhZ3NDb21wbGV0ZWQocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0udGFncyA9IHJlc3BvbnNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbG9hZFRhZ3MocXVlcnkpIHtcbiAgICAgICAgICAgIHJldHVybiBfLnNlbGVjdCh2bS50YWdzLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICByZXR1cm4gXy5jb250YWlucyh0Lm5hbWUudG9Mb3dlckNhc2UoKSwgcXVlcnkudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbCgpIHtcbiAgICAgICAgICAgIGdvdG9XZWJzaXRlcygpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FuU2F2ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiAhdm0uaXNTYXZpbmc7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRSZXF1ZXN0ZWRXZWJzaXRlKCkge1xuICAgICAgICAgICAgdm0ubG9hZGluZyA9IHRydWU7XG5cbiAgICAgICAgICAgIGlmIChXZWJzaXRlRHJhZnQubG9hZCgpKSB7XG4gICAgICAgICAgICAgICAgdm0ud2Vic2l0ZSA9IFdlYnNpdGVEcmFmdC5wdWxsKCk7XG4gICAgICAgICAgICAgICAgdm0ub2JqZWN0aXZlc19jaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLndlYnNpdGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB2YWwgPSAkc3RhdGVQYXJhbXMuaWQ7XG4gICAgICAgICAgICBpZiAodmFsID09PSAnbmV3Jykge1xuICAgICAgICAgICAgICAgIHZtLndlYnNpdGUgPSBXZWJzaXRlLm9uZSgpO1xuICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB2bS53ZWJzaXRlO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIFdlYnNpdGUub25lKHZhbCkuZ2V0KClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdm0ud2Vic2l0ZSA9IGRhdGE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2bS53ZWJzaXRlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ0NvdWxkIG5vdCBmaW5kIHdlYnNpdGUgaWQgPSAnICsgdmFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG9XZWJzaXRlcygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciB3aGlsZSBnZXR0aW5nIHdlYnNpdGUgaWQ9ICcgKyB2YWwgKyAnOyAnICsgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICBnb3RvV2Vic2l0ZXMoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ290b1dlYnNpdGVzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdsaWJyYXJ5LndlYnNpdGVzJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzYXZlKCkge1xuICAgICAgICAgICAgaWYgKCFjYW5TYXZlKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEud2hlbihudWxsKTtcbiAgICAgICAgICAgIH0gLy8gTXVzdCByZXR1cm4gYSBwcm9taXNlXG5cbiAgICAgICAgICAgIHZtLmlzU2F2aW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgcmV0dXJuIHZtLndlYnNpdGUuc2F2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZtLmlzU2F2aW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBnb3RvV2Vic2l0ZXMoKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHZtLmlzU2F2aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdLb24gd2Vic2l0ZSBuaWV0IG9wc2xhYW4uIFsnICsgZXJyb3IgKyAnXScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICAgICAgICByZXR1cm4gRGlhbG9nLmRlbGV0ZURpYWxvZyh2bS53ZWJzaXRlLm5hbWUgKyAnIFsnICsgdm0ud2Vic2l0ZS51cmwgKyAnXScpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVtb3ZlV2Vic2l0ZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlbW92ZVdlYnNpdGUoKSB7XG4gICAgICAgICAgICAgICAgdm0ud2Vic2l0ZS5yZW1vdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdm0ud2Vic2l0ZS5jbGVhckNhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKHZtLndlYnNpdGUubmFtZSArICcgd2VyZCBtZXQgc3VjY2VzIHZlcndpamRlcmQuJyk7XG4gICAgICAgICAgICAgICAgICAgIGdvdG9XZWJzaXRlcygpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBEaWFsb2cuY29uZmlybWF0aW9uRGlhbG9nKCdWZXJ3aWpkZXJlbiBtaXNsdWt0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdIZXQgdmVyd2lqZGVyZW4gdmFuICcgKyB2bS53ZWJzaXRlLm5hbWUgKyAnIGlzIG1pc2x1a3QuIFByb2JlZXIgaGV0IGxhdGVyIG9wbmlldXcuJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnb3RvT2JqZWN0aXZlcygpIHtcbiAgICAgICAgICAgIFdlYnNpdGVEcmFmdC5kcmFmdCh2bS53ZWJzaXRlKTtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnbGlicmFyeS53ZWJzaXRlcy5kZXRhaWwub2JqZWN0aXZlcycpO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmxpYnJhcnlcbiAqIENPTlRST0xMRVI6IFdlYnNpdGVzQ29udHJvbGxlclxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxpYnJhcnknKVxuICAgICAgICAuY29udHJvbGxlcignV2Vic2l0ZXNDb250cm9sbGVyJywgV2Vic2l0ZXNDb250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFdlYnNpdGVzQ29udHJvbGxlcihjb21tb24sIGNvbmZpZywgJHN0YXRlLCBXZWJzaXRlLCAkc2NvcGUsIFNlYXJjaFdlYnNpdGVzRmlsdGVyKSB7XG4gICAgICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLndlYnNpdGVzID0gW107XG4gICAgICAgIHZtLmZpbHRlcmVkV2Vic2l0ZXMgPSBbXTtcbiAgICAgICAgdm0uZ290b1dlYnNpdGUgPSBnb3RvV2Vic2l0ZTtcbiAgICAgICAgdm0ucmVmcmVzaCA9IHJlZnJlc2g7XG5cbiAgICAgICAgdm0uZmlsdGVyID0ge1xuICAgICAgICAgICAgdGVybXM6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZXZlbnRzID0gY29uZmlnLmV2ZW50cztcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ3ZtLmZpbHRlcicsIGRvRmlsdGVyLCB0cnVlKTtcblxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgICAgIGNvbW1vbi4kYnJvYWRjYXN0KGV2ZW50cy5jb250cm9sbGVyQWN0aXZhdGVTdWNjZXNzKTtcbiAgICAgICAgICAgIGdldFdlYnNpdGVzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRXZWJzaXRlcyhmb3JjZVJlZnJlc2gpIHtcbiAgICAgICAgICAgIHZtLmxvYWRpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBpZiAoZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZtLndlYnNpdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLndlYnNpdGVzLmNsZWFyQ2FjaGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBXZWJzaXRlLmdldExpc3QoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0ud2Vic2l0ZXMgPSB2bS5maWx0ZXJlZFdlYnNpdGVzID0gZGF0YTtcbiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLndlYnNpdGVzO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnb3RvV2Vic2l0ZSh3ZWJzaXRlKSB7XG4gICAgICAgICAgICBpZiAod2Vic2l0ZSAmJiB3ZWJzaXRlLmlkKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdsaWJyYXJ5LndlYnNpdGVzLmRldGFpbCcsIHtpZDogd2Vic2l0ZS5pZH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVmcmVzaCgpIHtcbiAgICAgICAgICAgIGdldFdlYnNpdGVzKHRydWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZG9GaWx0ZXIoKSB7XG4gICAgICAgICAgICBpZiAodm0uZmlsdGVyLnRlcm1zICYmIHZtLmZpbHRlci50ZXJtcyAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICB2bS5maWx0ZXJlZFdlYnNpdGVzID0gU2VhcmNoV2Vic2l0ZXNGaWx0ZXIodm0ud2Vic2l0ZXMsIHZtLmZpbHRlci50ZXJtcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZtLmZpbHRlcmVkV2Vic2l0ZXMgPSB2bS53ZWJzaXRlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4vKlxuIGlmIChfLnNvbWUodGVybXMsIGZ1bmN0aW9uICh0KSB7XG4gcmV0dXJuIG5hbWVDb250YWluc1Rlcm0od2Vic2l0ZS5uYW1lLCB0KSB8fFxuIGRlc2NyaXB0aW9uQ29udGFpbnNUZXJtKHdlYnNpdGUuZGVzY3JpcHRpb24sIHQpIHx8XG4gb2JqZWN0aXZlc0NvbnRhaW5zVGVybSh3ZWJzaXRlLm9iamVjdGl2ZXMsIHQpO1xuIH0pKSB7XG4gYWRkVW5pcXVlKHdlYnNpdGUsIGZpbHRlcmVkKTtcbiB9XG5cbiAqLyIsIi8qKlxuICogbm90b3NwbHVzLm1hbmFnZVxuICogRkFDVE9SWTogVXNlclxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubWFuYWdlJylcbiAgICAgICAgLmZhY3RvcnkoJ1VzZXInLCBVc2VyKTtcblxuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gVXNlcihIVFRQQ2FjaGUsIFByb2ZpbGVTZXJ2aWNlKSB7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSBIVFRQQ2FjaGUuc2VydmljZSgnL29yZ2FuaXphdGlvbi8nICsgUHJvZmlsZVNlcnZpY2UucmVhbG0oKS5pZCArICcvdXNlcicpO1xuXG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5tYW5hZ2VcbiAqIENPTlRST0xMRVI6IFVzZXJBZGRDb250cm9sbGVyXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubWFuYWdlJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1VzZXJEZXRhaWxDb250cm9sbGVyJywgVXNlckRldGFpbENvbnRyb2xsZXIpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gVXNlckRldGFpbENvbnRyb2xsZXIoJHN0YXRlLCAkc3RhdGVQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbW9uLCBjb25maWcsIFVzZXIsIERpYWxvZywgUHJvZmlsZVNlcnZpY2UpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZhciBsb2dnZXIgPSBjb21tb24ubG9nZ2VyO1xuICAgICAgICB2YXIgJHEgPSBjb21tb24uJHE7XG4gICAgICAgIHZhciBldmVudHMgPSBjb25maWcuZXZlbnRzO1xuXG5cbiAgICAgICAgdm0uY2FuY2VsID0gY2FuY2VsO1xuICAgICAgICB2bS5oYXNDaGFuZ2VzID0gZmFsc2U7XG4gICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgdm0uaXNTYXZpbmcgPSBmYWxzZTtcbiAgICAgICAgdm0uaXNSZXNldFB3ZCA9IGZhbHNlO1xuICAgICAgICB2bS5yZXNldFB3ZCA9IHJlc2V0UGFzc3dvcmQ7XG4gICAgICAgIHZtLnNhdmUgPSBzYXZlO1xuICAgICAgICB2bS5yZW1vdmUgPSByZW1vdmU7XG4gICAgICAgIHZtLnVzZXIgPSBudWxsO1xuICAgICAgICB2bS51c2VycyA9IFtdO1xuICAgICAgICB2bS5kZWZhdWx0VXNlcm5hbWUgPSBkZWZhdWx0VXNlcm5hbWU7XG4gICAgICAgIHZtLmRlZmF1bHREb21haW4gPSBQcm9maWxlU2VydmljZS5jdXJyZW50KCkuZG9tYWluX25hbWU7XG5cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHZtLCAnY2FuU2F2ZScsIHtnZXQ6IGNhblNhdmV9KTtcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICAgICAgLy9vbkRlc3Ryb3koKTtcbiAgICAgICAgICAgIC8vb25IYXNDaGFuZ2VzKCk7XG5cbiAgICAgICAgICAgIGdldFJlcXVlc3RlZFVzZXIoKTtcblxuICAgICAgICAgICAgY29tbW9uLiRicm9hZGNhc3QoZXZlbnRzLmNvbnRyb2xsZXJBY3RpdmF0ZVN1Y2Nlc3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsKCkge1xuICAgICAgICAgICAgZ29Ub1VzZXJzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjYW5TYXZlKCkge1xuICAgICAgICAgICAgcmV0dXJuICF2bS5pc1NhdmluZztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFJlcXVlc3RlZFVzZXIoKSB7XG4gICAgICAgICAgICB2bS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciB2YWwgPSAkc3RhdGVQYXJhbXMuaWQ7XG4gICAgICAgICAgICBpZiAodmFsID09PSAnbmV3Jykge1xuICAgICAgICAgICAgICAgIHZtLnVzZXIgPSBVc2VyLm9uZSgpO1xuICAgICAgICAgICAgICAgIHZtLmlzUmVzZXRQd2QgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB2bS51c2VyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBVc2VyLm9uZSh2YWwpLmdldCgpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLnVzZXIgPSBkYXRhO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm0udXNlcjtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoJ0NvdWxkIG5vdCBmaW5kIHVzZXIgaWQgPSAnICsgdmFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdvVG9Vc2VycygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciB3aGlsZSBnZXR0aW5nIHVzZXIgaWQgPSAnICsgdmFsICsgJzsgJyArIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgZ29Ub1VzZXJzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnb1RvVXNlcnMoKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ21hbmFnZS51c2VycycpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZSgpIHtcblxuICAgICAgICAgICAgaWYgKCFjYW5TYXZlKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEud2hlbihudWxsKTtcbiAgICAgICAgICAgIH0gLy8gTXVzdCByZXR1cm4gYSBwcm9taXNlXG5cbiAgICAgICAgICAgIHZtLmlzU2F2aW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgcmV0dXJuIHZtLnVzZXIuc2F2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZtLmlzU2F2aW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBnb1RvVXNlcnMoKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHZtLmlzU2F2aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdLb24gZ2VicnVpa2VyIG5pZXQgb3BzbGFhbi4gWycgKyBlcnJvciArICddJyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRQYXNzd29yZCgpIHtcbiAgICAgICAgICAgIHJldHVybiBEaWFsb2cucmVzZXRQYXNzd29yZERpYWxvZygpXG4gICAgICAgICAgICAgICAgLnRoZW4ocGF0Y2hSZXNldHRlZFBhc3N3b3JkKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gcGF0Y2hSZXNldHRlZFBhc3N3b3JkKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS51c2VyLm9uZSgncGFzc3dvcmQnKS5wYXRjaChkYXRhKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihwYXNzd29yZFdhc1Jlc2V0dGVkKTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHBhc3N3b3JkV2FzUmVzZXR0ZWQodXNlcikge1xuICAgICAgICAgICAgICAgICAgICBjb21tb24ubG9nZ2VyLmluZm8oJ1Bhc3dvb3JkIG9wbmlldXcgaW5nZXN0ZWxkIHZvb3IgJyArIHVzZXIuZnVsbF9uYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICAgICAgICByZXR1cm4gRGlhbG9nLmRlbGV0ZURpYWxvZyh2bS51c2VyLmZ1bGxfbmFtZSlcbiAgICAgICAgICAgICAgICAudGhlbihyZW1vdmVVc2VyKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVtb3ZlVXNlcigpIHtcbiAgICAgICAgICAgICAgICB2bS51c2VyLnJlbW92ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2bS51c2VyLmNsZWFyQ2FjaGUoKTtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcodm0udXNlci5mdWxsX25hbWUgKyAnIHdlcmQgbWV0IHN1Y2NlcyB2ZXJ3aWpkZXJkLicpO1xuICAgICAgICAgICAgICAgICAgICBnb1RvVXNlcnMoKTtcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgRGlhbG9nLmNvbmZpcm1hdGlvbkRpYWxvZygnVmVyd2lqZGVyZW4gbWlzbHVrdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnSGV0IHZlcndpamRlcmVuIHZhbiAnICsgdm0udXNlci5mdWxsX25hbWUgKyAnIGlzIG1pc2x1a3QuIFByb2JlZXIgaGV0IGxhdGVyIG9wbmlldXcuJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkZWZhdWx0VXNlcm5hbWUoKSB7XG4gICAgICAgICAgICBpZih2bS51c2VyLnVzZXJuYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLnVzZXIudXNlcm5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdm0udXNlci5maXJzdFxuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5tYW5hZ2VcbiAqIENPTlRST0xMRVI6IFVzZXJzQ29udHJvbGxlclxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLm1hbmFnZScpXG4gICAgICAgIC5jb250cm9sbGVyKCdVc2Vyc0NvbnRyb2xsZXInLCBVc2Vyc0NvbnRyb2xsZXIpO1xuXG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBVc2Vyc0NvbnRyb2xsZXIoJHN0YXRlLCBjb25maWcsIGNvbW1vbiwgVXNlcikge1xuICAgICAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2YXIga2V5Q29kZXMgPSBjb25maWcua2V5Q29kZXM7XG4gICAgICAgIHZhciBldmVudHMgPSBjb25maWcuZXZlbnRzO1xuXG4gICAgICAgIHZtLmZpbHRlcmVkVXNlcnMgPSBbXTtcbiAgICAgICAgdm0uZ290b1VzZXIgPSBnb3RvVXNlcjtcbiAgICAgICAgdm0ucmVmcmVzaCA9IHJlZnJlc2g7XG4gICAgICAgIHZtLnNlYXJjaCA9IHNlYXJjaDtcbiAgICAgICAgdm0udXNlclNlYXJjaCA9ICcnO1xuICAgICAgICB2bS51c2VycyA9IFtdO1xuXG5cbiAgICAgICAgYWN0aXZhdGUoKTtcblxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgICAgIGNvbW1vbi4kYnJvYWRjYXN0KGV2ZW50cy5jb250cm9sbGVyQWN0aXZhdGVTdWNjZXNzKTtcbiAgICAgICAgICAgIGdldFVzZXJzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBhcHBseUZpbHRlcigpIHtcbiAgICAgICAgICAgIHZtLmZpbHRlcmVkVXNlcnMgPSB2bS51c2Vycy5maWx0ZXIodXNlckZpbHRlcik7XG4gICAgICAgIH1cblxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFVzZXJzKGZvcmNlUmVmcmVzaCkge1xuICAgICAgICAgICAgdm0ubG9hZGluZyA9IHRydWU7XG5cbiAgICAgICAgICAgIGlmIChmb3JjZVJlZnJlc2gpIHtcbiAgICAgICAgICAgICAgICBpZiAodm0udXNlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdm0udXNlcnMuY2xlYXJDYWNoZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFVzZXIuZ2V0TGlzdCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS51c2VycyA9IHZtLmZpbHRlcmVkVXNlcnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB2bS51c2VycztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cblxuICAgICAgICBmdW5jdGlvbiBnb3RvVXNlcih1c2VyKSB7XG4gICAgICAgICAgICBpZiAodXNlciAmJiB1c2VyLmlkKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdtYW5hZ2UudXNlcnMuZGV0YWlsJywge2lkOiB1c2VyLmlkfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZWZyZXNoKCkge1xuICAgICAgICAgICAgdm0udXNlclNlYXJjaCA9ICcnO1xuICAgICAgICAgICAgZ2V0VXNlcnModHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZWFyY2goJGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAoJGV2ZW50LmtleUNvZGUgPT09IGtleUNvZGVzLmVzYykge1xuICAgICAgICAgICAgICAgIHZtLnVzZXJTZWFyY2ggPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFwcGx5RmlsdGVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1c2VyRmlsdGVyKHVzZXIpIHtcbiAgICAgICAgICAgIHZhciBpc01hdGNoID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICh2bS51c2VyU2VhcmNoKSB7XG4gICAgICAgICAgICAgICAgaXNNYXRjaCA9IGNvbW1vbi50ZXh0Q29udGFpbnModXNlci5uYW1lLCB2bS51c2VyU2VhcmNoKTtcbiAgICAgICAgICAgICAgICBpc01hdGNoIHw9IGNvbW1vbi50ZXh0Q29udGFpbnModXNlci51c2VybmFtZSwgdm0udXNlclNlYXJjaCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBpc01hdGNoO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy53aWRnZXRzXG4gKiBESVJFQ1RJVkU6IG50RmFcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy53aWRnZXRzJylcbiAgICAgICAgLmRpcmVjdGl2ZSgnbnRGYScsIG50RmEpO1xuXG4gICAgbnRGYS4kaW5qZWN0ID0gW107XG5cbiAgICBmdW5jdGlvbiBudEZhKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIGxpbms6IGxpbmtGdW5jXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgdmFyIGkgPSBhbmd1bGFyLmVsZW1lbnQoJzxpIGNsYXNzPVwiZmFcIiAvPicpO1xuICAgICAgICAgICAgdmFyIGNsYXNzZXMgPSBhdHRycy5uYW1lLnNwbGl0KCcgJyk7XG5cbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjbGFzc2VzLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpLmFkZENsYXNzKCdmYS0nICsgdmFsdWUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGVsZW1lbnQucmVwbGFjZVdpdGgoaSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG4iLCIvKipcbiAqIG5vdG9zcGx1cy53aWRnZXRzXG4gKiBESVJFQ1RJVkU6IG50U3Bpbm5lclxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLndpZGdldHMnKVxuICAgICAgICAuZGlyZWN0aXZlKCdudFNwaW5uZXInLCBudFNwaW5uZXIpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gbnRTcGlubmVyKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICBjb21waWxlOiBjb21waWxlXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICBmdW5jdGlvbiBjb21waWxlKGVsZW0sIGF0dHJzKSB7XG4gICAgICAgICAgICBpZiAoZWxlbVswXS50YWdOYW1lID09PSAnVEFCTEUnKSB7XG4gICAgICAgICAgICAgICAgYWRkU3Bpbm5lclRvVEJvZHkoZWxlbSwgYXR0cnMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhZGRTcGlubmVyVG9FbGVtZW50KGVsZW0sIGF0dHJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFkZFNwaW5uZXJUb1RCb2R5KGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICB2YXIgdGJvZHkgPSBlbGVtZW50LmZpbmQoJ3Rib2R5Jyk7XG4gICAgICAgICAgICB2YXIgaHRtbCA9IFsnPHRyIG5nLXNob3c9XCInICsgYXR0cnMuc3Bpbm5lclNob3cgKyAnXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHRkICcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhdHRycy5oYXNPd25Qcm9wZXJ0eSgnY29sc3BhbicpID8gJ2NvbHNwYW49XCInICsgYXR0cnMuY29sc3BhbiArICdcIiAnIDogJycpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9XCJ0ZXh0LWFsaWduOmNlbnRlclwiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW1nIHNyYz1cIi9pbWcvYnVzeS9idXN5YXRvbS5naWZcIiBzdHlsZT1cIndpZHRoOjQwcHg7aGVpZ2h0OjQwcHg7XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC90ZD4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzwvdHI+J10uam9pbignJyk7XG5cbiAgICAgICAgICAgIHRib2R5LnByZXBlbmQoaHRtbCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYWRkU3Bpbm5lclRvRWxlbWVudChlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgdmFyIGh0bWwgPSBbJzxkaXYgbmctc2hvdz1cIicgKyBhdHRycy5zcGlubmVyU2hvdyArICdcIiBjbGFzcz1cImNvbC1tZC0xMiB0ZXh0LWNlbnRlclwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8aW1nIHNyYz1cIi9pbWcvYnVzeS9idXN5YXRvbS5naWZcIiBzdHlsZT1cIndpZHRoOjQwcHg7aGVpZ2h0OjQwcHg7XCI+JyxcbiAgICAgICAgICAgICAgICAnPC9kaXY+JyxcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNsZWFyZml4XCI+PC9kaXY+J10uam9pbignJyk7XG5cbiAgICAgICAgICAgIGVsZW1lbnQucHJlcGVuZChodG1sKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbiIsIi8qKlxuICogbm90b3NwbHVzLndpZGdldHNcbiAqIEZBQ1RPUlk6IHNwaW5uZXJTZXJ2aWNlXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy53aWRnZXRzJylcbiAgICAgICAgLmZhY3RvcnkoJ3NwaW5uZXJTZXJ2aWNlJywgc3Bpbm5lclNlcnZpY2UpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gc3Bpbm5lclNlcnZpY2UoKSB7XG4gICAgICAgIHZhciBzcGlubmVycyA9IHt9O1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIF9yZWdpc3RlcjogcmVnaXN0ZXIsXG4gICAgICAgICAgICBfdW5yZWdpc3RlcjogdW5yZWdpc3RlcixcbiAgICAgICAgICAgIF91bnJlZ2lzdGVyQWxsOiB1bnJlZ2lzdGVyQWxsLFxuICAgICAgICAgICAgc2hvdzogc2hvdyxcbiAgICAgICAgICAgIGhpZGU6IGhpZGUsXG4gICAgICAgICAgICBzaG93R3JvdXA6IHNob3dHcm91cCxcbiAgICAgICAgICAgIGhpZGVHcm91cDogaGlkZUdyb3VwLFxuICAgICAgICAgICAgc2hvd0FsbDogc2hvd0FsbCxcbiAgICAgICAgICAgIGhpZGVBbGw6IGhpZGVBbGxcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vL1xuICAgICAgICBmdW5jdGlvbiByZWdpc3RlcihkYXRhKSB7XG4gICAgICAgICAgICBpZighZGF0YS5oYXNPd25Qcm9wZXJ0eSgnbmFtZScpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTcGlubmVyIG11c3Qgc3BlY2lmeSBhIG5hbWUgd2hlbiByZWdpc3RlcmluZyB3aXRoIHRoZSBzcGlubmVyIHNlcnZpY2UuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihzcGlubmVycy5oYXNPd25Qcm9wZXJ0eShkYXRhLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBIHNwaW5uZXIgd2l0aCB0aGUgbmFtZSBcIicgKyBkYXRhLm5hbWUgKyAnXCIgaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3Bpbm5lcnNbZGF0YS5uYW1lXSA9IGRhdGE7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1bnJlZ2lzdGVyKG5hbWUpIHtcbiAgICAgICAgICAgIGlmKHNwaW5uZXJzLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNwaW5uZXJzW25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdW5yZWdpc3RlckFsbCgpIHtcbiAgICAgICAgICAgIGZvcih2YXIgbmFtZSBpbiBzcGlubmVycykge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBzcGlubmVyc1tuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNob3cobmFtZSkge1xuICAgICAgICAgICAgdmFyIHNwaW5uZXIgID0gc3Bpbm5lcnNbbmFtZV07XG4gICAgICAgICAgICBpZighc3Bpbm5lcikge1xuICAgICAgICAgICAgICAgIHRocm93ICBuZXcgRXJyb3IoJ05vIHNwaW5uZXIgbmFtZWQgXCInICsgbmFtZSArICdcIiBpcyByZWdpc3RlcmVkLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3Bpbm5lci5zaG93KCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBoaWRlKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBzcGlubmVyICA9IHNwaW5uZXJzW25hbWVdO1xuICAgICAgICAgICAgaWYoIXNwaW5uZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAgbmV3IEVycm9yKCdObyBzcGlubmVyIG5hbWVkIFwiJyArIG5hbWUgKyAnXCIgaXMgcmVnaXN0ZXJlZC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2hvd0dyb3VwKGdyb3VwKSB7XG4gICAgICAgICAgICB2YXIgZ3JvdXBFeGlzdHMgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvcih2YXIgbmFtZSBpbiBzcGlubmVycykge1xuICAgICAgICAgICAgICAgIHZhciBzcGlubmVyID0gc3Bpbm5lcnNbbmFtZV07XG4gICAgICAgICAgICAgICAgaWYoc3Bpbm5lci5ncm91cCA9PT0gZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5zaG93KCk7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwRXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighZ3JvdXBFeGlzdHMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHNwaW5uZXJzIGZvdW5kIHdpdGggZ3JvdXAgXCInICsgZ3JvdXAgKyAnXCIuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaGlkZUdyb3VwKGdyb3VwKSB7XG4gICAgICAgICAgICB2YXIgZ3JvdXBFeGlzdHMgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvcih2YXIgbmFtZSBpbiBzcGlubmVycykge1xuICAgICAgICAgICAgICAgIHZhciBzcGlubmVyID0gc3Bpbm5lcnNbbmFtZV07XG4gICAgICAgICAgICAgICAgaWYoc3Bpbm5lci5ncm91cCA9PT0gZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwRXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighZ3JvdXBFeGlzdHMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHNwaW5uZXJzIGZvdW5kIHdpdGggZ3JvdXAgXCInICsgZ3JvdXAgKyAnXCIuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2hvd0FsbCgpIHtcbiAgICAgICAgICAgIGZvcih2YXIgbmFtZSBpbiBzcGlubmVycykge1xuICAgICAgICAgICAgICAgIHNwaW5uZXJzW25hbWVdLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBoaWRlQWxsKCkge1xuICAgICAgICAgICAgZm9yKHZhciBuYW1lIGluIHNwaW5uZXJzKSB7XG4gICAgICAgICAgICAgICAgc3Bpbm5lcnNbbmFtZV0uaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy53aWRnZXRzXG4gKiBESVJFQ1RJVkU6IG50TWluaVNpZGVCYXJcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy53aWRnZXRzJylcbiAgICAgICAgLmRpcmVjdGl2ZSgnbnRNaW5pU2lkZWJhcicsIG50TWluaVNpZGViYXIpO1xuXG4gICAgZnVuY3Rpb24gbnRNaW5pU2lkZWJhcigpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogW1xuICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cIm5hdmJhci1taW5pbWFsaXplIG1pbmltYWxpemUtc3R5bC0yIGJ0biBidG4tcHJpbWFyeVwiIGhyZWY9XCJcIiBuZy1jbGljaz1cInZtLm1pbmltYWxpemUoKVwiPicsXG4gICAgICAgICAgICAgICAgJzxpIGNsYXNzPVwiZmEgZmEtYmFyc1wiPjwvaT4nLFxuICAgICAgICAgICAgICAgICc8L2E+J1xuICAgICAgICAgICAgXS5qb2luKCcnKSxcblxuICAgICAgICAgICAgY29udHJvbGxlcjogTWluaW1pemVDb250cm9sbGVyLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSAvLyBiZWNhdXNlIHRoZSBzY29wZSBpcyBpc29sYXRlZFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICAvKiBAbmdJbmplY3QgKi9cbiAgICAgICAgZnVuY3Rpb24gTWluaW1pemVDb250cm9sbGVyKCR0aW1lb3V0KSB7XG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICAgICAgdm0ubWluaW1hbGl6ZSA9IG1pbmltYWxpemU7XG5cbiAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAgIGZ1bmN0aW9uIG1pbmltYWxpemUoKSB7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCdib2R5JykudG9nZ2xlQ2xhc3MoJ21pbmktbmF2YmFyJyk7XG4gICAgICAgICAgICAgICAgaWYgKCFhbmd1bGFyLmVsZW1lbnQoJ2JvZHknKS5oYXNDbGFzcygnbWluaS1uYXZiYXInKSB8fCBhbmd1bGFyLmVsZW1lbnQoJ2JvZHknKS5oYXNDbGFzcygnYm9keS1zbWFsbCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEhpZGUgbWVudSBpbiBvcmRlciB0byBzbW9vdGhseSB0dXJuIG9uIHdoZW4gbWF4aW1pemUgbWVudVxuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJyNzaWRlLW1lbnUnKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvciBzbW9vdGhseSB0dXJuIG9uIG1lbnVcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCcjc2lkZS1tZW51JykuZmFkZUluKDUwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5ndWxhci5lbGVtZW50KCdib2R5JykuaGFzQ2xhc3MoJ2ZpeGVkLXNpZGViYXInKSkge1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJyNzaWRlLW1lbnUnKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnI3NpZGUtbWVudScpLmZhZGVJbig1MDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgYWxsIGlubGluZSBzdHlsZSBmcm9tIGpxdWVyeSBmYWRlSW4gZnVuY3Rpb24gdG8gcmVzZXQgbWVudSBzdGF0ZVxuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJyNzaWRlLW1lbnUnKS5yZW1vdmVBdHRyKCdzdHlsZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbiIsIi8qKlxuICogbm90b3NwbHVzLndpZGdldHNcbiAqIERJUkVDVElWRTogbnRQYWdpbmF0aW9uXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMud2lkZ2V0cycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ250UGFnaW5hdGlvbicsIG50UGFnaW5hdGlvbik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBudFBhZ2luYXRpb24oJGNvbXBpbGUpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICB0b3RhbEl0ZW1zOiAnPScsXG4gICAgICAgICAgICAgICAgaXRlbXNQZXJQYWdlOiAnPScsXG4gICAgICAgICAgICAgICAgY3VycmVudFBhZ2U6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgICAgICAgICAgY29udHJvbGxlcjogUGFnaW5hdGVDb250cm9sbGVyLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSAvLyBiZWNhdXNlIHRoZSBzY29wZSBpcyBpc29sYXRlZFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHZhciBwYWdpbmF0aW9uID0gYW5ndWxhci5lbGVtZW50KCc8cGFnaW5hdGlvbiAvPicpXG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtYm91bmRhcnktbGlua3MnLCB0cnVlKTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS10b3RhbC1pdGVtcycsICd0b3RhbEl0ZW1zJyk7XG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtaXRlbXMtcGVyLXBhZ2UnLCAnaXRlbXNQZXJQYWdlJyk7XG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtbWF4LXNpemUnLCA1KTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1uZy1tb2RlbCcsICdjdXJyZW50UGFnZScpO1xuICAgICAgICAgICAgcGFnaW5hdGlvbi5hdHRyKCdkYXRhLXByZXZpb3VzLXRleHQnLCAn4oC5Jyk7XG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtbmV4dC10ZXh0JywgJ+KAuicpO1xuICAgICAgICAgICAgcGFnaW5hdGlvbi5hdHRyKCdkYXRhLWZpcnN0LXRleHQnLCAnwqsnKTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1sYXN0LXRleHQnLCAnwrsnKTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1uZy1oaWRlJywgJ2hpZGUnKTtcbiAgICAgICAgICAgIGlmIChhdHRyc1snY2xhc3MnXSkge1xuICAgICAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignY2xhc3MnLCBhdHRyc1snY2xhc3MnXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRjb21waWxlKHBhZ2luYXRpb24pKHNjb3BlKTtcbiAgICAgICAgICAgIGVsZW1lbnQucmVwbGFjZVdpdGgocGFnaW5hdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBAbmdJbmplY3QgKi9cbiAgICAgICAgZnVuY3Rpb24gUGFnaW5hdGVDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICAgICAgdm0uaGlkZSA9IGZhbHNlO1xuICAgICAgICAgICAgdm0uaXRlbXNQZXJQYWdlID0gMTA7XG4gICAgICAgICAgICB2bS5jdXJyZW50UGdlID0gMDtcblxuICAgICAgICAgICAgJHNjb3BlLiR3YXRjaCgndm0udG90YWxJdGVtcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2bS5oaWRlID0gKHZtLnRvdGFsSXRlbXMgPD0gdm0uaXRlbXNQZXJQYWdlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuIiwiLyoqXG4gKiBub3Rvc3BsdXNcbiAqIERJUkVDVElWRTogbnRTaWRlTmF2aWdhdGlvblxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLndpZGdldHMnKVxuICAgICAgICAuZGlyZWN0aXZlKCdudFNpZGVOYXZpZ2F0aW9uJywgbnRTaWRlTmF2aWdhdGlvbik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBudFNpZGVOYXZpZ2F0aW9uKCR0aW1lb3V0KSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgICAgICAgIGxpbms6IGxpbmtGdW5jXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJChlbGVtZW50KS5tZXRpc01lbnUoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgfVxufSkoKTtcblxuIiwiLyoqXG4gKiBub3Rvc3BsdXMud2lkZ2V0c1xuICogRklMVEVSOiBvZmZzZXRcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy53aWRnZXRzJylcbiAgICAgICAgLmZpbHRlcignb2Zmc2V0JywgZmlsdGVyKTtcblxuXG4gICAgZnVuY3Rpb24gZmlsdGVyKCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gb2Zmc2V0KGlucHV0LCBzdGFydCkge1xuICAgICAgICAgICAgaWYgKGlucHV0KSB7XG4gICAgICAgICAgICAgICAgc3RhcnQgPSBwYXJzZUludChzdGFydCwgMTApO1xuICAgICAgICAgICAgICAgIHJldHVybiBpbnB1dC5zbGljZShzdGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH07XG4gICAgfVxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=