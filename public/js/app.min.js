(function() {
    'use strict';

    angular
        .module('notosplus', [
            //shared modules
            'notosplus.core',
            'notosplus.widgets',
            'notosplus.auth',
            'notosplus.data',
            'notosplus.layout',

            //app modules
            'notosplus.dashboard',
            'notosplus.manage',
            'notosplus.library',
            'notosplus.curricula',
            'notosplus.tags'
        ]);
})();

angular
    .module('notosplus.core', [
        //Angular
        'ngAnimate', 'ngSanitize', 'ngResource',

        //3rd party
        'ui.bootstrap',
        'ncy-angular-breadcrumb',
        'breeze.angular',   // tells breeze to use $q instead of Q.js
        'breeze.directives',// breeze validation directive (zValidate),
        'ngzWip',
        'ngplus',
        'restangular',
        'checklist-model',
        'ngTagsInput',

        //cross app modules
        'blocks.exception',
        'blocks.logger',
        'blocks.router'
    ]);
(function () {
    'use strict';

    angular
        .module('notosplus.data', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.auth', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.curricula', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.layout', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.dashboard', [

        ]);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.library', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.manage', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.tags', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.widgets', []);
})();
(function () {
    'use strict';

    angular
        .module('blocks.exception', ['blocks.logger']);
})();
(function () {
    'use strict';

    angular
        .module('blocks.router', [
            'ui.router'
        ]);
})();
(function () {
    'use strict';

    angular
        .module('blocks.logger', []);
})();
/**
 * notosplus.core
 * FACTORY: bootstrap.dialog
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('Dialog', modalDialog);

    /* @ngInject */
    function modalDialog($modal, $templateCache) {
        var service = {
            deleteDialog: deleteDialog,
            confirmationDialog: confirmationDialog,
            resetPasswordDialog: resetPasswordDialog
        };

        registerModelDialog($templateCache);
        registerResetPasswordDialog($templateCache);

        return service;
        ////////////////

        function deleteDialog(itemName) {
            var title = 'Ben je zeker?';
            itemName = itemName || 'item';
            var msg = 'Verwijder ' + itemName + '?';

            return confirmationDialog(title, msg);
        }

        function confirmationDialog(title, msg, okText, cancelText) {
            var modalOptions = {
                templateUrl: 'modalDialog.tpl.html',
                controller: ModalInstance,
                keyboard: true,
                resolve: {
                    options: function () {
                        return {
                            title: title,
                            message: msg,
                            okText: okText,
                            cancelText: cancelText,
                            password: '',
                            confirmPassword: ''
                        };
                    }
                }
            };

            return $modal.open(modalOptions).result;
        }

        function resetPasswordDialog(title, msg, okText, cancelText) {
            var modalOptions = {
                templateUrl: 'resetPasswordDialog.tpl.html',
                controller: ResetPasswordModalInstance,
                keyboard: true,
                resolve: {
                    options: function () {
                        return {
                            title: title,
                            message: msg,
                            okText: okText,
                            cancelText: cancelText,
                            password: '',
                            confirmPassword: ''
                        };
                    }
                }
            };

            return $modal.open(modalOptions).result;
        }


    }
    modalDialog.$inject = ["$modal", "$templateCache"];

    /* @ngInject */
    function ModalInstance($scope, $modalInstance, options) {
        $scope.title = options.title || 'Titel';
        $scope.message = options.message || '';
        $scope.okText = options.okText || 'Ok';
        $scope.cancelText = options.cancelText || 'Annuleren';
        $scope.ok = function () {
            $modalInstance.close('ok');
        };
        $scope.cancel = function () {
            $modalInstance.dismiss('cancel');
        };
    }
    ModalInstance.$inject = ["$scope", "$modalInstance", "options"];

    /* @ngInject */
    function ResetPasswordModalInstance($scope, $modalInstance, options) {
        $scope.title = options.title || 'Paswoord opnieuw instellen';
        $scope.message = options.message || 'Geef het nieuwe paswoord in.';
        $scope.okText = options.okText || 'Wijzig';
        $scope.cancelText = options.cancelText || 'Annuleren';
        $scope.password = '';
        $scope.confirmPassword = '';
        $scope.ok = function () {
            $modalInstance.close({password: $scope.password});
        };
        $scope.cancel = function () {
            $modalInstance.dismiss('cancel');
        };
    }
    ResetPasswordModalInstance.$inject = ["$scope", "$modalInstance", "options"];

    function registerModelDialog($templateCache) {
        $templateCache.put('modalDialog.tpl.html',
            '<div>' +
            '    <div class="modal-header">' +
            '        <button type="button" class="close" data-dismiss="modal" ' +
            '            aria-hidden="true" data-ng-click="cancel()">&times;</button>' +
            '        <h3>{{title}}</h3>' +
            '    </div>' +
            '    <div class="modal-body">' +
            '        <p>{{message}}</p>' +
            '    </div>' +
            '    <div class="modal-footer">' +
            '        <button class="btn btn-primary" data-ng-click="ok()">{{okText}}</button>' +
            '        <button class="btn btn-info" data-ng-click="cancel()">{{cancelText}}</button>' +
            '    </div>' +
            '</div>');
    }

    function registerResetPasswordDialog($templateCache) {
        $templateCache.put('resetPasswordDialog.tpl.html',
            '<div>' +
            '    <div class="modal-header">' +
            '        <button type="button" class="close" data-dismiss="modal" ' +
            '            aria-hidden="true" data-ng-click="cancel()">&times;</button>' +
            '        <h3>{{title}}</h3>' +
            '    </div>' +
            '    <div class="modal-body">' +
            '        <p>{{message}}</p>' +
            '        <div class="form-group">' +
            '           <label class="control-label">Paswoord</label>' +
            '           <input type="password" data-ng-model="password" placeholder="Nieuw paswoord" class="form-control">' +
            '        </div>' +
            '        <div class="form-group">' +
            '           <label class="control-label">Herhaal password</label>' +
            '           <input type="password" data-ng-model="confirmPassword" placeholder="Herhaal paswoord" class="form-control">' +
            '        </div>' +
            '        <div class="form-group">' +
            '           <span class="text-danger" data-ng-show="password !== confirmPassword && password !== \'\'">De paswoorden komen niet overeen.</span>' +
            '        </div>' +
            '    </div>' +
            '    <div class="modal-footer">' +
            '        <button class="btn btn-primary" data-ng-click="ok()" data-ng-disabled="password !== confirmPassword || password === \'\'">{{okText}}</button>' +
            '        <button class="btn btn-info" data-ng-click="cancel()">{{cancelText}}</button>' +
            '    </div>' +
            '</div>');
    }
})();
/**
 * notosplus.core
 * FACTORY: common
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('common', common);

    function common($q, $rootScope, $timeout, logger) {
        var throttles = {};

        var service = {
            // common angular dependencies
            $broadcast: $broadcast,
            $q: $q,
            $timeout: $timeout,
            // generic
            isNumber: isNumber,
            debouncedThrottle: debouncedThrottle,
            logger: logger,
            textContains: textContains
        }

        return service;
        ////////////////////////

        function $broadcast() {
            return $rootScope.$broadcast.apply($rootScope, arguments);
        }


        function debouncedThrottle(key, callback, delay, immediate) {
            // Perform some action (callback) after a delay.
            // Track the callback by key, so if the same callback
            // is issued again, restart the delay.
            var defaultDelay = 1000;
            delay = delay || defaultDelay;
            if (throttles[key]) {
                $timeout.cancel(throttles[key]);
                throttles[key] = undefined;
            }
            if (immediate) {
                callback();
            } else {
                throttles[key] = $timeout(callback, delay);
            }
        }

        function isNumber(val) {
            // negative or positive
            return (/^[-]?\d+$/).test(val);
        }

        function textContains(text, searchText) {
            return text && -1 !== text.toLowerCase().indexOf(searchText.toLowerCase());
        }
    }
    common.$inject = ["$q", "$rootScope", "$timeout", "logger"];
})();
/**
 * notosplus.data
 * FACTORY: breezeConfig
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('breezeConfig', breezeConfig);

    /* @ngInject */
    function breezeConfig(breeze) {
        var service = {
            remoteServiceName: '/api/breeze',
            breeze: breeze
        }

        return service;
        ////////////////
    }
    breezeConfig.$inject = ["breeze"];

})();
(function () {
    'use strict';

    var core = angular.module('notosplus.core');

    core.config(toastrConfig);

    /* @ngInject */
    function toastrConfig(toastr) {
        toastr.options.timeOut = 4000;
        toastr.options.closeButton = true;
        toastr.options.progressBar = true;
        toastr.options.positionClass = 'toast-bottom-right';
    }
    toastrConfig.$inject = ["toastr"];

    var keyCodes = {
        backspace: 8,
        tab: 9,
        enter: 13,
        esc: 27,
        space: 32,
        pageup: 33,
        pagedown: 34,
        end: 35,
        home: 36,
        left: 37,
        up: 38,
        right: 39,
        down: 40,
        insert: 45,
        del: 46
    };

    var events = {
        controllerActivateSuccess: 'controller.activateSuccess',
        entitiesChanged: 'datacontext.entitiesChanged',
        entitiesImported: 'datacontext.entitiesImported',
        hasChangesChanged: 'datacontext.hasChangesChanged',
        storage: {
            error: 'store.error',
            storeChanged: 'store.changed',
            wipChanged: 'wip.changed'
        },
        loggedInOrganizationChanged: 'profile.loggedInAtChanged'
    };


    var config = {
        appErrorPrefix: '[noTos+ Fout] ',
        appTitle: 'noTos+',
        keyCodes: keyCodes,
        version: '1.0.0',
        events: events
    };

    core.value('config', config);

    core.config(configure);

    /* @ngInject */
    function configure($urlRouterProvider, $stateProvider,
                       routehelperConfigProvider, $breadcrumbProvider,
                       zStorageConfigProvider, zDirectivesConfigProvider,
                       RestangularProvider) {

        configureRouting();
        configureBreadcrumb();

        configureZStorage();
        configureZValidate();

        configureRestangular();


        function configureRouting() {
            routehelperConfigProvider.config.$urlRouterProvider = $urlRouterProvider;
            routehelperConfigProvider.config.$stateProvider = $stateProvider;

            routehelperConfigProvider.config.title = config.appTitle;
        }

        function configureBreadcrumb() {
            $breadcrumbProvider.setOptions({
                prefixStateName: 'index',
                template: 'bootstrap3',
                includeAbstract: true
            });
        }

        function configureZStorage() {
            // Setup our Breeze-based offline storage
            zStorageConfigProvider.config = {
                // zStorage
                enabled: false,
                key: 'noTosPlus',
                events: config.events.storage,

                // zStorageWip
                wipKey: 'noTosPlus.wip',
                appErrorPrefix: config.appErrorPrefix,
                newGuid: breeze.core.getUuid,

                // zStorageCore
                version: config.version
            };
        }

        function configureZValidate() {
            zDirectivesConfigProvider.zValidateTemplate =
                '<span class="invalid"><i class="fa fa-warning-sign"></i>' +
                'Onbegrijpelijk! %error%</span>';

        }

        function configureRestangular() {
            var baseUrl = '/api';

            RestangularProvider.setBaseUrl(baseUrl);
        }
    }
    configure.$inject = ["$urlRouterProvider", "$stateProvider", "routehelperConfigProvider", "$breadcrumbProvider", "zStorageConfigProvider", "zDirectivesConfigProvider", "RestangularProvider"];
})();
/* global toastr:false, moment:false */
(function() {
    'use strict';

    angular
        .module('notosplus.core')
        .constant('toastr', toastr)
        .constant('moment', moment)
        .constant('_', window._);
})();
/**
 * notosplus.core
 * FACTORY: Init
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('Init', Init);

    /* @ngInject */
    function Init() {
        var wasInitialized = false;

        var service = {
            isInitialized: isInitialized,
            initializing: initializing
        }

        return service;
        ////////////////

        function isInitialized() {
            return wasInitialized;
        }
        function initializing(init) {
            wasInitialized = init;
        }

    }
})();
    /**
 * notosplus.core
 * FILTER: Highlight
 */
(function () {
    'use strict';

    angular
        .module('notosplus.data')
        .filter('Highlight', Highlight);

    /**
     *
     */
    function Highlight($sce) {
        return function (str, termsToHighlight) {
            if (termsToHighlight === '') {
                return $sce.trustAsHtml(str);
            }
            // Sort terms by length
            termsToHighlight = termsToHighlight.split(" ");
            termsToHighlight.sort(function (a, b) {
                return b.length - a.length;
            });

            // Regex to simultaneously replace terms
            var regex = new RegExp('(?!<[^>]*?>)' + termsToHighlight.join('|') + '(?![^<]*?</[^>]*?>)', 'gi');
            return $sce.trustAsHtml(str.replace(regex, '<span class="match">$&</span>'));
        };
    }
    Highlight.$inject = ["$sce"];

})();
/**
 * notosplus.data
 * FACTORY: HTTPCache
 */

(function () {
    'use strict';

    angular
        .module('notosplus.data')
        .factory('HTTPCache', HTTPCache);

    /* @ngInject */
    function HTTPCache(Restangular, $cacheFactory) {
        var cache;
        cache = $cacheFactory('http');

        return Restangular.withConfig(function (RestangularConfigurer) {
            RestangularConfigurer.setDefaultHttpFields({cache: cache});
            RestangularConfigurer.setResponseInterceptor(function (response, operation) {
                if (operation === 'put' || operation === 'post' || operation === 'delete') {
                    cache.removeAll();
                }
                return response;
            });

            // Custom Global Method(s) for Restangularized Elements.
            RestangularConfigurer.setOnElemRestangularized(function(elem, isCollection) {
                elem.clearCache = function() {
                    cache.removeAll();
                }
                return elem;
            });
        });
    }
    HTTPCache.$inject = ["Restangular", "$cacheFactory"];
})();
/**
 * notosplus.auth
 * FACTORY: Profile
 */

(function () {
    'use strict';

    angular
        .module('notosplus.auth')
        .factory('ProfileService', ProfileService);

    /* @ngInject */
    function ProfileService($http, exception, $q, common, config) {
        var cache = null;
        var _realm = null;
        var events = config.events;

        var service = {
            current: current,
            realm: realm,
            setRealm: setRealm
        };

        return service;
        //////////////

        function current(forceRefresh) {
            if (cache && !forceRefresh) {
                //should return promise
                return $q.when(cache);
            }

            return $http.get('/api/user/profile')
                .then(getCurrentComplete)
                .catch(function (message) {
                    exception.catcher('Profiel van de huidige gebruiker opvragen, lukt niet.')(message);
                });


            function getCurrentComplete(response, status, headers, config) {
                cache = response.data;
                service.setRealm(response.data.realm);
                return response.data;
            }

        }

        function realm() {
            return _realm; //synchronous, as async data was here at initialization
        }

        function setRealm(realm) {
            //realm.domain_name= realm.domain_name.replace(/\./g, '_');
            _realm = realm;
            common.$broadcast(events.realmChanged, realm);
        }

    }
    ProfileService.$inject = ["$http", "exception", "$q", "common", "config"];
})();
/**
 * notosplus.curricula
 * FACTORY: Curriculum
 */

(function () {
    'use strict';

    angular
        .module('notosplus.curricula')
        .factory('Curriculum', Curriculum);

    /* @ngInject */
    function Curriculum(HTTPCache) {

        var service= {
            get: get,
            objectives: objectives
        }


        return service;
        //////////////

        function get(course) {
            return HTTPCache.one('/curricula', course);
        }
        function objectives(course) {
            return get(course).getList('objectives');
        }
    }
    Curriculum.$inject = ["HTTPCache"];
})();
/**
 * notosplus.layout
 * CONTROLLER: shell
 */
(function () {
    'use strict';

    angular
        .module('notosplus.layout')
        .controller('ShellController', ShellController);

    /* @ngInject */
    function ShellController(Init, $rootScope, config, ProfileService, logger) {
        /*jshint validthis: true */
        var vm = this;

        vm.busyMessage = 'Even geduld...';
        vm.isBusy = true;
        vm.showSplash = false;
        vm.avatar = null;
        vm.profile = {};
        vm.loggedInOrganization = null;

        var events = config.events;

        activate();
        /////////////

        function activate() {

            if (!Init.isInitialized()) {
                vm.showSplash = true;
                Init.initializing(true);
                getProfile().then(function (data) {

                    vm.profile = data;
                    vm.profile.fullName = vm.profile.first_name + ' ' + vm.profile.last_name;
                    //vm.profile.organizations = profile.organizations;

                    vm.avatar =
                        vm.profile.avatar ||
                        (vm.profile.gender === 'F' ? '/img/user/female.png' : '/img/user/male.png') ||
                        '/img/user/male.png';

                    initialized();
                });
            }
        }

        function getProfile() {
            return ProfileService.current().then(function (data) {
                vm.profile = data;
                return vm.profile;
            });
        }

        function toggleSpinner(on) {
            vm.isBusy = on;
        }

        $rootScope.$on('$stateChangeStart',
            function (event, next, current) {
                toggleSpinner(true);
            }
        );

        $rootScope.$on(events.controllerActivateSuccess,
            function (data) {
                toggleSpinner(false);
            }
        );
        $rootScope.$on(events.realmChanged,
            function (scope, realm) {
                vm.realm = realm;
            });

        function initialized() {
            vm.showSplash = false;

            logger.info('Welkom ' + vm.profile.first_name);
        }

    }
    ShellController.$inject = ["Init", "$rootScope", "config", "ProfileService", "logger"];
})();
/**
 * ROUTES: notosplus.dashboard
 */
(function () {
    'use strict';

    angular
        .module('notosplus.dashboard')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'index',
                config: {
                    abstract: true,
                    url: '/index',
                    ncyBreadcrumb: {
                        label: 'start'
                    }
                }
            },
            {
                state: 'index.dashboard',
                config: {
                    url: '/dashboard',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/dashboard/dashboard.html'
                        }
                    },
                    title: 'Dashboard',
                    ncyBreadcrumb: {
                        label: 'Dashboard'
                    }
                }
            }
        ];
    };
})();
/**
 * ROUTES: notosplus.library
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'library',
                config: {
                    abstract: true,
                    url: '/library'
                }
            },
            {
                state: 'library.books',
                config: {
                    url: '/books',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/library/books/books.html'
                        }
                    },
                    title: 'Boeken'
                }
            },
            {
                state: 'library.websites',
                config: {
                    url: '/websites',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/library/websites/websites.html',
                            controller: 'WebsitesController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Websites'
                }
            },
            {
                state: 'library.websites.detail',
                config: {
                    url: '/:id',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/library/websites/websitedetail.html',
                            controller: 'WebsiteDetailController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Website bewerken'
                }
            },
            {
                state: 'library.websites.detail.objectives',
                config: {
                    url:'/objectives',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/curricula/objectives/select_objectives.html',
                            controller: 'SelectObjectivesController',
                            controllerAs: 'vm'
                        }
                    }
                },
                title: 'Doelen selecteren'
            }
        ];
    };
})();
/**
 * ROUTES: notosplus.manage
 */
(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'manage',
                config: {
                    abstract: true,
                    url: '/manage',
                    title: 'Beheer'
                }
            },
            {
                state: 'manage.users',
                config: {
                    url: '/users',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/manage/users/users.html',
                            controller: 'UsersController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Gebruikers'
                }
            },
            {
                state: 'manage.users.detail',
                config: {
                    url: '/:id',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/manage/users/userdetail.html',
                            controller: 'UserDetailController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Gebruiker bewerken'
                }
            }
        ];
    };
})();
/**
 * notosplus.tags
 * FACTORY: Tag
 */

(function () {
    'use strict';

    angular
        .module('notosplus.tags')
        .factory('Tag', Tag);

    /* @ngInject */
    function Tag(HTTPCache) {
        var service = HTTPCache.service('tags');

        return service;

    }
    Tag.$inject = ["HTTPCache"];
})();
// Include in index.html so that app level exceptions are handled.
// Exclude from testRunner.html which should run exactly what it wants to run
(function() {
    'use strict';

    angular
        .module('blocks.exception')
        .provider('exceptionHandler', exceptionHandlerProvider)
        .config(config);

    /**
     * Must configure the exception handling
     * @return {[type]}
     */
    function exceptionHandlerProvider() {
        /* jshint validthis:true */
        this.config = {
            appErrorPrefix: undefined
        };

        this.configure = function (appErrorPrefix) {
            this.config.appErrorPrefix = appErrorPrefix;
        };

        this.$get = function() {
            return {config: this.config};
        };
    }

    /**
     * Configure by setting an optional string value for appErrorPrefix.
     * Accessible via config.appErrorPrefix (via config value).
     * @param  {[type]} $provide
     * @return {[type]}
     * @ngInject
     */
    function config($provide) {
        $provide.decorator('$exceptionHandler', extendExceptionHandler);
    }
    config.$inject = ["$provide"];

    /**
     * Extend the $exceptionHandler service to also display a toast.
     * @param  {Object} $delegate
     * @param  {Object} exceptionHandler
     * @param  {Object} logger
     * @return {Function} the decorated $exceptionHandler service
     */
    function extendExceptionHandler($delegate, exceptionHandler, logger) {
        return function(exception, cause) {
            var appErrorPrefix = exceptionHandler.config.appErrorPrefix || '';
            var errorData = {exception: exception, cause: cause};
            exception.message = appErrorPrefix + exception.message;
            $delegate(exception, cause);
            /**
             * Could add the error to a service's collection,
             * add errors to $rootScope, log errors to remote web server,
             * or log locally. Or throw hard. It is entirely up to you.
             * throw exception;
             *
             * @example
             *     throw { message: 'error message we added' };
             */
            logger.error(exception.message, errorData);
        };
    }
    extendExceptionHandler.$inject = ["$delegate", "exceptionHandler", "logger"];
})();
/**
 * blocks.exception
 * FACTORY: exception
 */

(function () {
    'use strict';

    angular
        .module('blocks.exception')
        .factory('exception', exception);

    /* @ngInject */
    function exception(logger) {
        var service = {
            catcher: catcher
        };
        return service;

        function catcher(message) {
            return function(reason) {
                logger.error(message, reason);
            };
        }
    }
    exception.$inject = ["logger"];
})();
/**
 * notosplus.router
 * FACTORY: routehelper
 */

(function () {
    'use strict';

    angular
        .module('blocks.router')
        .provider('routehelperConfig', routehelperConfig)
        .factory('routehelper', routehelper);

    routehelper.$inject = ['routehelperConfig', '$rootScope', '$state'];

    function routehelperConfig() {
        /* jshint validthis:true */
        this.config = {};

        this.$get = function () {
            return {
                config: this.config
            };
        };
    }

    function routehelper(routehelperConfig, $rootScope, $state) {
        var $urlRouterProvider = routehelperConfig.config.$urlRouterProvider;
        var $stateProvider = routehelperConfig.config.$stateProvider;

        var service = {
            configureStates: configureStates,
            states: states,
            get: get
        };

        init();

        return service;
        //////////////////

        function configureStates(states) {
            states.forEach(function (state) {
                if (state.config.title) {
                    state.config.ncyBreadcrumb = {
                        label: state.config.title.toLowerCase()
                    }
                }

                $stateProvider.state(state.state, state.config);
            });
        }

        function states() {
            return $state.get();
        }

        function get(pattern) {
            var result = null;
            states().forEach(function (state) {
                if (state.name === pattern) {
                    result = state;
                }
            });
            return result;
        }


        function init() {
            updateDocTitle();
            $urlRouterProvider.otherwise('/index/dashboard');
        }

        function updateDocTitle() {
            $rootScope.$on('$stateChangeSuccess',
                function (event, current, previous) {
                    var title = routehelperConfig.config.title + (current.title ? ' | ' + current.title : '');
                    $rootScope.title = title; // data bind to <title>
                    $rootScope.$state = current;
                }
            );
        }

    }
})();
/**
 * blocks.logger
 * FACTORY: logger
 */

(function () {
    'use strict';

    angular
        .module('blocks.logger')
        .factory('logger', logger);

    logger.$inject = ['$log', 'toastr'];

    function logger($log, toastr) {
        var service = {
            showToasts: true,

            error: error,
            info: info,
            success: success,
            warning: warning,

            removed: removed,
            saved: saved,

            // straight to console; bypass toastr
            log: $log.log
        };

        return service;
        /////////////////////

        function error(message, data, title) {
            toastr.error(message, title);
            $log.error('Fout: ' + message, data);
        }

        function info(message, data, title) {
            toastr.info(message, title);
            $log.info('Info: ' + message, data);
        }

        function success(message, data, title) {
            toastr.success(message, title);
            $log.info('Succes: ' + message, data);
        }

        function warning(message, data, title) {
            toastr.warning(message, title);
            $log.warn('Let op: ' + message, data);
        }

        function removed(message, data, title) {
            toastr.warning(message, title);
            $log.warn('Verwijderd: ' + message, data);
        }

        function saved(message, data, title) {
            toastr.success(message, title);
            $log.info('Bewaard: ' + message, data);
        }
    }
})();
/**
 * notosplus.curricula
 * CONTROLLER: SelectObjectivesController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.curricula')
        .controller('SelectObjectivesController', SelectObjectivesController);

    /* @ngInject */
    function SelectObjectivesController(common, config, WebsiteDraft, Curriculum,
                                        $state, $scope, SearchSiblingsIncludedFilter) {
        /*jshint validthis: true */
        var vm = this;

        vm.objectives = [];
        vm.filtered = [];
        vm.selectedItems = [];
        vm.website = null;

        vm.save = save;
        vm.cancel = cancel;
        vm.compareObjective = compareObjective;

        vm.itemsPerPage = 10;
        vm.currentPage = 1;
        vm.totalItems = 0;

        vm.search = '';

        var events = config.events;

        activate();
        ////////////

        function activate() {
            getItems().then(function () {
                loadDraft();
                common.$broadcast(events.controllerActivateSuccess);
            });

            /*
             * Search functions
             */
            $scope.$watch('vm.search', function (term) {
                if (vm.objectives) {
                    vm.filtered = SearchSiblingsIncludedFilter(vm.objectives, term);
                    vm.totalItems = vm.filtered.length;
                }
            });
        }

        function getItems() {
            return Curriculum.objectives('wiskunde').then(function (data) {
                vm.totalItems = data.length;
                return vm.objectives = vm.filtered = data;
            });
        }

        function loadDraft() {
            vm.website = WebsiteDraft.load();
            if (vm.website && vm.website.objectives) {
                return vm.selectedItems = vm.website.objectives;
            }
        }

        function compareObjective(o1, o2) {
            return o1.id === o2.id;
        }

        function save() {
            vm.website.objectives = vm.selectedItems;
            WebsiteDraft.draft(vm.website);
            gotoWebsite();
        }

        function cancel() {
            gotoWebsite();
        }

        function gotoWebsite() {
            $state.go('library.websites.detail', {id: vm.website.id});
        }
    }
    SelectObjectivesController.$inject = ["common", "config", "WebsiteDraft", "Curriculum", "$state", "$scope", "SearchSiblingsIncludedFilter"];
})();
/**
 * notosplus.data
 * FILTER: SearchSiblingsIncluded
 */
(function () {
    'use strict';

    angular
        .module('notosplus.curricula')
        .filter('SearchSiblingsIncluded', SearchSiblingsIncluded);

    /**
     *
     */
    function SearchSiblingsIncluded() {
        return function (input, searchText) {

            if (searchText === undefined)
           f

            var filtered = [],
                filteredIds = [];
            angular.forEach(input, function (item) {
                var lower_code = angular.lowercase(item.code);
                var lower_name = angular.lowercase(item.name);
                var lower_searchText = angular.lowercase(searchText);

                if (lower_name.indexOf(lower_searchText) > -1 ||
                    lower_code.indexOf(lower_searchText) > -1) {

                    if (item.parent_id) {
                        angular.forEach(input, function (pitem) {
                            if (pitem.id === item.parent_id) {
                                if (filteredIds.indexOf(pitem.id) === -1) {
                                    filtered.push(pitem);
                                    filteredIds.push(pitem.id);
                                }
                            }
                        });
                    }
                    if (filteredIds.indexOf(item.id) === -1) {
                        filtered.push(item);
                        filteredIds.push(item.id);
                    }
                    if (!item.parent_id) {
                        angular.forEach(input, function (chitem) {
                            if (chitem.parent_id === item.id) {
                                if (filteredIds.indexOf(chitem.id) === -1) {
                                    filtered.push(chitem);
                                    filteredIds.push(chitem.id);
                                }
                            }
                        });
                    }

                }
            });
            return filtered;
        }

    }
})();
/**
 * notosplus.websites
 * FILTER: SearchWebsites
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .filter('SearchWebsites', SearchWebsites);

    /**
     *
     */
    function SearchWebsites(_) {
        return function(websites, terms) {
            terms = terms.split(' ');
            return _.select(websites, function(website) {
                return _.some(terms, function(t) {
                    return _.contains(website.name.toLowerCase(), t.toLowerCase()) ||
                        _.contains(website.url.toLowerCase(), t.toLowerCase());
                });
            });
        }
    }
    SearchWebsites.$inject = ["_"];
})();
/**
 * notos-plus.library
 * FACTORY: WebsiteDraft
 */

(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .factory('WebsiteDraft', WebsiteDraft);

    /* @ngInject */
    function WebsiteDraft() {
        var website = null;

        var service = {
            draft: draft,
            load: load,
            clear: clear,
            pull: pull
        }

        return service;
        /////////////////

        function draft(website) {
            this.website = website;
        }
        function load() {
            return this.website;
        }
        function clear() {
            this.website = null;
        }
        function pull() {
            var w = this.load();
            this.clear();
            return w;
        }
    }
})();
/**
 * notosplus.library
 * FACTORY: Website
 */

(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .factory('Website', Website);

    /* @ngInject */
    function Website(HTTPCache) {
        var service = HTTPCache.service('/websites');

        return service;
    }
    Website.$inject = ["HTTPCache"];
})();
/**
 * notosplus.library
 * CONTROLLER: WebsiteDetailController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .controller('WebsiteDetailController', WebsiteDetailController);

    /* @ngInject */
    function WebsiteDetailController($state, $stateParams,
                                     common, config, Tag,
                                     Website, Dialog, WebsiteDraft, _) {
        /*jshint validthis: true */
        var vm = this;
        var logger = common.logger;
        var $q = common.$q;
        var events = config.events;

        vm.cancel = cancel;
        vm.hasChanges = false;
        vm.loading = false;
        vm.isSaving = false;
        vm.save = save;
        vm.remove = remove;
        vm.gotoObjectives = gotoObjectives;
        vm.website = null;
        vm.objectives_changed = false;

        vm.tags = [];
        vm.loadTags = loadTags;


        Object.defineProperty(vm, 'canSave', {get: canSave});

        activate();
        ////////////

        function activate() {

            preloadTags();
            getRequestedWebsite();

            common.$broadcast(events.controllerActivateSuccess);
        }

        function preloadTags() {
            return Tag.getList().then(tagsCompleted);

            function tagsCompleted(response) {
                return vm.tags = response;
            }
        }

        function loadTags(query) {
            return _.select(vm.tags, function(t) {
               return _.contains(t.name.toLowerCase(), query.toLowerCase());
            });
        }

        function cancel() {
            gotoWebsites();
        }

        function canSave() {
            return !vm.isSaving;
        }

        function getRequestedWebsite() {
            vm.loading = true;

            if (WebsiteDraft.load()) {
                vm.website = WebsiteDraft.pull();
                vm.objectives_changed = true;
                vm.loading = false;
                return vm.website;
            }

            var val = $stateParams.id;
            if (val === 'new') {
                vm.website = Website.one();
                vm.loading = false;

                return vm.website;
            }


            Website.one(val).get()
                .then(function (data) {
                    if (data) {
                        vm.website = data;

                        vm.loading = false;
                        return vm.website;
                    } else {
                        logger.warning('Could not find website id = ' + val);
                        gotoWebsites();
                    }
                    vm.loading = false;
                })
                .catch(function (error) {
                    logger.error('Error while getting website id= ' + val + '; ' + error);
                    gotoWebsites();
                })
        }

        function gotoWebsites() {
            $state.go('library.websites');
        }

        function save() {
            if (!canSave()) {
                return $q.when(null);
            } // Must return a promise

            vm.isSaving = true;

            return vm.website.save().then(function () {
                vm.isSaving = false;

                gotoWebsites();
            }).catch(function (error) {
                vm.isSaving = false;
                logger.error('Kon website niet opslaan. [' + error + ']');
            });
        }

        function remove() {
            return Dialog.deleteDialog(vm.website.name + ' [' + vm.website.url + ']')
                .then(removeWebsite);

            function removeWebsite() {
                vm.website.remove().then(function () {
                    vm.website.clearCache();
                    logger.warning(vm.website.name + ' werd met succes verwijderd.');
                    gotoWebsites();
                }).catch(function (error) {
                    Dialog.confirmationDialog('Verwijderen mislukt',
                        'Het verwijderen van ' + vm.website.name + ' is mislukt. Probeer het later opnieuw.');
                });
            }
        }

        function gotoObjectives() {
            WebsiteDraft.draft(vm.website);
            $state.go('library.websites.detail.objectives');
        }

    }
    WebsiteDetailController.$inject = ["$state", "$stateParams", "common", "config", "Tag", "Website", "Dialog", "WebsiteDraft", "_"];
})();
/**
 * notosplus.library
 * CONTROLLER: WebsitesController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .controller('WebsitesController', WebsitesController);

    /* @ngInject */
    function WebsitesController(common, config, $state, Website, $scope, SearchWebsitesFilter) {
        /*jshint validthis: true */
        var vm = this;

        vm.websites = [];
        vm.filteredWebsites = [];
        vm.gotoWebsite = gotoWebsite;

        vm.filter = {
            terms: null
        };

        var events = config.events;

        activate();
        ////////////////

        function activate() {
            common.$broadcast(events.controllerActivateSuccess);
            getWebsites();
        }

        function getWebsites(forceRefresh) {
            vm.loading = true;

            if (forceRefresh) {
                if (vm.websites) {
                    vm.websites.clearCache();
                }
            }
            Website.getList().then(function (data) {
                vm.websites = vm.filteredWebsites = data;
                vm.loading = false;
                return vm.websites;
            });
        }

        function gotoWebsite(website) {
            if (website && website.id) {
                $state.go('library.websites.detail', {id: website.id});
            }
        }

        $scope.$watch('vm.filter', doFilter, true);

        function doFilter() {
            if (vm.filter.terms && vm.filter.terms !== '') {
                vm.filteredWebsites = SearchWebsitesFilter(vm.websites, vm.filter.terms);
            } else {
                vm.filteredWebsites = vm.websites;
            }
        }
    }
    WebsitesController.$inject = ["common", "config", "$state", "Website", "$scope", "SearchWebsitesFilter"];
})();
/*
 if (_.some(terms, function (t) {
 return nameContainsTerm(website.name, t) ||
 descriptionContainsTerm(website.description, t) ||
 objectivesContainsTerm(website.objectives, t);
 })) {
 addUnique(website, filtered);
 }

 */
/**
 * notosplus.manage
 * FACTORY: User
 */

(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .factory('User', User);


    /* @ngInject */
    function User(HTTPCache, ProfileService) {

        var service = HTTPCache.service('/organization/' + ProfileService.realm().id + '/user');


        return service;
    }
    User.$inject = ["HTTPCache", "ProfileService"];
})();
/**
 * notosplus.manage
 * CONTROLLER: UserAddController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .controller('UserDetailController', UserDetailController);

    /* @ngInject */
    function UserDetailController($state, $stateParams,
                                  common, config, User, Dialog, ProfileService) {
        /*jshint validthis: true */
        var vm = this;
        var logger = common.logger;
        var $q = common.$q;
        var events = config.events;


        vm.cancel = cancel;
        vm.hasChanges = false;
        vm.loading = false;
        vm.isSaving = false;
        vm.isResetPwd = false;
        vm.resetPwd = resetPassword;
        vm.save = save;
        vm.remove = remove;
        vm.user = null;
        vm.users = [];
        vm.defaultUsername = defaultUsername;
        vm.defaultDomain = ProfileService.current().domain_name;

        Object.defineProperty(vm, 'canSave', {get: canSave});

        activate();

        function activate() {
            //onDestroy();
            //onHasChanges();

            getRequestedUser();

            common.$broadcast(events.controllerActivateSuccess);
        }

        function cancel() {
            goToUsers();
        }

        function canSave() {
            return !vm.isSaving;
        }

        function getRequestedUser() {
            vm.loading = true;
            var val = $stateParams.id;
            if (val === 'new') {
                vm.user = User.one();
                vm.isResetPwd = true;
                vm.loading = false;

                return vm.user;
            }

            User.one(val).get()
                .then(function (data) {
                    if (data) {
                        vm.user = data;

                        vm.loading = false;
                        return vm.user;

                    } else {
                        logger.warning('Could not find user id = ' + val);
                        goToUsers();
                    }
                    vm.loading = false;
                })
                .catch(function (error) {
                    logger.error('Error while getting user id = ' + val + '; ' + error);
                    goToUsers();
                });
        }

        function goToUsers() {
            $state.go('manage.users');
        }

        function save() {

            if (!canSave()) {
                return $q.when(null);
            } // Must return a promise

            vm.isSaving = true;

            return vm.user.save().then(function () {
                vm.isSaving = false;

                goToUsers();
            }).catch(function (error) {
                vm.isSaving = false;
                logger.error('Kon gebruiker niet opslaan. [' + error + ']');
            });

        }

        function resetPassword() {
            return Dialog.resetPasswordDialog()
                .then(patchResettedPassword);

            function patchResettedPassword(data) {
                vm.user.one('password').patch(data)
                    .then(passwordWasResetted);

                function passwordWasResetted(user) {
                    common.logger.info('Paswoord opnieuw ingesteld voor ' + user.full_name);
                }
            }
        }

        function remove() {
            return Dialog.deleteDialog(vm.user.full_name)
                .then(removeUser);

            function removeUser() {
                vm.user.remove().then(function () {
                    vm.user.clearCache();
                    logger.warning(vm.user.full_name + ' werd met succes verwijderd.');
                    goToUsers();
                }).catch(function (response) {
                    Dialog.confirmationDialog('Verwijderen mislukt',
                        'Het verwijderen van ' + vm.user.full_name + ' is mislukt. Probeer het later opnieuw.');
                });
            }
        }

        function defaultUsername() {
            if(vm.user.username) {
                return vm.user.username;
            }
            return vm.user.first
        }
    }
    UserDetailController.$inject = ["$state", "$stateParams", "common", "config", "User", "Dialog", "ProfileService"];
})();
/**
 * notosplus.manage
 * CONTROLLER: UsersController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .controller('UsersController', UsersController);


    /* @ngInject */
    function UsersController($state, config, common, User) {
        /*jshint validthis: true */
        var vm = this;

        var keyCodes = config.keyCodes;
        var events = config.events;

        vm.filteredUsers = [];
        vm.gotoUser = gotoUser;
        vm.refresh = refresh;
        vm.search = search;
        vm.userSearch = '';
        vm.users = [];


        activate();

        function activate() {
            common.$broadcast(events.controllerActivateSuccess);
            getUsers();
        }

        function applyFilter() {
            vm.filteredUsers = vm.users.filter(userFilter);
        }


        function getUsers(forceRefresh) {
            vm.loading = true;

            if (forceRefresh) {
                if (vm.users) {
                    vm.users.clearCache();
                }
            }
            User.getList().then(function (data) {
                vm.users = vm.filteredUsers = data;
                vm.loading = false;

                return vm.users;
            });
        }


        function gotoUser(user) {
            if (user && user.id) {
                $state.go('manage.users.detail', {id: user.id});
            }
        }

        function refresh() {
            vm.userSearch = '';
            getUsers(true);
        }

        function search($event) {
            if ($event.keyCode === keyCodes.esc) {
                vm.userSearch = '';
            }
            applyFilter();
        }

        function userFilter(user) {
            var isMatch = true;
            if (vm.userSearch) {
                isMatch = common.textContains(user.name, vm.userSearch);
                isMatch |= common.textContains(user.username, vm.userSearch);
            }

            return isMatch;
        }
    }
    UsersController.$inject = ["$state", "config", "common", "User"];
})();
/**
 * notosplus.widgets
 * DIRECTIVE: ntFa
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntFa', ntFa);

    ntFa.$inject = [];

    function ntFa() {
        var directive = {
            restrict: 'E',
            link: linkFunc
        };

        return directive;
        //////////////////////

        function linkFunc(scope, element, attrs) {
            var i = angular.element('<i class="fa" />');
            var classes = attrs.name.split(' ');

            angular.forEach(classes, function (value) {
                i.addClass('fa-' + value);
            });

            element.replaceWith(i);
        }
    }
})();


/**
 * notosplus.widgets
 * DIRECTIVE: ntSpinner
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntSpinner', ntSpinner);

    /* @ngInject */
    function ntSpinner() {
        var directive = {
            restrict: 'EA',
            compile: compile
        };

        return directive;
        //////////////////////
        function compile(elem, attrs) {
            if (elem[0].tagName === 'TABLE') {
                addSpinnerToTBody(elem, attrs);
            } else {
                addSpinnerToElement(elem, attrs);
            }
        }

        function addSpinnerToTBody(element, attrs) {
            var tbody = element.find('tbody');
            var html = ['<tr ng-show="' + attrs.spinnerShow + '">',
                            '<td ',
                                (attrs.hasOwnProperty('colspan') ? 'colspan="' + attrs.colspan + '" ' : ''),
                            ' style="text-align:center">',
                                '<img src="/img/busy/busyatom.gif" style="width:40px;height:40px;">',
                            '</td>',
                        '</tr>'].join('');

            tbody.prepend(html);
        }
        function addSpinnerToElement(element, attrs) {
            var html = ['<div ng-show="' + attrs.spinnerShow + '" class="col-md-12 text-center">',
                    '<img src="/img/busy/busyatom.gif" style="width:40px;height:40px;">',
                '</div>',
                '<div class="clearfix"></div>'].join('');

            element.prepend(html);
        }
    }
})();


/**
 * notosplus.widgets
 * FACTORY: spinnerService
 */

(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .factory('spinnerService', spinnerService);

    /* @ngInject */
    function spinnerService() {
        var spinners = {};
        var service = {
            _register: register,
            _unregister: unregister,
            _unregisterAll: unregisterAll,
            show: show,
            hide: hide,
            showGroup: showGroup,
            hideGroup: hideGroup,
            showAll: showAll,
            hideAll: hideAll
        }

        return service;
        //////////////
        function register(data) {
            if(!data.hasOwnProperty('name')) {
                throw new Error('Spinner must specify a name when registering with the spinner service.');
            }
            if(spinners.hasOwnProperty(data.name)) {
                throw new Error('A spinner with the name "' + data.name + '" has already been registered.');
            }
            spinners[data.name] = data;
        }

        function unregister(name) {
            if(spinners.hasOwnProperty(name)) {
                delete spinners[name];
            }
        }

        function unregisterAll() {
            for(var name in spinners) {
                delete spinners[name];
            }
        }

        function show(name) {
            var spinner  = spinners[name];
            if(!spinner) {
                throw  new Error('No spinner named "' + name + '" is registered.');
            }
            spinner.show();
        }

        function hide(name) {
            var spinner  = spinners[name];
            if(!spinner) {
                throw  new Error('No spinner named "' + name + '" is registered.');
            }
            spinner.hide();
        }

        function showGroup(group) {
            var groupExists = false;
            for(var name in spinners) {
                var spinner = spinners[name];
                if(spinner.group === group) {
                    spinner.show();
                    groupExists = true;
                }
            }
            if(!groupExists) {
                throw new Error('No spinners found with group "' + group + '".');
            }
        }
        function hideGroup(group) {
            var groupExists = false;
            for(var name in spinners) {
                var spinner = spinners[name];
                if(spinner.group === group) {
                    spinner.hide();
                    groupExists = true;
                }
            }
            if(!groupExists) {
                throw new Error('No spinners found with group "' + group + '".');
            }
        }
        function showAll() {
            for(var name in spinners) {
                spinners[name].show();
            }
        }
        function hideAll() {
            for(var name in spinners) {
                spinners[name].hide();
            }
        }
    }
})();
/**
 * notosplus.widgets
 * DIRECTIVE: ntMiniSideBar
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntMiniSidebar', ntMiniSidebar);

    function ntMiniSidebar() {
        var directive = {
            restrict: 'A',
            template: [
                '<a class="navbar-minimalize minimalize-styl-2 btn btn-primary" href="" ng-click="vm.minimalize()">',
                '<i class="fa fa-bars"></i>',
                '</a>'
            ].join(''),

            controller: MinimizeController,
            controllerAs: 'vm',
            bindToController: true // because the scope is isolated
        };

        MinimizeController.$inject = ["$timeout"];
        return directive;
        //////////////////////

        /* @ngInject */
        function MinimizeController($timeout) {
            var vm = this;
            vm.minimalize = minimalize;

            //////////////////////////////////
            function minimalize() {
                angular.element('body').toggleClass('mini-navbar');
                if (!angular.element('body').hasClass('mini-navbar') || angular.element('body').hasClass('body-small')) {
                    // Hide menu in order to smoothly turn on when maximize menu
                    angular.element('#side-menu').hide();
                    // For smoothly turn on menu
                    $timeout(
                        function () {
                            angular.element('#side-menu').fadeIn(500);
                        }, 100);
                } else if (angular.element('body').hasClass('fixed-sidebar')) {
                    angular.element('#side-menu').hide();
                    $timeout(
                        function () {
                            angular.element('#side-menu').fadeIn(500);
                        }, 300);
                } else {
                    // Remove all inline style from jquery fadeIn function to reset menu state
                    angular.element('#side-menu').removeAttr('style');
                }
            }
        }
    }
})();


/**
 * notosplus.widgets
 * DIRECTIVE: ntPagination
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntPagination', ntPagination);

    /* @ngInject */
    function ntPagination($compile) {
        var directive = {
            restrict: 'EA',
            scope: {
                totalItems: '=',
                itemsPerPage: '=',
                currentPage: '='
            },
            link: linkFunc,
            controller: PaginateController,
            controllerAs: 'vm',
            bindToController: true // because the scope is isolated
        };

        PaginateController.$inject = ["$scope"];
        return directive;
        //////////////////////

        function linkFunc(scope, element, attrs) {
            var pagination = angular.element('<pagination />')
            pagination.attr('data-boundary-links', true);
            pagination.attr('data-total-items', 'totalItems');
            pagination.attr('data-items-per-page', 'itemsPerPage');
            pagination.attr('data-max-size', 5);
            pagination.attr('data-ng-model', 'currentPage');
            pagination.attr('data-previous-text', '');
            pagination.attr('data-next-text', '');
            pagination.attr('data-first-text', '');
            pagination.attr('data-last-text', '');
            pagination.attr('data-ng-hide', 'hide');
            if (attrs['class']) {
                pagination.attr('class', attrs['class']);
            }

            $compile(pagination)(scope);
            element.replaceWith(pagination);
        }

        /* @ngInject */
        function PaginateController($scope) {
            var vm = this;

            vm.hide = false;
            vm.itemsPerPage = 10;
            vm.currentPge = 0;

            $scope.$watch('vm.totalItems', function () {
                vm.hide = (vm.totalItems <= vm.itemsPerPage);
            });
        }
    }
    ntPagination.$inject = ["$compile"];
})();


/**
 * notosplus
 * DIRECTIVE: ntSideNavigation
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntSideNavigation', ntSideNavigation);

    /* @ngInject */
    function ntSideNavigation($timeout) {
        var directive = {
            restrict: 'EA',
            link: linkFunc
        };

        return directive;
        //////////////////////

        function linkFunc(scope, element) {
            $timeout(function () {
                $(element).metisMenu();
            })
        };
    }
    ntSideNavigation.$inject = ["$timeout"];
})();


/**
 * notosplus.widgets
 * FILTER: offset
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .filter('offset', filter);


    function filter() {
        return function offset(input, start) {
            if (input) {
                start = parseInt(start, 10);
                return input.slice(start);
            }
            return [];
        };
    }
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vdG9zcGx1cy5tb2R1bGUuanMiLCJjb3JlLm1vZHVsZS5qcyIsImRhdGEubW9kdWxlLmpzIiwiYXV0aC9hdXRoLm1vZHVsZS5qcyIsImN1cnJpY3VsYS9jdXJyaWN1bGEubW9kdWxlLmpzIiwibGF5b3V0L2xheW91dC5tb2R1bGUuanMiLCJkYXNoYm9hcmQvZGFzaGJvYXJkLm1vZHVsZS5qcyIsImxpYnJhcnkvbGlicmFyeS5tb2R1bGUuanMiLCJtYW5hZ2UvbWFuYWdlLm1vZHVsZS5qcyIsInRhZ3MvdGFncy5tb2R1bGUuanMiLCJ3aWRnZXRzL3dpZGdldHMubW9kdWxlLmpzIiwiYmxvY2tzL2V4Y2VwdGlvbi9leGNlcHRpb24ubW9kdWxlLmpzIiwiYmxvY2tzL3JvdXRlci9yb3V0ZXIubW9kdWxlLmpzIiwiYmxvY2tzL2xvZ2dlci9sb2dnZXIubW9kdWxlLmpzIiwiYm9vdHN0cmFwLmRpYWxvZy5qcyIsImNvbW1vbi5qcyIsImNvbmZpZy5icmVlemUuanMiLCJjb25maWcuanMiLCJjb25zdGFudHMuanMiLCJpbml0LmpzIiwiaGlnaGxpZ2h0LmpzIiwicmVzdGFuZ3VsYXIuY2FjaGUuanMiLCJhdXRoL3Byb2ZpbGUuanMiLCJjdXJyaWN1bGEvY3VycmljdWx1bS5qcyIsImxheW91dC9zaGVsbC5jb250cm9sbGVyLmpzIiwiZGFzaGJvYXJkL2Rhc2hib2FyZC5yb3V0ZXMuanMiLCJsaWJyYXJ5L2xpYnJhcnkucm91dGVzLmpzIiwibWFuYWdlL21hbmFnZS5yb3V0ZXMuanMiLCJ0YWdzL3RhZy5qcyIsImJsb2Nrcy9leGNlcHRpb24vZXhjZXB0aW9uLWhhbmRsZXIucHJvdmlkZXIuanMiLCJibG9ja3MvZXhjZXB0aW9uL2V4Y2VwdGlvbi5qcyIsImJsb2Nrcy9yb3V0ZXIvcm91dGVoZWxwZXIuanMiLCJibG9ja3MvbG9nZ2VyL2xvZ2dlci5qcyIsImN1cnJpY3VsYS9vYmplY3RpdmVzL3NlbGVjdC5vYmplY3RpdmVzLmNvbnRyb2xsZXIuanMiLCJjdXJyaWN1bGEvb2JqZWN0aXZlcy9zaWJsaW5nSW5jbHVkZWQuanMiLCJsaWJyYXJ5L3dlYnNpdGVzL3NlYXJjaFdlYnNpdGVzLmZpbHRlci5qcyIsImxpYnJhcnkvd2Vic2l0ZXMvd2Vic2l0ZS5kcmFmdC5qcyIsImxpYnJhcnkvd2Vic2l0ZXMvd2Vic2l0ZS5qcyIsImxpYnJhcnkvd2Vic2l0ZXMvd2Vic2l0ZWRldGFpbC5jb250cm9sbGVyLmpzIiwibGlicmFyeS93ZWJzaXRlcy93ZWJzaXRlcy5jb250cm9sbGVyLmpzIiwibWFuYWdlL3VzZXJzL3VzZXIuanMiLCJtYW5hZ2UvdXNlcnMvdXNlcmRldGFpbC5jb250cm9sbGVyLmpzIiwibWFuYWdlL3VzZXJzL3VzZXJzLmNvbnRyb2xsZXIuanMiLCJ3aWRnZXRzL2ljb25zL250RmEuanMiLCJ3aWRnZXRzL2xvYWRpbmcvbnRTcGlubmVyLmpzIiwid2lkZ2V0cy9sb2FkaW5nL3NwaW5uZXJTZXJ2aWNlLmpzIiwid2lkZ2V0cy9uYXZpZ2F0aW9uL250TWluaVNpZGViYXIuanMiLCJ3aWRnZXRzL25hdmlnYXRpb24vbnRQYWdpbmF0aW9uLmpzIiwid2lkZ2V0cy9uYXZpZ2F0aW9uL250U2lkZU5hdmlnYXRpb24uanMiLCJ3aWRnZXRzL25hdmlnYXRpb24vb2Zmc2V0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUEsV0FBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxhQUFBOztZQUVBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7OztZQUdBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7Ozs7QUNoQkE7S0FDQSxPQUFBLGtCQUFBOztRQUVBLGFBQUEsY0FBQTs7O1FBR0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBOzs7UUFHQTtRQUNBO1FBQ0E7O0FDcEJBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxrQkFBQTs7QUNKQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUEsa0JBQUE7O0FDSkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLHVCQUFBOztBQ0pBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxvQkFBQTs7QUNKQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUEsdUJBQUE7Ozs7QUNKQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUEscUJBQUE7O0FDSkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLG9CQUFBOztBQ0pBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxrQkFBQTs7QUNKQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUEscUJBQUE7O0FDSkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLG9CQUFBLENBQUE7O0FDSkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLGlCQUFBO1lBQ0E7OztBQ0xBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxpQkFBQTs7Ozs7OztBQ0NBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsVUFBQTs7O0lBR0EsU0FBQSxZQUFBLFFBQUEsZ0JBQUE7UUFDQSxJQUFBLFVBQUE7WUFDQSxjQUFBO1lBQ0Esb0JBQUE7WUFDQSxxQkFBQTs7O1FBR0Esb0JBQUE7UUFDQSw0QkFBQTs7UUFFQSxPQUFBOzs7UUFHQSxTQUFBLGFBQUEsVUFBQTtZQUNBLElBQUEsUUFBQTtZQUNBLFdBQUEsWUFBQTtZQUNBLElBQUEsTUFBQSxlQUFBLFdBQUE7O1lBRUEsT0FBQSxtQkFBQSxPQUFBOzs7UUFHQSxTQUFBLG1CQUFBLE9BQUEsS0FBQSxRQUFBLFlBQUE7WUFDQSxJQUFBLGVBQUE7Z0JBQ0EsYUFBQTtnQkFDQSxZQUFBO2dCQUNBLFVBQUE7Z0JBQ0EsU0FBQTtvQkFDQSxTQUFBLFlBQUE7d0JBQ0EsT0FBQTs0QkFDQSxPQUFBOzRCQUNBLFNBQUE7NEJBQ0EsUUFBQTs0QkFDQSxZQUFBOzRCQUNBLFVBQUE7NEJBQ0EsaUJBQUE7Ozs7OztZQU1BLE9BQUEsT0FBQSxLQUFBLGNBQUE7OztRQUdBLFNBQUEsb0JBQUEsT0FBQSxLQUFBLFFBQUEsWUFBQTtZQUNBLElBQUEsZUFBQTtnQkFDQSxhQUFBO2dCQUNBLFlBQUE7Z0JBQ0EsVUFBQTtnQkFDQSxTQUFBO29CQUNBLFNBQUEsWUFBQTt3QkFDQSxPQUFBOzRCQUNBLE9BQUE7NEJBQ0EsU0FBQTs0QkFDQSxRQUFBOzRCQUNBLFlBQUE7NEJBQ0EsVUFBQTs0QkFDQSxpQkFBQTs7Ozs7O1lBTUEsT0FBQSxPQUFBLEtBQUEsY0FBQTs7Ozs7Ozs7SUFPQSxTQUFBLGNBQUEsUUFBQSxnQkFBQSxTQUFBO1FBQ0EsT0FBQSxRQUFBLFFBQUEsU0FBQTtRQUNBLE9BQUEsVUFBQSxRQUFBLFdBQUE7UUFDQSxPQUFBLFNBQUEsUUFBQSxVQUFBO1FBQ0EsT0FBQSxhQUFBLFFBQUEsY0FBQTtRQUNBLE9BQUEsS0FBQSxZQUFBO1lBQ0EsZUFBQSxNQUFBOztRQUVBLE9BQUEsU0FBQSxZQUFBO1lBQ0EsZUFBQSxRQUFBOzs7Ozs7SUFLQSxTQUFBLDJCQUFBLFFBQUEsZ0JBQUEsU0FBQTtRQUNBLE9BQUEsUUFBQSxRQUFBLFNBQUE7UUFDQSxPQUFBLFVBQUEsUUFBQSxXQUFBO1FBQ0EsT0FBQSxTQUFBLFFBQUEsVUFBQTtRQUNBLE9BQUEsYUFBQSxRQUFBLGNBQUE7UUFDQSxPQUFBLFdBQUE7UUFDQSxPQUFBLGtCQUFBO1FBQ0EsT0FBQSxLQUFBLFlBQUE7WUFDQSxlQUFBLE1BQUEsQ0FBQSxVQUFBLE9BQUE7O1FBRUEsT0FBQSxTQUFBLFlBQUE7WUFDQSxlQUFBLFFBQUE7Ozs7O0lBSUEsU0FBQSxvQkFBQSxnQkFBQTtRQUNBLGVBQUEsSUFBQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7OztJQUdBLFNBQUEsNEJBQUEsZ0JBQUE7UUFDQSxlQUFBLElBQUE7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNB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QUFBLEVBQUE7d0JBQ0EsRUFBQSxTQUFBLFFBQUEsSUFBQSxlQUFBLEVBQUE7Ozs7Ozs7Ozs7OztBQ2ZBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsZ0JBQUE7OztJQUdBLFNBQUEsZUFBQTtRQUNBLElBQUEsVUFBQTs7UUFFQSxJQUFBLFVBQUE7WUFDQSxPQUFBO1lBQ0EsTUFBQTtZQUNBLE9BQUE7WUFDQSxNQUFBOzs7UUFHQSxPQUFBOzs7UUFHQSxTQUFBLE1BQUEsU0FBQTtZQUNBLEtBQUEsVUFBQTs7UUFFQSxTQUFBLE9BQUE7WUFDQSxPQUFBLEtBQUE7O1FBRUEsU0FBQSxRQUFBO1lBQ0EsS0FBQSxVQUFBOztRQUVBLFNBQUEsT0FBQTtZQUNBLElBQUEsSUFBQSxLQUFBO1lBQ0EsS0FBQTtZQUNBLE9BQUE7Ozs7Ozs7OztBQ2pDQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLFdBQUE7OztJQUdBLFNBQUEsUUFBQSxXQUFBO1FBQ0EsSUFBQSxVQUFBLFVBQUEsUUFBQTs7UUFFQSxPQUFBOzs7Ozs7OztBQ1pBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFdBQUEsMkJBQUE7OztJQUdBLFNBQUEsd0JBQUEsUUFBQTtxQ0FDQSxRQUFBLFFBQUE7cUNBQ0EsU0FBQSxRQUFBLGNBQUEsR0FBQTs7UUFFQSxJQUFBLEtBQUE7UUFDQSxJQUFBLFNBQUEsT0FBQTtRQUNBLElBQUEsS0FBQSxPQUFBO1FBQ0EsSUFBQSxTQUFBLE9BQUE7O1FBRUEsR0FBQSxTQUFBO1FBQ0EsR0FBQSxhQUFBO1FBQ0EsR0FBQSxVQUFBO1FBQ0EsR0FBQSxXQUFBO1FBQ0EsR0FBQSxPQUFBO1FBQ0EsR0FBQSxTQUFBO1FBQ0EsR0FBQSxpQkFBQTtRQUNBLEdBQUEsVUFBQTtRQUNBLEdBQUEscUJBQUE7O1FBRUEsR0FBQSxPQUFBO1FBQ0EsR0FBQSxXQUFBOzs7UUFHQSxPQUFBLGVBQUEsSUFBQSxXQUFBLENBQUEsS0FBQTs7UUFFQTs7O1FBR0EsU0FBQSxXQUFBOztZQUVBO1lBQ0E7O1lBRUEsT0FBQSxXQUFBLE9BQUE7OztRQUdBLFNBQUEsY0FBQTtZQUNBLE9BQUEsSUFBQSxVQUFBLEtBQUE7O1lBRUEsU0FBQSxjQUFBLFVBQUE7Z0JBQ0EsT0FBQSxHQUFBLE9BQUE7Ozs7UUFJQSxTQUFBLFNBQUEsT0FBQTtZQUNBLE9BQUEsRUFBQSxPQUFBLEdBQUEsTUFBQSxTQUFBLEdBQUE7ZUFDQSxPQUFBLEVBQUEsU0FBQSxFQUFBLEtBQUEsZUFBQSxNQUFBOzs7O1FBSUEsU0FBQSxTQUFBO1lBQ0E7OztRQUdBLFNBQUEsVUFBQTtZQUNBLE9BQUEsQ0FBQSxHQUFBOzs7UUFHQSxTQUFBLHNCQUFBO1lBQ0EsR0FBQSxVQUFBOztZQUVBLElBQUEsYUFBQSxRQUFBO2dCQUNBLEdBQUEsVUFBQSxhQUFBO2dCQUNBLEdBQUEscUJBQUE7Z0JBQ0EsR0FBQSxVQUFBO2dCQUNBLE9BQUEsR0FBQTs7O1lBR0EsSUFBQSxNQUFBLGFBQUE7WUFDQSxJQUFBLFFBQUEsT0FBQTtnQkFDQSxHQUFBLFVBQUEsUUFBQTtnQkFDQSxHQUFBLFVBQUE7O2dCQUVBLE9BQUEsR0FBQTs7OztZQUlBLFFBQUEsSUFBQSxLQUFBO2lCQUNBLEtBQUEsVUFBQSxNQUFBO29CQUNBLElBQUEsTUFBQTt3QkFDQSxHQUFBLFVBQUE7O3dCQUVBLEdBQUEsVUFBQTt3QkFDQSxPQUFBLEdBQUE7MkJBQ0E7d0JBQ0EsT0FBQSxRQUFBLGlDQUFBO3dCQUNBOztvQkFFQSxHQUFBLFVBQUE7O2lCQUVBLE1BQUEsVUFBQSxPQUFBO29CQUNBLE9BQUEsTUFBQSxxQ0FBQSxNQUFBLE9BQUE7b0JBQ0E7Ozs7UUFJQSxTQUFBLGVBQUE7WUFDQSxPQUFBLEdBQUE7OztRQUdBLFNBQUEsT0FBQTtZQUNBLElBQUEsQ0FBQSxXQUFBO2dCQUNBLE9BQUEsR0FBQSxLQUFBOzs7WUFHQSxHQUFBLFdBQUE7O1lBRUEsT0FBQSxHQUFBLFFBQUEsT0FBQSxLQUFBLFlBQUE7Z0JBQ0EsR0FBQSxXQUFBOztnQkFFQTtlQUNBLE1BQUEsVUFBQSxPQUFBO2dCQUNBLEdBQUEsV0FBQTtnQkFDQSxPQUFBLE1BQUEsZ0NBQUEsUUFBQTs7OztRQUlBLFNBQUEsU0FBQTtZQUNBLE9BQUEsT0FBQSxhQUFBLEdBQUEsUUFBQSxPQUFBLE9BQUEsR0FBQSxRQUFBLE1BQUE7aUJBQ0EsS0FBQTs7WUFFQSxTQUFBLGdCQUFBO2dCQUNBLEdBQUEsUUFBQSxTQUFBLEtBQUEsWUFBQTtvQkFDQSxHQUFBLFFBQUE7b0JBQ0EsT0FBQSxRQUFBLEdBQUEsUUFBQSxPQUFBO29CQUNBO21CQUNBLE1BQUEsVUFBQSxPQUFBO29CQUNBLE9BQUEsbUJBQUE7d0JBQ0EseUJBQUEsR0FBQSxRQUFBLE9BQUE7Ozs7O1FBS0EsU0FBQSxpQkFBQTtZQUNBLGFBQUEsTUFBQSxHQUFBO1lBQ0EsT0FBQSxHQUFBOzs7Ozs7Ozs7O0FDL0lBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFdBQUEsc0JBQUE7OztJQUdBLFNBQUEsbUJBQUEsUUFBQSxRQUFBLFFBQUEsU0FBQSxRQUFBLHNCQUFBOztRQUVBLElBQUEsS0FBQTs7UUFFQSxHQUFBLFdBQUE7UUFDQSxHQUFBLG1CQUFBO1FBQ0EsR0FBQSxjQUFBOztRQUVBLEdBQUEsU0FBQTtZQUNBLE9BQUE7OztRQUdBLElBQUEsU0FBQSxPQUFBOztRQUVBOzs7UUFHQSxTQUFBLFdBQUE7WUFDQSxPQUFBLFdBQUEsT0FBQTtZQUNBOzs7UUFHQSxTQUFBLFlBQUEsY0FBQTtZQUNBLEdBQUEsVUFBQTs7WUFFQSxJQUFBLGNBQUE7Z0JBQ0EsSUFBQSxHQUFBLFVBQUE7b0JBQ0EsR0FBQSxTQUFBOzs7WUFHQSxRQUFBLFVBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsR0FBQSxXQUFBLEdBQUEsbUJBQUE7Z0JBQ0EsR0FBQSxVQUFBO2dCQUNBLE9BQUEsR0FBQTs7OztRQUlBLFNBQUEsWUFBQSxTQUFBO1lBQ0EsSUFBQSxXQUFBLFFBQUEsSUFBQTtnQkFDQSxPQUFBLEdBQUEsMkJBQUEsQ0FBQSxJQUFBLFFBQUE7Ozs7UUFJQSxPQUFBLE9BQUEsYUFBQSxVQUFBOztRQUVBLFNBQUEsV0FBQTtZQUNBLElBQUEsR0FBQSxPQUFBLFNBQUEsR0FBQSxPQUFBLFVBQUEsSUFBQTtnQkFDQSxHQUFBLG1CQUFBLHFCQUFBLEdBQUEsVUFBQSxHQUFBLE9BQUE7bUJBQ0E7Z0JBQ0EsR0FBQSxtQkFBQSxHQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN4REEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxRQUFBOzs7O0lBSUEsU0FBQSxLQUFBLFdBQUEsZ0JBQUE7O1FBRUEsSUFBQSxVQUFBLFVBQUEsUUFBQSxtQkFBQSxlQUFBLFFBQUEsS0FBQTs7O1FBR0EsT0FBQTs7Ozs7Ozs7QUNmQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxXQUFBLHdCQUFBOzs7SUFHQSxTQUFBLHFCQUFBLFFBQUE7a0NBQ0EsUUFBQSxRQUFBLE1BQUEsUUFBQSxnQkFBQTs7UUFFQSxJQUFBLEtBQUE7UUFDQSxJQUFBLFNBQUEsT0FBQTtRQUNBLElBQUEsS0FBQSxPQUFBO1FBQ0EsSUFBQSxTQUFBLE9BQUE7OztRQUdBLEdBQUEsU0FBQTtRQUNBLEdBQUEsYUFBQTtRQUNBLEdBQUEsVUFBQTtRQUNBLEdBQUEsV0FBQTtRQUNBLEdBQUEsYUFBQTtRQUNBLEdBQUEsV0FBQTtRQUNBLEdBQUEsT0FBQTtRQUNBLEdBQUEsU0FBQTtRQUNBLEdBQUEsT0FBQTtRQUNBLEdBQUEsUUFBQTtRQUNBLEdBQUEsa0JBQUE7UUFDQSxHQUFBLGdCQUFBLGVBQUEsVUFBQTs7UUFFQSxPQUFBLGVBQUEsSUFBQSxXQUFBLENBQUEsS0FBQTs7UUFFQTs7UUFFQSxTQUFBLFdBQUE7Ozs7WUFJQTs7WUFFQSxPQUFBLFdBQUEsT0FBQTs7O1FBR0EsU0FBQSxTQUFBO1lBQ0E7OztRQUdBLFNBQUEsVUFBQTtZQUNBLE9BQUEsQ0FBQSxHQUFBOzs7UUFHQSxTQUFBLG1CQUFBO1lBQ0EsR0FBQSxVQUFBO1lBQ0EsSUFBQSxNQUFBLGFBQUE7WUFDQSxJQUFBLFFBQUEsT0FBQTtnQkFDQSxHQUFBLE9BQUEsS0FBQTtnQkFDQSxHQUFBLGFBQUE7Z0JBQ0EsR0FBQSxVQUFBOztnQkFFQSxPQUFBLEdBQUE7OztZQUdBLEtBQUEsSUFBQSxLQUFBO2lCQUNBLEtBQUEsVUFBQSxNQUFBO29CQUNBLElBQUEsTUFBQTt3QkFDQSxHQUFBLE9BQUE7O3dCQUVBLEdBQUEsVUFBQTt3QkFDQSxPQUFBLEdBQUE7OzJCQUVBO3dCQUNBLE9BQUEsUUFBQSw4QkFBQTt3QkFDQTs7b0JBRUEsR0FBQSxVQUFBOztpQkFFQSxNQUFBLFVBQUEsT0FBQTtvQkFDQSxPQUFBLE1BQUEsbUNBQUEsTUFBQSxPQUFBO29CQUNBOzs7O1FBSUEsU0FBQSxZQUFBO1lBQ0EsT0FBQSxHQUFBOzs7UUFHQSxTQUFBLE9BQUE7O1lBRUEsSUFBQSxDQUFBLFdBQUE7Z0JBQ0EsT0FBQSxHQUFBLEtBQUE7OztZQUdBLEdBQUEsV0FBQTs7WUFFQSxPQUFBLEdBQUEsS0FBQSxPQUFBLEtBQUEsWUFBQTtnQkFDQSxHQUFBLFdBQUE7O2dCQUVBO2VBQ0EsTUFBQSxVQUFBLE9BQUE7Z0JBQ0EsR0FBQSxXQUFBO2dCQUNBLE9BQUEsTUFBQSxrQ0FBQSxRQUFBOzs7OztRQUtBLFNBQUEsZ0JBQUE7WUFDQSxPQUFBLE9BQUE7aUJBQ0EsS0FBQTs7WUFFQSxTQUFBLHNCQUFBLE1BQUE7Z0JBQ0EsR0FBQSxLQUFBLElBQUEsWUFBQSxNQUFBO3FCQUNBLEtBQUE7O2dCQUVBLFNBQUEsb0JBQUEsTUFBQTtvQkFDQSxPQUFBLE9BQUEsS0FBQSxxQ0FBQSxLQUFBOzs7OztRQUtBLFNBQUEsU0FBQTtZQUNBLE9BQUEsT0FBQSxhQUFBLEdBQUEsS0FBQTtpQkFDQSxLQUFBOztZQUVBLFNBQUEsYUFBQTtnQkFDQSxHQUFBLEtBQUEsU0FBQSxLQUFBLFlBQUE7b0JBQ0EsR0FBQSxLQUFBO29CQUNBLE9BQUEsUUFBQSxHQUFBLEtBQUEsWUFBQTtvQkFDQTttQkFDQSxNQUFBLFVBQUEsVUFBQTtvQkFDQSxPQUFBLG1CQUFBO3dCQUNBLHlCQUFBLEdBQUEsS0FBQSxZQUFBOzs7OztRQUtBLFNBQUEsa0JBQUE7WUFDQSxHQUFBLEdBQUEsS0FBQSxVQUFBO2dCQUNBLE9BQUEsR0FBQSxLQUFBOztZQUVBLE9BQUEsR0FBQSxLQUFBOzs7Ozs7Ozs7QUMzSUEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsV0FBQSxtQkFBQTs7OztJQUlBLFNBQUEsZ0JBQUEsUUFBQSxRQUFBLFFBQUEsTUFBQTs7UUFFQSxJQUFBLEtBQUE7O1FBRUEsSUFBQSxXQUFBLE9BQUE7UUFDQSxJQUFBLFNBQUEsT0FBQTs7UUFFQSxHQUFBLGdCQUFBO1FBQ0EsR0FBQSxXQUFBO1FBQ0EsR0FBQSxVQUFBO1FBQ0EsR0FBQSxTQUFBO1FBQ0EsR0FBQSxhQUFBO1FBQ0EsR0FBQSxRQUFBOzs7UUFHQTs7UUFFQSxTQUFBLFdBQUE7WUFDQSxPQUFBLFdBQUEsT0FBQTtZQUNBOzs7UUFHQSxTQUFBLGNBQUE7WUFDQSxHQUFBLGdCQUFBLEdBQUEsTUFBQSxPQUFBOzs7O1FBSUEsU0FBQSxTQUFBLGNBQUE7WUFDQSxHQUFBLFVBQUE7O1lBRUEsSUFBQSxjQUFBO2dCQUNBLElBQUEsR0FBQSxPQUFBO29CQUNBLEdBQUEsTUFBQTs7O1lBR0EsS0FBQSxVQUFBLEtBQUEsVUFBQSxNQUFBO2dCQUNBLEdBQUEsUUFBQSxHQUFBLGdCQUFBO2dCQUNBLEdBQUEsVUFBQTs7Z0JBRUEsT0FBQSxHQUFBOzs7OztRQUtBLFNBQUEsU0FBQSxNQUFBO1lBQ0EsSUFBQSxRQUFBLEtBQUEsSUFBQTtnQkFDQSxPQUFBLEdBQUEsdUJBQUEsQ0FBQSxJQUFBLEtBQUE7Ozs7UUFJQSxTQUFBLFVBQUE7WUFDQSxHQUFBLGFBQUE7WUFDQSxTQUFBOzs7UUFHQSxTQUFBLE9BQUEsUUFBQTtZQUNBLElBQUEsT0FBQSxZQUFBLFNBQUEsS0FBQTtnQkFDQSxHQUFBLGFBQUE7O1lBRUE7OztRQUdBLFNBQUEsV0FBQSxNQUFBO1lBQ0EsSUFBQSxVQUFBO1lBQ0EsSUFBQSxH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QTtTQUNBLE9BQUEsVUFBQTs7O0lBR0EsU0FBQSxTQUFBO1FBQ0EsT0FBQSxTQUFBLE9BQUEsT0FBQSxPQUFBO1lBQ0EsSUFBQSxPQUFBO2dCQUNBLFFBQUEsU0FBQSxPQUFBO2dCQUNBLE9BQUEsTUFBQSxNQUFBOztZQUVBLE9BQUE7OztLQUdBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMnLCBbXG4gICAgICAgICAgICAvL3NoYXJlZCBtb2R1bGVzXG4gICAgICAgICAgICAnbm90b3NwbHVzLmNvcmUnLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy53aWRnZXRzJyxcbiAgICAgICAgICAgICdub3Rvc3BsdXMuYXV0aCcsXG4gICAgICAgICAgICAnbm90b3NwbHVzLmRhdGEnLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy5sYXlvdXQnLFxuXG4gICAgICAgICAgICAvL2FwcCBtb2R1bGVzXG4gICAgICAgICAgICAnbm90b3NwbHVzLmRhc2hib2FyZCcsXG4gICAgICAgICAgICAnbm90b3NwbHVzLm1hbmFnZScsXG4gICAgICAgICAgICAnbm90b3NwbHVzLmxpYnJhcnknLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy5jdXJyaWN1bGEnLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy50YWdzJ1xuICAgICAgICBdKTtcbn0pKCk7IiwiXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnbm90b3NwbHVzLmNvcmUnLCBbXG4gICAgICAgIC8vQW5ndWxhclxuICAgICAgICAnbmdBbmltYXRlJywgJ25nU2FuaXRpemUnLCAnbmdSZXNvdXJjZScsXG5cbiAgICAgICAgLy8zcmQgcGFydHlcbiAgICAgICAgJ3VpLmJvb3RzdHJhcCcsXG4gICAgICAgICduY3ktYW5ndWxhci1icmVhZGNydW1iJyxcbiAgICAgICAgJ2JyZWV6ZS5hbmd1bGFyJywgICAvLyB0ZWxscyBicmVlemUgdG8gdXNlICRxIGluc3RlYWQgb2YgUS5qc1xuICAgICAgICAnYnJlZXplLmRpcmVjdGl2ZXMnLC8vIGJyZWV6ZSB2YWxpZGF0aW9uIGRpcmVjdGl2ZSAoelZhbGlkYXRlKSxcbiAgICAgICAgJ25neldpcCcsXG4gICAgICAgICduZ3BsdXMnLFxuICAgICAgICAncmVzdGFuZ3VsYXInLFxuICAgICAgICAnY2hlY2tsaXN0LW1vZGVsJyxcbiAgICAgICAgJ25nVGFnc0lucHV0JyxcblxuICAgICAgICAvL2Nyb3NzIGFwcCBtb2R1bGVzXG4gICAgICAgICdibG9ja3MuZXhjZXB0aW9uJyxcbiAgICAgICAgJ2Jsb2Nrcy5sb2dnZXInLFxuICAgICAgICAnYmxvY2tzLnJvdXRlcidcbiAgICBdKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmRhdGEnLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuYXV0aCcsIFtdKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jdXJyaWN1bGEnLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubGF5b3V0JywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmRhc2hib2FyZCcsIFtcblxuICAgICAgICBdKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5saWJyYXJ5JywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLm1hbmFnZScsIFtdKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy50YWdzJywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLndpZGdldHMnLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJywgWydibG9ja3MubG9nZ2VyJ10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLnJvdXRlcicsIFtcbiAgICAgICAgICAgICd1aS5yb3V0ZXInXG4gICAgICAgIF0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicsIFtdKTtcbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuY29yZVxuICogRkFDVE9SWTogYm9vdHN0cmFwLmRpYWxvZ1xuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuY29yZScpXG4gICAgICAgIC5mYWN0b3J5KCdEaWFsb2cnLCBtb2RhbERpYWxvZyk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBtb2RhbERpYWxvZygkbW9kYWwsICR0ZW1wbGF0ZUNhY2hlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgZGVsZXRlRGlhbG9nOiBkZWxldGVEaWFsb2csXG4gICAgICAgICAgICBjb25maXJtYXRpb25EaWFsb2c6IGNvbmZpcm1hdGlvbkRpYWxvZyxcbiAgICAgICAgICAgIHJlc2V0UGFzc3dvcmREaWFsb2c6IHJlc2V0UGFzc3dvcmREaWFsb2dcbiAgICAgICAgfTtcblxuICAgICAgICByZWdpc3Rlck1vZGVsRGlhbG9nKCR0ZW1wbGF0ZUNhY2hlKTtcbiAgICAgICAgcmVnaXN0ZXJSZXNldFBhc3N3b3JkRGlhbG9nKCR0ZW1wbGF0ZUNhY2hlKTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZURpYWxvZyhpdGVtTmFtZSkge1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gJ0JlbiBqZSB6ZWtlcj8nO1xuICAgICAgICAgICAgaXRlbU5hbWUgPSBpdGVtTmFtZSB8fCAnaXRlbSc7XG4gICAgICAgICAgICB2YXIgbXNnID0gJ1ZlcndpamRlciAnICsgaXRlbU5hbWUgKyAnPyc7XG5cbiAgICAgICAgICAgIHJldHVybiBjb25maXJtYXRpb25EaWFsb2codGl0bGUsIG1zZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjb25maXJtYXRpb25EaWFsb2codGl0bGUsIG1zZywgb2tUZXh0LCBjYW5jZWxUZXh0KSB7XG4gICAgICAgICAgICB2YXIgbW9kYWxPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kYWxEaWFsb2cudHBsLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IE1vZGFsSW5zdGFuY2UsXG4gICAgICAgICAgICAgICAga2V5Ym9hcmQ6IHRydWUsXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtc2csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2tUZXh0OiBva1RleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsVGV4dDogY2FuY2VsVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybVBhc3N3b3JkOiAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiAkbW9kYWwub3Blbihtb2RhbE9wdGlvbnMpLnJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmREaWFsb2codGl0bGUsIG1zZywgb2tUZXh0LCBjYW5jZWxUZXh0KSB7XG4gICAgICAgICAgICB2YXIgbW9kYWxPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncmVzZXRQYXNzd29yZERpYWxvZy50cGwuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogUmVzZXRQYXNzd29yZE1vZGFsSW5zdGFuY2UsXG4gICAgICAgICAgICAgICAga2V5Ym9hcmQ6IHRydWUsXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtc2csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2tUZXh0OiBva1RleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsVGV4dDogY2FuY2VsVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybVBhc3N3b3JkOiAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiAkbW9kYWwub3Blbihtb2RhbE9wdGlvbnMpLnJlc3VsdDtcbiAgICAgICAgfVxuXG5cbiAgICB9XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBNb2RhbEluc3RhbmNlKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UsIG9wdGlvbnMpIHtcbiAgICAgICAgJHNjb3BlLnRpdGxlID0gb3B0aW9ucy50aXRsZSB8fCAnVGl0ZWwnO1xuICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG9wdGlvbnMubWVzc2FnZSB8fCAnJztcbiAgICAgICAgJHNjb3BlLm9rVGV4dCA9IG9wdGlvbnMub2tUZXh0IHx8ICdPayc7XG4gICAgICAgICRzY29wZS5jYW5jZWxUZXh0ID0gb3B0aW9ucy5jYW5jZWxUZXh0IHx8ICdBbm51bGVyZW4nO1xuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgnb2snKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFJlc2V0UGFzc3dvcmRNb2RhbEluc3RhbmNlKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UsIG9wdGlvbnMpIHtcbiAgICAgICAgJHNjb3BlLnRpdGxlID0gb3B0aW9ucy50aXRsZSB8fCAnUGFzd29vcmQgb3BuaWV1dyBpbnN0ZWxsZW4nO1xuICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG9wdGlvbnMubWVzc2FnZSB8fCAnR2VlZiBoZXQgbmlldXdlIHBhc3dvb3JkIGluLic7XG4gICAgICAgICRzY29wZS5va1RleHQgPSBvcHRpb25zLm9rVGV4dCB8fCAnV2lqemlnJztcbiAgICAgICAgJHNjb3BlLmNhbmNlbFRleHQgPSBvcHRpb25zLmNhbmNlbFRleHQgfHwgJ0FubnVsZXJlbic7XG4gICAgICAgICRzY29wZS5wYXNzd29yZCA9ICcnO1xuICAgICAgICAkc2NvcGUuY29uZmlybVBhc3N3b3JkID0gJyc7XG4gICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKHtwYXNzd29yZDogJHNjb3BlLnBhc3N3b3JkfSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWdpc3Rlck1vZGVsRGlhbG9nKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICAgICAgICR0ZW1wbGF0ZUNhY2hlLnB1dCgnbW9kYWxEaWFsb2cudHBsLmh0bWwnLFxuICAgICAgICAgICAgJzxkaXY+JyArXG4gICAgICAgICAgICAnICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIiBkYXRhLWRpc21pc3M9XCJtb2RhbFwiICcgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIGRhdGEtbmctY2xpY2s9XCJjYW5jZWwoKVwiPiZ0aW1lczs8L2J1dHRvbj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxoMz57e3RpdGxlfX08L2gzPicgK1xuICAgICAgICAgICAgJyAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICcgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxwPnt7bWVzc2FnZX19PC9wPicgK1xuICAgICAgICAgICAgJyAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICcgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIGRhdGEtbmctY2xpY2s9XCJvaygpXCI+e3tva1RleHR9fTwvYnV0dG9uPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4taW5mb1wiIGRhdGEtbmctY2xpY2s9XCJjYW5jZWwoKVwiPnt7Y2FuY2VsVGV4dH19PC9idXR0b24+JyArXG4gICAgICAgICAgICAnICAgIDwvZGl2PicgK1xuICAgICAgICAgICAgJzwvZGl2PicpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlZ2lzdGVyUmVzZXRQYXNzd29yZERpYWxvZygkdGVtcGxhdGVDYWNoZSkge1xuICAgICAgICAkdGVtcGxhdGVDYWNoZS5wdXQoJ3Jlc2V0UGFzc3dvcmREaWFsb2cudHBsLmh0bWwnLFxuICAgICAgICAgICAgJzxkaXY+JyArXG4gICAgICAgICAgICAnICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIiBkYXRhLWRpc21pc3M9XCJtb2RhbFwiICcgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIGRhdGEtbmctY2xpY2s9XCJjYW5jZWwoKVwiPiZ0aW1lczs8L2J1dHRvbj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxoMz57e3RpdGxlfX08L2gzPicgK1xuICAgICAgICAgICAgJyAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICcgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxwPnt7bWVzc2FnZX19PC9wPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj4nICtcbiAgICAgICAgICAgICcgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cImNvbnRyb2wtbGFiZWxcIj5QYXN3b29yZDwvbGFiZWw+JyArXG4gICAgICAgICAgICAnICAgICAgICAgICA8aW5wdXQgdHlwZT1cInBhc3N3b3JkXCIgZGF0YS1uZy1tb2RlbD1cInBhc3N3b3JkXCIgcGxhY2Vob2xkZXI9XCJOaWV1dyBwYXN3b29yZFwiIGNsYXNzPVwiZm9ybS1jb250cm9sXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICAgICA8bGFiZWwgY2xhc3M9XCJjb250cm9sLWxhYmVsXCI+SGVyaGFhbCBwYXNzd29yZDwvbGFiZWw+JyArXG4gICAgICAgICAgICAnICAgICAgICAgICA8aW5wdXQgdHlwZT1cInBhc3N3b3JkXCIgZGF0YS1uZy1tb2RlbD1cImNvbmZpcm1QYXNzd29yZFwiIHBsYWNlaG9sZGVyPVwiSGVyaGFhbCBwYXN3b29yZFwiIGNsYXNzPVwiZm9ybS1jb250cm9sXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICAgICA8c3BhbiBjbGFzcz1cInRleHQtZGFuZ2VyXCIgZGF0YS1uZy1zaG93PVwicGFzc3dvcmQgIT09IGNvbmZpcm1QYXNzd29yZCAmJiBwYXNzd29yZCAhPT0gXFwnXFwnXCI+RGUgcGFzd29vcmRlbiBrb21lbiBuaWV0IG92ZXJlZW4uPC9zcGFuPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgIDwvZGl2PicgK1xuICAgICAgICAgICAgJyAgICA8ZGl2IGNsYXNzPVwibW9kYWwtZm9vdGVyXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCIgZGF0YS1uZy1jbGljaz1cIm9rKClcIiBkYXRhLW5nLWRpc2FibGVkPVwicGFzc3dvcmQgIT09IGNvbmZpcm1QYXNzd29yZCB8fCBwYXNzd29yZCA9PT0gXFwnXFwnXCI+e3tva1RleHR9fTwvYnV0dG9uPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4taW5mb1wiIGRhdGEtbmctY2xpY2s9XCJjYW5jZWwoKVwiPnt7Y2FuY2VsVGV4dH19PC9idXR0b24+JyArXG4gICAgICAgICAgICAnICAgIDwvZGl2PicgK1xuICAgICAgICAgICAgJzwvZGl2PicpO1xuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuY29yZVxuICogRkFDVE9SWTogY29tbW9uXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jb3JlJylcbiAgICAgICAgLmZhY3RvcnkoJ2NvbW1vbicsIGNvbW1vbik7XG5cbiAgICBmdW5jdGlvbiBjb21tb24oJHEsICRyb290U2NvcGUsICR0aW1lb3V0LCBsb2dnZXIpIHtcbiAgICAgICAgdmFyIHRocm90dGxlcyA9IHt9O1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgLy8gY29tbW9uIGFuZ3VsYXIgZGVwZW5kZW5jaWVzXG4gICAgICAgICAgICAkYnJvYWRjYXN0OiAkYnJvYWRjYXN0LFxuICAgICAgICAgICAgJHE6ICRxLFxuICAgICAgICAgICAgJHRpbWVvdXQ6ICR0aW1lb3V0LFxuICAgICAgICAgICAgLy8gZ2VuZXJpY1xuICAgICAgICAgICAgaXNOdW1iZXI6IGlzTnVtYmVyLFxuICAgICAgICAgICAgZGVib3VuY2VkVGhyb3R0bGU6IGRlYm91bmNlZFRocm90dGxlLFxuICAgICAgICAgICAgbG9nZ2VyOiBsb2dnZXIsXG4gICAgICAgICAgICB0ZXh0Q29udGFpbnM6IHRleHRDb250YWluc1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uICRicm9hZGNhc3QoKSB7XG4gICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS4kYnJvYWRjYXN0LmFwcGx5KCRyb290U2NvcGUsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cblxuXG4gICAgICAgIGZ1bmN0aW9uIGRlYm91bmNlZFRocm90dGxlKGtleSwgY2FsbGJhY2ssIGRlbGF5LCBpbW1lZGlhdGUpIHtcbiAgICAgICAgICAgIC8vIFBlcmZvcm0gc29tZSBhY3Rpb24gKGNhbGxiYWNrKSBhZnRlciBhIGRlbGF5LlxuICAgICAgICAgICAgLy8gVHJhY2sgdGhlIGNhbGxiYWNrIGJ5IGtleSwgc28gaWYgdGhlIHNhbWUgY2FsbGJhY2tcbiAgICAgICAgICAgIC8vIGlzIGlzc3VlZCBhZ2FpbiwgcmVzdGFydCB0aGUgZGVsYXkuXG4gICAgICAgICAgICB2YXIgZGVmYXVsdERlbGF5ID0gMTAwMDtcbiAgICAgICAgICAgIGRlbGF5ID0gZGVsYXkgfHwgZGVmYXVsdERlbGF5O1xuICAgICAgICAgICAgaWYgKHRocm90dGxlc1trZXldKSB7XG4gICAgICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRocm90dGxlc1trZXldKTtcbiAgICAgICAgICAgICAgICB0aHJvdHRsZXNba2V5XSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbW1lZGlhdGUpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdHRsZXNba2V5XSA9ICR0aW1lb3V0KGNhbGxiYWNrLCBkZWxheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpc051bWJlcih2YWwpIHtcbiAgICAgICAgICAgIC8vIG5lZ2F0aXZlIG9yIHBvc2l0aXZlXG4gICAgICAgICAgICByZXR1cm4gKC9eWy1dP1xcZCskLykudGVzdCh2YWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdGV4dENvbnRhaW5zKHRleHQsIHNlYXJjaFRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0ZXh0ICYmIC0xICE9PSB0ZXh0LnRvTG93ZXJDYXNlKCkuaW5kZXhPZihzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5kYXRhXG4gKiBGQUNUT1JZOiBicmVlemVDb25maWdcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmNvcmUnKVxuICAgICAgICAuZmFjdG9yeSgnYnJlZXplQ29uZmlnJywgYnJlZXplQ29uZmlnKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGJyZWV6ZUNvbmZpZyhicmVlemUpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICByZW1vdGVTZXJ2aWNlTmFtZTogJy9hcGkvYnJlZXplJyxcbiAgICAgICAgICAgIGJyZWV6ZTogYnJlZXplXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vL1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBjb3JlID0gYW5ndWxhci5tb2R1bGUoJ25vdG9zcGx1cy5jb3JlJyk7XG5cbiAgICBjb3JlLmNvbmZpZyh0b2FzdHJDb25maWcpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gdG9hc3RyQ29uZmlnKHRvYXN0cikge1xuICAgICAgICB0b2FzdHIub3B0aW9ucy50aW1lT3V0ID0gNDAwMDtcbiAgICAgICAgdG9hc3RyLm9wdGlvbnMuY2xvc2VCdXR0b24gPSB0cnVlO1xuICAgICAgICB0b2FzdHIub3B0aW9ucy5wcm9ncmVzc0JhciA9IHRydWU7XG4gICAgICAgIHRvYXN0ci5vcHRpb25zLnBvc2l0aW9uQ2xhc3MgPSAndG9hc3QtYm90dG9tLXJpZ2h0JztcbiAgICB9XG5cbiAgICB2YXIga2V5Q29kZXMgPSB7XG4gICAgICAgIGJhY2tzcGFjZTogOCxcbiAgICAgICAgdGFiOiA5LFxuICAgICAgICBlbnRlcjogMTMsXG4gICAgICAgIGVzYzogMjcsXG4gICAgICAgIHNwYWNlOiAzMixcbiAgICAgICAgcGFnZXVwOiAzMyxcbiAgICAgICAgcGFnZWRvd246IDM0LFxuICAgICAgICBlbmQ6IDM1LFxuICAgICAgICBob21lOiAzNixcbiAgICAgICAgbGVmdDogMzcsXG4gICAgICAgIHVwOiAzOCxcbiAgICAgICAgcmlnaHQ6IDM5LFxuICAgICAgICBkb3duOiA0MCxcbiAgICAgICAgaW5zZXJ0OiA0NSxcbiAgICAgICAgZGVsOiA0NlxuICAgIH07XG5cbiAgICB2YXIgZXZlbnRzID0ge1xuICAgICAgICBjb250cm9sbGVyQWN0aXZhdGVTdWNjZXNzOiAnY29udHJvbGxlci5hY3RpdmF0ZVN1Y2Nlc3MnLFxuICAgICAgICBlbnRpdGllc0NoYW5nZWQ6ICdkYXRhY29udGV4dC5lbnRpdGllc0NoYW5nZWQnLFxuICAgICAgICBlbnRpdGllc0ltcG9ydGVkOiAnZGF0YWNvbnRleHQuZW50aXRpZXNJbXBvcnRlZCcsXG4gICAgICAgIGhhc0NoYW5nZXNDaGFuZ2VkOiAnZGF0YWNvbnRleHQuaGFzQ2hhbmdlc0NoYW5nZWQnLFxuICAgICAgICBzdG9yYWdlOiB7XG4gICAgICAgICAgICBlcnJvcjogJ3N0b3JlLmVycm9yJyxcbiAgICAgICAgICAgIHN0b3JlQ2hhbmdlZDogJ3N0b3JlLmNoYW5nZWQnLFxuICAgICAgICAgICAgd2lwQ2hhbmdlZDogJ3dpcC5jaGFuZ2VkJ1xuICAgICAgICB9LFxuICAgICAgICBsb2dnZWRJbk9yZ2FuaXphdGlvbkNoYW5nZWQ6ICdwcm9maWxlLmxvZ2dlZEluQXRDaGFuZ2VkJ1xuICAgIH07XG5cblxuICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgIGFwcEVycm9yUHJlZml4OiAnW25vVG9zKyBGb3V0XSAnLFxuICAgICAgICBhcHBUaXRsZTogJ25vVG9zKycsXG4gICAgICAgIGtleUNvZGVzOiBrZXlDb2RlcyxcbiAgICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgICAgZXZlbnRzOiBldmVudHNcbiAgICB9O1xuXG4gICAgY29yZS52YWx1ZSgnY29uZmlnJywgY29uZmlnKTtcblxuICAgIGNvcmUuY29uZmlnKGNvbmZpZ3VyZSk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWd1cmUoJHVybFJvdXRlclByb3ZpZGVyLCAkc3RhdGVQcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgcm91dGVoZWxwZXJDb25maWdQcm92aWRlciwgJGJyZWFkY3J1bWJQcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgelN0b3JhZ2VDb25maWdQcm92aWRlciwgekRpcmVjdGl2ZXNDb25maWdQcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgUmVzdGFuZ3VsYXJQcm92aWRlcikge1xuXG4gICAgICAgIGNvbmZpZ3VyZVJvdXRpbmcoKTtcbiAgICAgICAgY29uZmlndXJlQnJlYWRjcnVtYigpO1xuXG4gICAgICAgIGNvbmZpZ3VyZVpTdG9yYWdlKCk7XG4gICAgICAgIGNvbmZpZ3VyZVpWYWxpZGF0ZSgpO1xuXG4gICAgICAgIGNvbmZpZ3VyZVJlc3Rhbmd1bGFyKCk7XG5cblxuICAgICAgICBmdW5jdGlvbiBjb25maWd1cmVSb3V0aW5nKCkge1xuICAgICAgICAgICAgcm91dGVoZWxwZXJDb25maWdQcm92aWRlci5jb25maWcuJHVybFJvdXRlclByb3ZpZGVyID0gJHVybFJvdXRlclByb3ZpZGVyO1xuICAgICAgICAgICAgcm91dGVoZWxwZXJDb25maWdQcm92aWRlci5jb25maWcuJHN0YXRlUHJvdmlkZXIgPSAkc3RhdGVQcm92aWRlcjtcblxuICAgICAgICAgICAgcm91dGVoZWxwZXJDb25maWdQcm92aWRlci5jb25maWcudGl0bGUgPSBjb25maWcuYXBwVGl0bGU7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjb25maWd1cmVCcmVhZGNydW1iKCkge1xuICAgICAgICAgICAgJGJyZWFkY3J1bWJQcm92aWRlci5zZXRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICBwcmVmaXhTdGF0ZU5hbWU6ICdpbmRleCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdib290c3RyYXAzJyxcbiAgICAgICAgICAgICAgICBpbmNsdWRlQWJzdHJhY3Q6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlWlN0b3JhZ2UoKSB7XG4gICAgICAgICAgICAvLyBTZXR1cCBvdXIgQnJlZXplLWJhc2VkIG9mZmxpbmUgc3RvcmFnZVxuICAgICAgICAgICAgelN0b3JhZ2VDb25maWdQcm92aWRlci5jb25maWcgPSB7XG4gICAgICAgICAgICAgICAgLy8gelN0b3JhZ2VcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBrZXk6ICdub1Rvc1BsdXMnLFxuICAgICAgICAgICAgICAgIGV2ZW50czogY29uZmlnLmV2ZW50cy5zdG9yYWdlLFxuXG4gICAgICAgICAgICAgICAgLy8gelN0b3JhZ2VXaXBcbiAgICAgICAgICAgICAgICB3aXBLZXk6ICdub1Rvc1BsdXMud2lwJyxcbiAgICAgICAgICAgICAgICBhcHBFcnJvclByZWZpeDogY29uZmlnLmFwcEVycm9yUHJlZml4LFxuICAgICAgICAgICAgICAgIG5ld0d1aWQ6IGJyZWV6ZS5jb3JlLmdldFV1aWQsXG5cbiAgICAgICAgICAgICAgICAvLyB6U3RvcmFnZUNvcmVcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBjb25maWcudmVyc2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVpWYWxpZGF0ZSgpIHtcbiAgICAgICAgICAgIHpEaXJlY3RpdmVzQ29uZmlnUHJvdmlkZXIuelZhbGlkYXRlVGVtcGxhdGUgPVxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImludmFsaWRcIj48aSBjbGFzcz1cImZhIGZhLXdhcm5pbmctc2lnblwiPjwvaT4nICtcbiAgICAgICAgICAgICAgICAnT25iZWdyaWpwZWxpamshICVlcnJvciU8L3NwYW4+JztcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlUmVzdGFuZ3VsYXIoKSB7XG4gICAgICAgICAgICB2YXIgYmFzZVVybCA9ICcvYXBpJztcblxuICAgICAgICAgICAgUmVzdGFuZ3VsYXJQcm92aWRlci5zZXRCYXNlVXJsKGJhc2VVcmwpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKiBnbG9iYWwgdG9hc3RyOmZhbHNlLCBtb21lbnQ6ZmFsc2UgKi9cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jb3JlJylcbiAgICAgICAgLmNvbnN0YW50KCd0b2FzdHInLCB0b2FzdHIpXG4gICAgICAgIC5jb25zdGFudCgnbW9tZW50JywgbW9tZW50KVxuICAgICAgICAuY29uc3RhbnQoJ18nLCB3aW5kb3cuXyk7XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmNvcmVcbiAqIEZBQ1RPUlk6IEluaXRcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmNvcmUnKVxuICAgICAgICAuZmFjdG9yeSgnSW5pdCcsIEluaXQpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gSW5pdCgpIHtcbiAgICAgICAgdmFyIHdhc0luaXRpYWxpemVkID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBpc0luaXRpYWxpemVkOiBpc0luaXRpYWxpemVkLFxuICAgICAgICAgICAgaW5pdGlhbGl6aW5nOiBpbml0aWFsaXppbmdcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gaXNJbml0aWFsaXplZCgpIHtcbiAgICAgICAgICAgIHJldHVybiB3YXNJbml0aWFsaXplZDtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXppbmcoaW5pdCkge1xuICAgICAgICAgICAgd2FzSW5pdGlhbGl6ZWQgPSBpbml0O1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIiAgICAvKipcbiAqIG5vdG9zcGx1cy5jb3JlXG4gKiBGSUxURVI6IEhpZ2hsaWdodFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmRhdGEnKVxuICAgICAgICAuZmlsdGVyKCdIaWdobGlnaHQnLCBIaWdobGlnaHQpO1xuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBIaWdobGlnaHQoJHNjZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHN0ciwgdGVybXNUb0hpZ2hsaWdodCkge1xuICAgICAgICAgICAgaWYgKHRlcm1zVG9IaWdobGlnaHQgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRzY2UudHJ1c3RBc0h0bWwoc3RyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFNvcnQgdGVybXMgYnkgbGVuZ3RoXG4gICAgICAgICAgICB0ZXJtc1RvSGlnaGxpZ2h0ID0gdGVybXNUb0hpZ2hsaWdodC5zcGxpdChcIiBcIik7XG4gICAgICAgICAgICB0ZXJtc1RvSGlnaGxpZ2h0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYi5sZW5ndGggLSBhLmxlbmd0aDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBSZWdleCB0byBzaW11bHRhbmVvdXNseSByZXBsYWNlIHRlcm1zXG4gICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKCcoPyE8W14+XSo/PiknICsgdGVybXNUb0hpZ2hsaWdodC5qb2luKCd8JykgKyAnKD8hW148XSo/PC9bXj5dKj8+KScsICdnaScpO1xuICAgICAgICAgICAgcmV0dXJuICRzY2UudHJ1c3RBc0h0bWwoc3RyLnJlcGxhY2UocmVnZXgsICc8c3BhbiBjbGFzcz1cIm1hdGNoXCI+JCY8L3NwYW4+JykpO1xuICAgICAgICB9O1xuICAgIH1cblxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5kYXRhXG4gKiBGQUNUT1JZOiBIVFRQQ2FjaGVcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmRhdGEnKVxuICAgICAgICAuZmFjdG9yeSgnSFRUUENhY2hlJywgSFRUUENhY2hlKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEhUVFBDYWNoZShSZXN0YW5ndWxhciwgJGNhY2hlRmFjdG9yeSkge1xuICAgICAgICB2YXIgY2FjaGU7XG4gICAgICAgIGNhY2hlID0gJGNhY2hlRmFjdG9yeSgnaHR0cCcpO1xuXG4gICAgICAgIHJldHVybiBSZXN0YW5ndWxhci53aXRoQ29uZmlnKGZ1bmN0aW9uIChSZXN0YW5ndWxhckNvbmZpZ3VyZXIpIHtcbiAgICAgICAgICAgIFJlc3Rhbmd1bGFyQ29uZmlndXJlci5zZXREZWZhdWx0SHR0cEZpZWxkcyh7Y2FjaGU6IGNhY2hlfSk7XG4gICAgICAgICAgICBSZXN0YW5ndWxhckNvbmZpZ3VyZXIuc2V0UmVzcG9uc2VJbnRlcmNlcHRvcihmdW5jdGlvbiAocmVzcG9uc2UsIG9wZXJhdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChvcGVyYXRpb24gPT09ICdwdXQnIHx8IG9wZXJhdGlvbiA9PT0gJ3Bvc3QnIHx8IG9wZXJhdGlvbiA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGUucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBDdXN0b20gR2xvYmFsIE1ldGhvZChzKSBmb3IgUmVzdGFuZ3VsYXJpemVkIEVsZW1lbnRzLlxuICAgICAgICAgICAgUmVzdGFuZ3VsYXJDb25maWd1cmVyLnNldE9uRWxlbVJlc3Rhbmd1bGFyaXplZChmdW5jdGlvbihlbGVtLCBpc0NvbGxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBlbGVtLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGUucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuYXV0aFxuICogRkFDVE9SWTogUHJvZmlsZVxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuYXV0aCcpXG4gICAgICAgIC5mYWN0b3J5KCdQcm9maWxlU2VydmljZScsIFByb2ZpbGVTZXJ2aWNlKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFByb2ZpbGVTZXJ2aWNlKCRodHRwLCBleGNlcHRpb24sICRxLCBjb21tb24sIGNvbmZpZykge1xuICAgICAgICB2YXIgY2FjaGUgPSBudWxsO1xuICAgICAgICB2YXIgX3JlYWxtID0gbnVsbDtcbiAgICAgICAgdmFyIGV2ZW50cyA9IGNvbmZpZy5ldmVudHM7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBjdXJyZW50OiBjdXJyZW50LFxuICAgICAgICAgICAgcmVhbG06IHJlYWxtLFxuICAgICAgICAgICAgc2V0UmVhbG06IHNldFJlYWxtXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gY3VycmVudChmb3JjZVJlZnJlc2gpIHtcbiAgICAgICAgICAgIGlmIChjYWNoZSAmJiAhZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgLy9zaG91bGQgcmV0dXJuIHByb21pc2VcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEud2hlbihjYWNoZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlci9wcm9maWxlJylcbiAgICAgICAgICAgICAgICAudGhlbihnZXRDdXJyZW50Q29tcGxldGUpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4Y2VwdGlvbi5jYXRjaGVyKCdQcm9maWVsIHZhbiBkZSBodWlkaWdlIGdlYnJ1aWtlciBvcHZyYWdlbiwgbHVrdCBuaWV0LicpKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRDb21wbGV0ZShyZXNwb25zZSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBjYWNoZSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgc2VydmljZS5zZXRSZWFsbShyZXNwb25zZS5kYXRhLnJlYWxtKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVhbG0oKSB7XG4gICAgICAgICAgICByZXR1cm4gX3JlYWxtOyAvL3N5bmNocm9ub3VzLCBhcyBhc3luYyBkYXRhIHdhcyBoZXJlIGF0IGluaXRpYWxpemF0aW9uXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRSZWFsbShyZWFsbSkge1xuICAgICAgICAgICAgLy9yZWFsbS5kb21haW5fbmFtZT0gcmVhbG0uZG9tYWluX25hbWUucmVwbGFjZSgvXFwuL2csICdfJyk7XG4gICAgICAgICAgICBfcmVhbG0gPSByZWFsbTtcbiAgICAgICAgICAgIGNvbW1vbi4kYnJvYWRjYXN0KGV2ZW50cy5yZWFsbUNoYW5nZWQsIHJlYWxtKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5jdXJyaWN1bGFcbiAqIEZBQ1RPUlk6IEN1cnJpY3VsdW1cbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmN1cnJpY3VsYScpXG4gICAgICAgIC5mYWN0b3J5KCdDdXJyaWN1bHVtJywgQ3VycmljdWx1bSk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBDdXJyaWN1bHVtKEhUVFBDYWNoZSkge1xuXG4gICAgICAgIHZhciBzZXJ2aWNlPSB7XG4gICAgICAgICAgICBnZXQ6IGdldCxcbiAgICAgICAgICAgIG9iamVjdGl2ZXM6IG9iamVjdGl2ZXNcbiAgICAgICAgfVxuXG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0KGNvdXJzZSkge1xuICAgICAgICAgICAgcmV0dXJuIEhUVFBDYWNoZS5vbmUoJy9jdXJyaWN1bGEnLCBjb3Vyc2UpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIG9iamVjdGl2ZXMoY291cnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0KGNvdXJzZSkuZ2V0TGlzdCgnb2JqZWN0aXZlcycpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5sYXlvdXRcbiAqIENPTlRST0xMRVI6IHNoZWxsXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubGF5b3V0JylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1NoZWxsQ29udHJvbGxlcicsIFNoZWxsQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBTaGVsbENvbnRyb2xsZXIoSW5pdCwgJHJvb3RTY29wZSwgY29uZmlnLCBQcm9maWxlU2VydmljZSwgbG9nZ2VyKSB7XG4gICAgICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLmJ1c3lNZXNzYWdlID0gJ0V2ZW4gZ2VkdWxkLi4uJztcbiAgICAgICAgdm0uaXNCdXN5ID0gdHJ1ZTtcbiAgICAgICAgdm0uc2hvd1NwbGFzaCA9IGZhbHNlO1xuICAgICAgICB2bS5hdmF0YXIgPSBudWxsO1xuICAgICAgICB2bS5wcm9maWxlID0ge307XG4gICAgICAgIHZtLmxvZ2dlZEluT3JnYW5pemF0aW9uID0gbnVsbDtcblxuICAgICAgICB2YXIgZXZlbnRzID0gY29uZmlnLmV2ZW50cztcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuICAgICAgICAvLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG5cbiAgICAgICAgICAgIGlmICghSW5pdC5pc0luaXRpYWxpemVkKCkpIHtcbiAgICAgICAgICAgICAgICB2bS5zaG93U3BsYXNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBJbml0LmluaXRpYWxpemluZyh0cnVlKTtcbiAgICAgICAgICAgICAgICBnZXRQcm9maWxlKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZtLnByb2ZpbGUgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB2bS5wcm9maWxlLmZ1bGxOYW1lID0gdm0ucHJvZmlsZS5maXJzdF9uYW1lICsgJyAnICsgdm0ucHJvZmlsZS5sYXN0X25hbWU7XG4gICAgICAgICAgICAgICAgICAgIC8vdm0ucHJvZmlsZS5vcmdhbml6YXRpb25zID0gcHJvZmlsZS5vcmdhbml6YXRpb25zO1xuXG4gICAgICAgICAgICAgICAgICAgIHZtLmF2YXRhciA9XG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5wcm9maWxlLmF2YXRhciB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgKHZtLnByb2ZpbGUuZ2VuZGVyID09PSAnRicgPyAnL2ltZy91c2VyL2ZlbWFsZS5wbmcnIDogJy9pbWcvdXNlci9tYWxlLnBuZycpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAnL2ltZy91c2VyL21hbGUucG5nJztcblxuICAgICAgICAgICAgICAgICAgICBpbml0aWFsaXplZCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0UHJvZmlsZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9maWxlU2VydmljZS5jdXJyZW50KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLnByb2ZpbGUgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHJldHVybiB2bS5wcm9maWxlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB0b2dnbGVTcGlubmVyKG9uKSB7XG4gICAgICAgICAgICB2bS5pc0J1c3kgPSBvbjtcbiAgICAgICAgfVxuXG4gICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsXG4gICAgICAgICAgICBmdW5jdGlvbiAoZXZlbnQsIG5leHQsIGN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICB0b2dnbGVTcGlubmVyKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgICRyb290U2NvcGUuJG9uKGV2ZW50cy5jb250cm9sbGVyQWN0aXZhdGVTdWNjZXNzLFxuICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB0b2dnbGVTcGlubmVyKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgJHJvb3RTY29wZS4kb24oZXZlbnRzLnJlYWxtQ2hhbmdlZCxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChzY29wZSwgcmVhbG0pIHtcbiAgICAgICAgICAgICAgICB2bS5yZWFsbSA9IHJlYWxtO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZWQoKSB7XG4gICAgICAgICAgICB2bS5zaG93U3BsYXNoID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCdXZWxrb20gJyArIHZtLnByb2ZpbGUuZmlyc3RfbmFtZSk7XG4gICAgICAgIH1cblxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBST1VURVM6IG5vdG9zcGx1cy5kYXNoYm9hcmRcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5kYXNoYm9hcmQnKVxuICAgICAgICAucnVuKGNvbmZpZ1JvdXRlcyk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWdSb3V0ZXMocm91dGVoZWxwZXIpIHtcbiAgICAgICAgcm91dGVoZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnaW5kZXgnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2luZGV4JyxcbiAgICAgICAgICAgICAgICAgICAgbmN5QnJlYWRjcnVtYjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdzdGFydCdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdpbmRleC5kYXNoYm9hcmQnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvZGFzaGJvYXJkJyxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2pzL21vZHVsZXMvZGFzaGJvYXJkL2Rhc2hib2FyZC5odG1sJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0Rhc2hib2FyZCcsXG4gICAgICAgICAgICAgICAgICAgIG5jeUJyZWFkY3J1bWI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRGFzaGJvYXJkJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH07XG59KSgpOyIsIi8qKlxuICogUk9VVEVTOiBub3Rvc3BsdXMubGlicmFyeVxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxpYnJhcnknKVxuICAgICAgICAucnVuKGNvbmZpZ1JvdXRlcyk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWdSb3V0ZXMocm91dGVoZWxwZXIpIHtcbiAgICAgICAgcm91dGVoZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGlicmFyeScsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvbGlicmFyeSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGlicmFyeS5ib29rcycsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9ib29rcycsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL2xpYnJhcnkvYm9va3MvYm9va3MuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdCb2VrZW4nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xpYnJhcnkud2Vic2l0ZXMnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvd2Vic2l0ZXMnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvbW9kdWxlcy9saWJyYXJ5L3dlYnNpdGVzL3dlYnNpdGVzLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdXZWJzaXRlc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1dlYnNpdGVzJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsaWJyYXJ5LndlYnNpdGVzLmRldGFpbCcsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy86aWQnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvbW9kdWxlcy9saWJyYXJ5L3dlYnNpdGVzL3dlYnNpdGVkZXRhaWwuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1dlYnNpdGVEZXRhaWxDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdXZWJzaXRlIGJld2Vya2VuJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsaWJyYXJ5LndlYnNpdGVzLmRldGFpbC5vYmplY3RpdmVzJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOicvb2JqZWN0aXZlcycsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL2N1cnJpY3VsYS9vYmplY3RpdmVzL3NlbGVjdF9vYmplY3RpdmVzLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZWxlY3RPYmplY3RpdmVzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9lbGVuIHNlbGVjdGVyZW4nXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfTtcbn0pKCk7IiwiLyoqXG4gKiBST1VURVM6IG5vdG9zcGx1cy5tYW5hZ2VcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5tYW5hZ2UnKVxuICAgICAgICAucnVuKGNvbmZpZ1JvdXRlcyk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWdSb3V0ZXMocm91dGVoZWxwZXIpIHtcbiAgICAgICAgcm91dGVoZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbWFuYWdlJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9tYW5hZ2UnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0JlaGVlcidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbWFuYWdlLnVzZXJzJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3VzZXJzJyxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2pzL21vZHVsZXMvbWFuYWdlL3VzZXJzL3VzZXJzLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdVc2Vyc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0dlYnJ1aWtlcnMnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ21hbmFnZS51c2Vycy5kZXRhaWwnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvOmlkJyxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2pzL21vZHVsZXMvbWFuYWdlL3VzZXJzL3VzZXJkZXRhaWwuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1VzZXJEZXRhaWxDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdHZWJydWlrZXIgYmV3ZXJrZW4nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH07XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLnRhZ3NcbiAqIEZBQ1RPUlk6IFRhZ1xuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMudGFncycpXG4gICAgICAgIC5mYWN0b3J5KCdUYWcnLCBUYWcpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gVGFnKEhUVFBDYWNoZSkge1xuICAgICAgICB2YXIgc2VydmljZSA9IEhUVFBDYWNoZS5zZXJ2aWNlKCd0YWdzJyk7XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICB9XG59KSgpOyIsIi8vIEluY2x1ZGUgaW4gaW5kZXguaHRtbCBzbyB0aGF0IGFwcCBsZXZlbCBleGNlcHRpb25zIGFyZSBoYW5kbGVkLlxuLy8gRXhjbHVkZSBmcm9tIHRlc3RSdW5uZXIuaHRtbCB3aGljaCBzaG91bGQgcnVuIGV4YWN0bHkgd2hhdCBpdCB3YW50cyB0byBydW5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxuICAgICAgICAucHJvdmlkZXIoJ2V4Y2VwdGlvbkhhbmRsZXInLCBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIpXG4gICAgICAgIC5jb25maWcoY29uZmlnKTtcblxuICAgIC8qKlxuICAgICAqIE11c3QgY29uZmlndXJlIHRoZSBleGNlcHRpb24gaGFuZGxpbmdcbiAgICAgKiBAcmV0dXJuIHtbdHlwZV19XG4gICAgICovXG4gICAgZnVuY3Rpb24gZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKCkge1xuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgICAgICAgdGhpcy5jb25maWcgPSB7XG4gICAgICAgICAgICBhcHBFcnJvclByZWZpeDogdW5kZWZpbmVkXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5jb25maWd1cmUgPSBmdW5jdGlvbiAoYXBwRXJyb3JQcmVmaXgpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmFwcEVycm9yUHJlZml4ID0gYXBwRXJyb3JQcmVmaXg7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4ge2NvbmZpZzogdGhpcy5jb25maWd9O1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbmZpZ3VyZSBieSBzZXR0aW5nIGFuIG9wdGlvbmFsIHN0cmluZyB2YWx1ZSBmb3IgYXBwRXJyb3JQcmVmaXguXG4gICAgICogQWNjZXNzaWJsZSB2aWEgY29uZmlnLmFwcEVycm9yUHJlZml4ICh2aWEgY29uZmlnIHZhbHVlKS5cbiAgICAgKiBAcGFyYW0gIHtbdHlwZV19ICRwcm92aWRlXG4gICAgICogQHJldHVybiB7W3R5cGVdfVxuICAgICAqIEBuZ0luamVjdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZygkcHJvdmlkZSkge1xuICAgICAgICAkcHJvdmlkZS5kZWNvcmF0b3IoJyRleGNlcHRpb25IYW5kbGVyJywgZXh0ZW5kRXhjZXB0aW9uSGFuZGxlcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0ZW5kIHRoZSAkZXhjZXB0aW9uSGFuZGxlciBzZXJ2aWNlIHRvIGFsc28gZGlzcGxheSBhIHRvYXN0LlxuICAgICAqIEBwYXJhbSAge09iamVjdH0gJGRlbGVnYXRlXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBleGNlcHRpb25IYW5kbGVyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBsb2dnZXJcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gdGhlIGRlY29yYXRlZCAkZXhjZXB0aW9uSGFuZGxlciBzZXJ2aWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXh0ZW5kRXhjZXB0aW9uSGFuZGxlcigkZGVsZWdhdGUsIGV4Y2VwdGlvbkhhbmRsZXIsIGxvZ2dlcikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZXhjZXB0aW9uLCBjYXVzZSkge1xuICAgICAgICAgICAgdmFyIGFwcEVycm9yUHJlZml4ID0gZXhjZXB0aW9uSGFuZGxlci5jb25maWcuYXBwRXJyb3JQcmVmaXggfHwgJyc7XG4gICAgICAgICAgICB2YXIgZXJyb3JEYXRhID0ge2V4Y2VwdGlvbjogZXhjZXB0aW9uLCBjYXVzZTogY2F1c2V9O1xuICAgICAgICAgICAgZXhjZXB0aW9uLm1lc3NhZ2UgPSBhcHBFcnJvclByZWZpeCArIGV4Y2VwdGlvbi5tZXNzYWdlO1xuICAgICAgICAgICAgJGRlbGVnYXRlKGV4Y2VwdGlvbiwgY2F1c2UpO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb3VsZCBhZGQgdGhlIGVycm9yIHRvIGEgc2VydmljZSdzIGNvbGxlY3Rpb24sXG4gICAgICAgICAgICAgKiBhZGQgZXJyb3JzIHRvICRyb290U2NvcGUsIGxvZyBlcnJvcnMgdG8gcmVtb3RlIHdlYiBzZXJ2ZXIsXG4gICAgICAgICAgICAgKiBvciBsb2cgbG9jYWxseS4gT3IgdGhyb3cgaGFyZC4gSXQgaXMgZW50aXJlbHkgdXAgdG8geW91LlxuICAgICAgICAgICAgICogdGhyb3cgZXhjZXB0aW9uO1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAgICAgKiAgICAgdGhyb3cgeyBtZXNzYWdlOiAnZXJyb3IgbWVzc2FnZSB3ZSBhZGRlZCcgfTtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGV4Y2VwdGlvbi5tZXNzYWdlLCBlcnJvckRhdGEpO1xuICAgICAgICB9O1xuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBibG9ja3MuZXhjZXB0aW9uXG4gKiBGQUNUT1JZOiBleGNlcHRpb25cbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicpXG4gICAgICAgIC5mYWN0b3J5KCdleGNlcHRpb24nLCBleGNlcHRpb24pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gZXhjZXB0aW9uKGxvZ2dlcikge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGNhdGNoZXI6IGNhdGNoZXJcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgZnVuY3Rpb24gY2F0Y2hlcihtZXNzYWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG1lc3NhZ2UsIHJlYXNvbik7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5yb3V0ZXJcbiAqIEZBQ1RPUlk6IHJvdXRlaGVscGVyXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInKVxuICAgICAgICAucHJvdmlkZXIoJ3JvdXRlaGVscGVyQ29uZmlnJywgcm91dGVoZWxwZXJDb25maWcpXG4gICAgICAgIC5mYWN0b3J5KCdyb3V0ZWhlbHBlcicsIHJvdXRlaGVscGVyKTtcblxuICAgIHJvdXRlaGVscGVyLiRpbmplY3QgPSBbJ3JvdXRlaGVscGVyQ29uZmlnJywgJyRyb290U2NvcGUnLCAnJHN0YXRlJ107XG5cbiAgICBmdW5jdGlvbiByb3V0ZWhlbHBlckNvbmZpZygpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHRoaXMuY29uZmlnID0ge307XG5cbiAgICAgICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjb25maWc6IHRoaXMuY29uZmlnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJvdXRlaGVscGVyKHJvdXRlaGVscGVyQ29uZmlnLCAkcm9vdFNjb3BlLCAkc3RhdGUpIHtcbiAgICAgICAgdmFyICR1cmxSb3V0ZXJQcm92aWRlciA9IHJvdXRlaGVscGVyQ29uZmlnLmNvbmZpZy4kdXJsUm91dGVyUHJvdmlkZXI7XG4gICAgICAgIHZhciAkc3RhdGVQcm92aWRlciA9IHJvdXRlaGVscGVyQ29uZmlnLmNvbmZpZy4kc3RhdGVQcm92aWRlcjtcblxuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGNvbmZpZ3VyZVN0YXRlczogY29uZmlndXJlU3RhdGVzLFxuICAgICAgICAgICAgc3RhdGVzOiBzdGF0ZXMsXG4gICAgICAgICAgICBnZXQ6IGdldFxuICAgICAgICB9O1xuXG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlU3RhdGVzKHN0YXRlcykge1xuICAgICAgICAgICAgc3RhdGVzLmZvckVhY2goZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmNvbmZpZy50aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5jb25maWcubmN5QnJlYWRjcnVtYiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBzdGF0ZS5jb25maWcudGl0bGUudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoc3RhdGUuc3RhdGUsIHN0YXRlLmNvbmZpZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHN0YXRlcygpIHtcbiAgICAgICAgICAgIHJldHVybiAkc3RhdGUuZ2V0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXQocGF0dGVybikge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICAgICAgICBzdGF0ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5uYW1lID09PSBwYXR0ZXJuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHN0YXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIHVwZGF0ZURvY1RpdGxlKCk7XG4gICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvaW5kZXgvZGFzaGJvYXJkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVEb2NUaXRsZSgpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJyxcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZXZlbnQsIGN1cnJlbnQsIHByZXZpb3VzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHJvdXRlaGVscGVyQ29uZmlnLmNvbmZpZy50aXRsZSArIChjdXJyZW50LnRpdGxlID8gJyB8ICcgKyBjdXJyZW50LnRpdGxlIDogJycpO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gdGl0bGU7IC8vIGRhdGEgYmluZCB0byA8dGl0bGU+XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJHN0YXRlID0gY3VycmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIi8qKlxuICogYmxvY2tzLmxvZ2dlclxuICogRkFDVE9SWTogbG9nZ2VyXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInKVxuICAgICAgICAuZmFjdG9yeSgnbG9nZ2VyJywgbG9nZ2VyKTtcblxuICAgIGxvZ2dlci4kaW5qZWN0ID0gWyckbG9nJywgJ3RvYXN0ciddO1xuXG4gICAgZnVuY3Rpb24gbG9nZ2VyKCRsb2csIHRvYXN0cikge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIHNob3dUb2FzdHM6IHRydWUsXG5cbiAgICAgICAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgICAgICAgIGluZm86IGluZm8sXG4gICAgICAgICAgICBzdWNjZXNzOiBzdWNjZXNzLFxuICAgICAgICAgICAgd2FybmluZzogd2FybmluZyxcblxuICAgICAgICAgICAgcmVtb3ZlZDogcmVtb3ZlZCxcbiAgICAgICAgICAgIHNhdmVkOiBzYXZlZCxcblxuICAgICAgICAgICAgLy8gc3RyYWlnaHQgdG8gY29uc29sZTsgYnlwYXNzIHRvYXN0clxuICAgICAgICAgICAgbG9nOiAkbG9nLmxvZ1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgdG9hc3RyLmVycm9yKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ0ZvdXQ6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluZm8obWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIHRvYXN0ci5pbmZvKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuaW5mbygnSW5mbzogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5pbmZvKCdTdWNjZXM6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cud2FybignTGV0IG9wOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVkKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICB0b2FzdHIud2FybmluZyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLndhcm4oJ1ZlcndpamRlcmQ6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVkKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmluZm8oJ0Jld2FhcmQ6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuY3VycmljdWxhXG4gKiBDT05UUk9MTEVSOiBTZWxlY3RPYmplY3RpdmVzQ29udHJvbGxlclxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmN1cnJpY3VsYScpXG4gICAgICAgIC5jb250cm9sbGVyKCdTZWxlY3RPYmplY3RpdmVzQ29udHJvbGxlcicsIFNlbGVjdE9iamVjdGl2ZXNDb250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFNlbGVjdE9iamVjdGl2ZXNDb250cm9sbGVyKGNvbW1vbiwgY29uZmlnLCBXZWJzaXRlRHJhZnQsIEN1cnJpY3VsdW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLCAkc2NvcGUsIFNlYXJjaFNpYmxpbmdzSW5jbHVkZWRGaWx0ZXIpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0ub2JqZWN0aXZlcyA9IFtdO1xuICAgICAgICB2bS5maWx0ZXJlZCA9IFtdO1xuICAgICAgICB2bS5zZWxlY3RlZEl0ZW1zID0gW107XG4gICAgICAgIHZtLndlYnNpdGUgPSBudWxsO1xuXG4gICAgICAgIHZtLnNhdmUgPSBzYXZlO1xuICAgICAgICB2bS5jYW5jZWwgPSBjYW5jZWw7XG4gICAgICAgIHZtLmNvbXBhcmVPYmplY3RpdmUgPSBjb21wYXJlT2JqZWN0aXZlO1xuXG4gICAgICAgIHZtLml0ZW1zUGVyUGFnZSA9IDEwO1xuICAgICAgICB2bS5jdXJyZW50UGFnZSA9IDE7XG4gICAgICAgIHZtLnRvdGFsSXRlbXMgPSAwO1xuXG4gICAgICAgIHZtLnNlYXJjaCA9ICcnO1xuXG4gICAgICAgIHZhciBldmVudHMgPSBjb25maWcuZXZlbnRzO1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG4gICAgICAgIC8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICAgICAgZ2V0SXRlbXMoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsb2FkRHJhZnQoKTtcbiAgICAgICAgICAgICAgICBjb21tb24uJGJyb2FkY2FzdChldmVudHMuY29udHJvbGxlckFjdGl2YXRlU3VjY2Vzcyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIFNlYXJjaCBmdW5jdGlvbnNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgJHNjb3BlLiR3YXRjaCgndm0uc2VhcmNoJywgZnVuY3Rpb24gKHRlcm0pIHtcbiAgICAgICAgICAgICAgICBpZiAodm0ub2JqZWN0aXZlcykge1xuICAgICAgICAgICAgICAgICAgICB2bS5maWx0ZXJlZCA9IFNlYXJjaFNpYmxpbmdzSW5jbHVkZWRGaWx0ZXIodm0ub2JqZWN0aXZlcywgdGVybSk7XG4gICAgICAgICAgICAgICAgICAgIHZtLnRvdGFsSXRlbXMgPSB2bS5maWx0ZXJlZC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRJdGVtcygpIHtcbiAgICAgICAgICAgIHJldHVybiBDdXJyaWN1bHVtLm9iamVjdGl2ZXMoJ3dpc2t1bmRlJykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLnRvdGFsSXRlbXMgPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0ub2JqZWN0aXZlcyA9IHZtLmZpbHRlcmVkID0gZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbG9hZERyYWZ0KCkge1xuICAgICAgICAgICAgdm0ud2Vic2l0ZSA9IFdlYnNpdGVEcmFmdC5sb2FkKCk7XG4gICAgICAgICAgICBpZiAodm0ud2Vic2l0ZSAmJiB2bS53ZWJzaXRlLm9iamVjdGl2ZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0uc2VsZWN0ZWRJdGVtcyA9IHZtLndlYnNpdGUub2JqZWN0aXZlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmVPYmplY3RpdmUobzEsIG8yKSB7XG4gICAgICAgICAgICByZXR1cm4gbzEuaWQgPT09IG8yLmlkO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZSgpIHtcbiAgICAgICAgICAgIHZtLndlYnNpdGUub2JqZWN0aXZlcyA9IHZtLnNlbGVjdGVkSXRlbXM7XG4gICAgICAgICAgICBXZWJzaXRlRHJhZnQuZHJhZnQodm0ud2Vic2l0ZSk7XG4gICAgICAgICAgICBnb3RvV2Vic2l0ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FuY2VsKCkge1xuICAgICAgICAgICAgZ290b1dlYnNpdGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdvdG9XZWJzaXRlKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdsaWJyYXJ5LndlYnNpdGVzLmRldGFpbCcsIHtpZDogdm0ud2Vic2l0ZS5pZH0pO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5kYXRhXG4gKiBGSUxURVI6IFNlYXJjaFNpYmxpbmdzSW5jbHVkZWRcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jdXJyaWN1bGEnKVxuICAgICAgICAuZmlsdGVyKCdTZWFyY2hTaWJsaW5nc0luY2x1ZGVkJywgU2VhcmNoU2libGluZ3NJbmNsdWRlZCk7XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNlYXJjaFNpYmxpbmdzSW5jbHVkZWQoKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoaW5wdXQsIHNlYXJjaFRleHQpIHtcblxuICAgICAgICAgICAgaWYgKHNlYXJjaFRleHQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgZlxuXG4gICAgICAgICAgICB2YXIgZmlsdGVyZWQgPSBbXSxcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZElkcyA9IFtdO1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGlucHV0LCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBsb3dlcl9jb2RlID0gYW5ndWxhci5sb3dlcmNhc2UoaXRlbS5jb2RlKTtcbiAgICAgICAgICAgICAgICB2YXIgbG93ZXJfbmFtZSA9IGFuZ3VsYXIubG93ZXJjYXNlKGl0ZW0ubmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIGxvd2VyX3NlYXJjaFRleHQgPSBhbmd1bGFyLmxvd2VyY2FzZShzZWFyY2hUZXh0KTtcblxuICAgICAgICAgICAgICAgIGlmIChsb3dlcl9uYW1lLmluZGV4T2YobG93ZXJfc2VhcmNoVGV4dCkgPiAtMSB8fFxuICAgICAgICAgICAgICAgICAgICBsb3dlcl9jb2RlLmluZGV4T2YobG93ZXJfc2VhcmNoVGV4dCkgPiAtMSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnBhcmVudF9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGlucHV0LCBmdW5jdGlvbiAocGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGl0ZW0uaWQgPT09IGl0ZW0ucGFyZW50X2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJlZElkcy5pbmRleE9mKHBpdGVtLmlkKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkLnB1c2gocGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRJZHMucHVzaChwaXRlbS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsdGVyZWRJZHMuaW5kZXhPZihpdGVtLmlkKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZElkcy5wdXNoKGl0ZW0uaWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXRlbS5wYXJlbnRfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpbnB1dCwgZnVuY3Rpb24gKGNoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGl0ZW0ucGFyZW50X2lkID09PSBpdGVtLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJlZElkcy5pbmRleE9mKGNoaXRlbS5pZCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZC5wdXNoKGNoaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZElkcy5wdXNoKGNoaXRlbS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyZWQ7XG4gICAgICAgIH1cblxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMud2Vic2l0ZXNcbiAqIEZJTFRFUjogU2VhcmNoV2Vic2l0ZXNcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5saWJyYXJ5JylcbiAgICAgICAgLmZpbHRlcignU2VhcmNoV2Vic2l0ZXMnLCBTZWFyY2hXZWJzaXRlcyk7XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNlYXJjaFdlYnNpdGVzKF8pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHdlYnNpdGVzLCB0ZXJtcykge1xuICAgICAgICAgICAgdGVybXMgPSB0ZXJtcy5zcGxpdCgnICcpO1xuICAgICAgICAgICAgcmV0dXJuIF8uc2VsZWN0KHdlYnNpdGVzLCBmdW5jdGlvbih3ZWJzaXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZSh0ZXJtcywgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXy5jb250YWlucyh3ZWJzaXRlLm5hbWUudG9Mb3dlckNhc2UoKSwgdC50b0xvd2VyQ2FzZSgpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgXy5jb250YWlucyh3ZWJzaXRlLnVybC50b0xvd2VyQ2FzZSgpLCB0LnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3MtcGx1cy5saWJyYXJ5XG4gKiBGQUNUT1JZOiBXZWJzaXRlRHJhZnRcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxpYnJhcnknKVxuICAgICAgICAuZmFjdG9yeSgnV2Vic2l0ZURyYWZ0JywgV2Vic2l0ZURyYWZ0KTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFdlYnNpdGVEcmFmdCgpIHtcbiAgICAgICAgdmFyIHdlYnNpdGUgPSBudWxsO1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgZHJhZnQ6IGRyYWZ0LFxuICAgICAgICAgICAgbG9hZDogbG9hZCxcbiAgICAgICAgICAgIGNsZWFyOiBjbGVhcixcbiAgICAgICAgICAgIHB1bGw6IHB1bGxcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGRyYWZ0KHdlYnNpdGUpIHtcbiAgICAgICAgICAgIHRoaXMud2Vic2l0ZSA9IHdlYnNpdGU7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gbG9hZCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndlYnNpdGU7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgICAgICAgICB0aGlzLndlYnNpdGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHB1bGwoKSB7XG4gICAgICAgICAgICB2YXIgdyA9IHRoaXMubG9hZCgpO1xuICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgICAgICAgcmV0dXJuIHc7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmxpYnJhcnlcbiAqIEZBQ1RPUlk6IFdlYnNpdGVcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxpYnJhcnknKVxuICAgICAgICAuZmFjdG9yeSgnV2Vic2l0ZScsIFdlYnNpdGUpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gV2Vic2l0ZShIVFRQQ2FjaGUpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSBIVFRQQ2FjaGUuc2VydmljZSgnL3dlYnNpdGVzJyk7XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5saWJyYXJ5XG4gKiBDT05UUk9MTEVSOiBXZWJzaXRlRGV0YWlsQ29udHJvbGxlclxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxpYnJhcnknKVxuICAgICAgICAuY29udHJvbGxlcignV2Vic2l0ZURldGFpbENvbnRyb2xsZXInLCBXZWJzaXRlRGV0YWlsQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBXZWJzaXRlRGV0YWlsQ29udHJvbGxlcigkc3RhdGUsICRzdGF0ZVBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tb24sIGNvbmZpZywgVGFnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdlYnNpdGUsIERpYWxvZywgV2Vic2l0ZURyYWZ0LCBfKSB7XG4gICAgICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2YXIgbG9nZ2VyID0gY29tbW9uLmxvZ2dlcjtcbiAgICAgICAgdmFyICRxID0gY29tbW9uLiRxO1xuICAgICAgICB2YXIgZXZlbnRzID0gY29uZmlnLmV2ZW50cztcblxuICAgICAgICB2bS5jYW5jZWwgPSBjYW5jZWw7XG4gICAgICAgIHZtLmhhc0NoYW5nZXMgPSBmYWxzZTtcbiAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB2bS5pc1NhdmluZyA9IGZhbHNlO1xuICAgICAgICB2bS5zYXZlID0gc2F2ZTtcbiAgICAgICAgdm0ucmVtb3ZlID0gcmVtb3ZlO1xuICAgICAgICB2bS5nb3RvT2JqZWN0aXZlcyA9IGdvdG9PYmplY3RpdmVzO1xuICAgICAgICB2bS53ZWJzaXRlID0gbnVsbDtcbiAgICAgICAgdm0ub2JqZWN0aXZlc19jaGFuZ2VkID0gZmFsc2U7XG5cbiAgICAgICAgdm0udGFncyA9IFtdO1xuICAgICAgICB2bS5sb2FkVGFncyA9IGxvYWRUYWdzO1xuXG5cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHZtLCAnY2FuU2F2ZScsIHtnZXQ6IGNhblNhdmV9KTtcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuICAgICAgICAvLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcblxuICAgICAgICAgICAgcHJlbG9hZFRhZ3MoKTtcbiAgICAgICAgICAgIGdldFJlcXVlc3RlZFdlYnNpdGUoKTtcblxuICAgICAgICAgICAgY29tbW9uLiRicm9hZGNhc3QoZXZlbnRzLmNvbnRyb2xsZXJBY3RpdmF0ZVN1Y2Nlc3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcHJlbG9hZFRhZ3MoKSB7XG4gICAgICAgICAgICByZXR1cm4gVGFnLmdldExpc3QoKS50aGVuKHRhZ3NDb21wbGV0ZWQpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB0YWdzQ29tcGxldGVkKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLnRhZ3MgPSByZXNwb25zZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGxvYWRUYWdzKHF1ZXJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gXy5zZWxlY3Qodm0udGFncywgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgcmV0dXJuIF8uY29udGFpbnModC5uYW1lLnRvTG93ZXJDYXNlKCksIHF1ZXJ5LnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjYW5jZWwoKSB7XG4gICAgICAgICAgICBnb3RvV2Vic2l0ZXMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNhblNhdmUoKSB7XG4gICAgICAgICAgICByZXR1cm4gIXZtLmlzU2F2aW5nO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0UmVxdWVzdGVkV2Vic2l0ZSgpIHtcbiAgICAgICAgICAgIHZtLmxvYWRpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBpZiAoV2Vic2l0ZURyYWZ0LmxvYWQoKSkge1xuICAgICAgICAgICAgICAgIHZtLndlYnNpdGUgPSBXZWJzaXRlRHJhZnQucHVsbCgpO1xuICAgICAgICAgICAgICAgIHZtLm9iamVjdGl2ZXNfY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiB2bS53ZWJzaXRlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdmFsID0gJHN0YXRlUGFyYW1zLmlkO1xuICAgICAgICAgICAgaWYgKHZhbCA9PT0gJ25ldycpIHtcbiAgICAgICAgICAgICAgICB2bS53ZWJzaXRlID0gV2Vic2l0ZS5vbmUoKTtcbiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdm0ud2Vic2l0ZTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBXZWJzaXRlLm9uZSh2YWwpLmdldCgpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLndlYnNpdGUgPSBkYXRhO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm0ud2Vic2l0ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKCdDb3VsZCBub3QgZmluZCB3ZWJzaXRlIGlkID0gJyArIHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnb3RvV2Vic2l0ZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRXJyb3Igd2hpbGUgZ2V0dGluZyB3ZWJzaXRlIGlkPSAnICsgdmFsICsgJzsgJyArIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgZ290b1dlYnNpdGVzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdvdG9XZWJzaXRlcygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnbGlicmFyeS53ZWJzaXRlcycpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZSgpIHtcbiAgICAgICAgICAgIGlmICghY2FuU2F2ZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRxLndoZW4obnVsbCk7XG4gICAgICAgICAgICB9IC8vIE11c3QgcmV0dXJuIGEgcHJvbWlzZVxuXG4gICAgICAgICAgICB2bS5pc1NhdmluZyA9IHRydWU7XG5cbiAgICAgICAgICAgIHJldHVybiB2bS53ZWJzaXRlLnNhdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2bS5pc1NhdmluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgZ290b1dlYnNpdGVzKCk7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB2bS5pc1NhdmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignS29uIHdlYnNpdGUgbmlldCBvcHNsYWFuLiBbJyArIGVycm9yICsgJ10nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgICAgICAgcmV0dXJuIERpYWxvZy5kZWxldGVEaWFsb2codm0ud2Vic2l0ZS5uYW1lICsgJyBbJyArIHZtLndlYnNpdGUudXJsICsgJ10nKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlbW92ZVdlYnNpdGUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZW1vdmVXZWJzaXRlKCkge1xuICAgICAgICAgICAgICAgIHZtLndlYnNpdGUucmVtb3ZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLndlYnNpdGUuY2xlYXJDYWNoZSgpO1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyh2bS53ZWJzaXRlLm5hbWUgKyAnIHdlcmQgbWV0IHN1Y2NlcyB2ZXJ3aWpkZXJkLicpO1xuICAgICAgICAgICAgICAgICAgICBnb3RvV2Vic2l0ZXMoKTtcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgRGlhbG9nLmNvbmZpcm1hdGlvbkRpYWxvZygnVmVyd2lqZGVyZW4gbWlzbHVrdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnSGV0IHZlcndpamRlcmVuIHZhbiAnICsgdm0ud2Vic2l0ZS5uYW1lICsgJyBpcyBtaXNsdWt0LiBQcm9iZWVyIGhldCBsYXRlciBvcG5pZXV3LicpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ290b09iamVjdGl2ZXMoKSB7XG4gICAgICAgICAgICBXZWJzaXRlRHJhZnQuZHJhZnQodm0ud2Vic2l0ZSk7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2xpYnJhcnkud2Vic2l0ZXMuZGV0YWlsLm9iamVjdGl2ZXMnKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5saWJyYXJ5XG4gKiBDT05UUk9MTEVSOiBXZWJzaXRlc0NvbnRyb2xsZXJcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5saWJyYXJ5JylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1dlYnNpdGVzQ29udHJvbGxlcicsIFdlYnNpdGVzQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBXZWJzaXRlc0NvbnRyb2xsZXIoY29tbW9uLCBjb25maWcsICRzdGF0ZSwgV2Vic2l0ZSwgJHNjb3BlLCBTZWFyY2hXZWJzaXRlc0ZpbHRlcikge1xuICAgICAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS53ZWJzaXRlcyA9IFtdO1xuICAgICAgICB2bS5maWx0ZXJlZFdlYnNpdGVzID0gW107XG4gICAgICAgIHZtLmdvdG9XZWJzaXRlID0gZ290b1dlYnNpdGU7XG5cbiAgICAgICAgdm0uZmlsdGVyID0ge1xuICAgICAgICAgICAgdGVybXM6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZXZlbnRzID0gY29uZmlnLmV2ZW50cztcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgICBjb21tb24uJGJyb2FkY2FzdChldmVudHMuY29udHJvbGxlckFjdGl2YXRlU3VjY2Vzcyk7XG4gICAgICAgICAgICBnZXRXZWJzaXRlcygpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0V2Vic2l0ZXMoZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICB2bS5sb2FkaW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgaWYgKGZvcmNlUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgIGlmICh2bS53ZWJzaXRlcykge1xuICAgICAgICAgICAgICAgICAgICB2bS53ZWJzaXRlcy5jbGVhckNhY2hlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgV2Vic2l0ZS5nZXRMaXN0KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLndlYnNpdGVzID0gdm0uZmlsdGVyZWRXZWJzaXRlcyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiB2bS53ZWJzaXRlcztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ290b1dlYnNpdGUod2Vic2l0ZSkge1xuICAgICAgICAgICAgaWYgKHdlYnNpdGUgJiYgd2Vic2l0ZS5pZCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnbGlicmFyeS53ZWJzaXRlcy5kZXRhaWwnLCB7aWQ6IHdlYnNpdGUuaWR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ3ZtLmZpbHRlcicsIGRvRmlsdGVyLCB0cnVlKTtcblxuICAgICAgICBmdW5jdGlvbiBkb0ZpbHRlcigpIHtcbiAgICAgICAgICAgIGlmICh2bS5maWx0ZXIudGVybXMgJiYgdm0uZmlsdGVyLnRlcm1zICE9PSAnJykge1xuICAgICAgICAgICAgICAgIHZtLmZpbHRlcmVkV2Vic2l0ZXMgPSBTZWFyY2hXZWJzaXRlc0ZpbHRlcih2bS53ZWJzaXRlcywgdm0uZmlsdGVyLnRlcm1zKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdm0uZmlsdGVyZWRXZWJzaXRlcyA9IHZtLndlYnNpdGVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcbi8qXG4gaWYgKF8uc29tZSh0ZXJtcywgZnVuY3Rpb24gKHQpIHtcbiByZXR1cm4gbmFtZUNvbnRhaW5zVGVybSh3ZWJzaXRlLm5hbWUsIHQpIHx8XG4gZGVzY3JpcHRpb25Db250YWluc1Rlcm0od2Vic2l0ZS5kZXNjcmlwdGlvbiwgdCkgfHxcbiBvYmplY3RpdmVzQ29udGFpbnNUZXJtKHdlYnNpdGUub2JqZWN0aXZlcywgdCk7XG4gfSkpIHtcbiBhZGRVbmlxdWUod2Vic2l0ZSwgZmlsdGVyZWQpO1xuIH1cblxuICovIiwiLyoqXG4gKiBub3Rvc3BsdXMubWFuYWdlXG4gKiBGQUNUT1JZOiBVc2VyXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5tYW5hZ2UnKVxuICAgICAgICAuZmFjdG9yeSgnVXNlcicsIFVzZXIpO1xuXG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBVc2VyKEhUVFBDYWNoZSwgUHJvZmlsZVNlcnZpY2UpIHtcblxuICAgICAgICB2YXIgc2VydmljZSA9IEhUVFBDYWNoZS5zZXJ2aWNlKCcvb3JnYW5pemF0aW9uLycgKyBQcm9maWxlU2VydmljZS5yZWFsbSgpLmlkICsgJy91c2VyJyk7XG5cblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLm1hbmFnZVxuICogQ09OVFJPTExFUjogVXNlckFkZENvbnRyb2xsZXJcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5tYW5hZ2UnKVxuICAgICAgICAuY29udHJvbGxlcignVXNlckRldGFpbENvbnRyb2xsZXInLCBVc2VyRGV0YWlsQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBVc2VyRGV0YWlsQ29udHJvbGxlcigkc3RhdGUsICRzdGF0ZVBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tb24sIGNvbmZpZywgVXNlciwgRGlhbG9nLCBQcm9maWxlU2VydmljZSkge1xuICAgICAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdmFyIGxvZ2dlciA9IGNvbW1vbi5sb2dnZXI7XG4gICAgICAgIHZhciAkcSA9IGNvbW1vbi4kcTtcbiAgICAgICAgdmFyIGV2ZW50cyA9IGNvbmZpZy5ldmVudHM7XG5cblxuICAgICAgICB2bS5jYW5jZWwgPSBjYW5jZWw7XG4gICAgICAgIHZtLmhhc0NoYW5nZXMgPSBmYWxzZTtcbiAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB2bS5pc1NhdmluZyA9IGZhbHNlO1xuICAgICAgICB2bS5pc1Jlc2V0UHdkID0gZmFsc2U7XG4gICAgICAgIHZtLnJlc2V0UHdkID0gcmVzZXRQYXNzd29yZDtcbiAgICAgICAgdm0uc2F2ZSA9IHNhdmU7XG4gICAgICAgIHZtLnJlbW92ZSA9IHJlbW92ZTtcbiAgICAgICAgdm0udXNlciA9IG51bGw7XG4gICAgICAgIHZtLnVzZXJzID0gW107XG4gICAgICAgIHZtLmRlZmF1bHRVc2VybmFtZSA9IGRlZmF1bHRVc2VybmFtZTtcbiAgICAgICAgdm0uZGVmYXVsdERvbWFpbiA9IFByb2ZpbGVTZXJ2aWNlLmN1cnJlbnQoKS5kb21haW5fbmFtZTtcblxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodm0sICdjYW5TYXZlJywge2dldDogY2FuU2F2ZX0pO1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgICAvL29uRGVzdHJveSgpO1xuICAgICAgICAgICAgLy9vbkhhc0NoYW5nZXMoKTtcblxuICAgICAgICAgICAgZ2V0UmVxdWVzdGVkVXNlcigpO1xuXG4gICAgICAgICAgICBjb21tb24uJGJyb2FkY2FzdChldmVudHMuY29udHJvbGxlckFjdGl2YXRlU3VjY2Vzcyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjYW5jZWwoKSB7XG4gICAgICAgICAgICBnb1RvVXNlcnMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNhblNhdmUoKSB7XG4gICAgICAgICAgICByZXR1cm4gIXZtLmlzU2F2aW5nO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0UmVxdWVzdGVkVXNlcigpIHtcbiAgICAgICAgICAgIHZtLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHZhbCA9ICRzdGF0ZVBhcmFtcy5pZDtcbiAgICAgICAgICAgIGlmICh2YWwgPT09ICduZXcnKSB7XG4gICAgICAgICAgICAgICAgdm0udXNlciA9IFVzZXIub25lKCk7XG4gICAgICAgICAgICAgICAgdm0uaXNSZXNldFB3ZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLnVzZXI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFVzZXIub25lKHZhbCkuZ2V0KClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdm0udXNlciA9IGRhdGE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2bS51c2VyO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZygnQ291bGQgbm90IGZpbmQgdXNlciBpZCA9ICcgKyB2YWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ29Ub1VzZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHdoaWxlIGdldHRpbmcgdXNlciBpZCA9ICcgKyB2YWwgKyAnOyAnICsgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICBnb1RvVXNlcnMoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdvVG9Vc2VycygpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnbWFuYWdlLnVzZXJzJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzYXZlKCkge1xuXG4gICAgICAgICAgICBpZiAoIWNhblNhdmUoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAkcS53aGVuKG51bGwpO1xuICAgICAgICAgICAgfSAvLyBNdXN0IHJldHVybiBhIHByb21pc2VcblxuICAgICAgICAgICAgdm0uaXNTYXZpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICByZXR1cm4gdm0udXNlci5zYXZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdm0uaXNTYXZpbmcgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGdvVG9Vc2VycygpO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdm0uaXNTYXZpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0tvbiBnZWJydWlrZXIgbmlldCBvcHNsYWFuLiBbJyArIGVycm9yICsgJ10nKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZXNldFBhc3N3b3JkKCkge1xuICAgICAgICAgICAgcmV0dXJuIERpYWxvZy5yZXNldFBhc3N3b3JkRGlhbG9nKClcbiAgICAgICAgICAgICAgICAudGhlbihwYXRjaFJlc2V0dGVkUGFzc3dvcmQpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBwYXRjaFJlc2V0dGVkUGFzc3dvcmQoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLnVzZXIub25lKCdwYXNzd29yZCcpLnBhdGNoKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHBhc3N3b3JkV2FzUmVzZXR0ZWQpO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gcGFzc3dvcmRXYXNSZXNldHRlZCh1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1vbi5sb2dnZXIuaW5mbygnUGFzd29vcmQgb3BuaWV1dyBpbmdlc3RlbGQgdm9vciAnICsgdXNlci5mdWxsX25hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBEaWFsb2cuZGVsZXRlRGlhbG9nKHZtLnVzZXIuZnVsbF9uYW1lKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlbW92ZVVzZXIpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiByZW1vdmVVc2VyKCkge1xuICAgICAgICAgICAgICAgIHZtLnVzZXIucmVtb3ZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLnVzZXIuY2xlYXJDYWNoZSgpO1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyh2bS51c2VyLmZ1bGxfbmFtZSArICcgd2VyZCBtZXQgc3VjY2VzIHZlcndpamRlcmQuJyk7XG4gICAgICAgICAgICAgICAgICAgIGdvVG9Vc2VycygpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBEaWFsb2cuY29uZmlybWF0aW9uRGlhbG9nKCdWZXJ3aWpkZXJlbiBtaXNsdWt0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdIZXQgdmVyd2lqZGVyZW4gdmFuICcgKyB2bS51c2VyLmZ1bGxfbmFtZSArICcgaXMgbWlzbHVrdC4gUHJvYmVlciBoZXQgbGF0ZXIgb3BuaWV1dy4nKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGRlZmF1bHRVc2VybmFtZSgpIHtcbiAgICAgICAgICAgIGlmKHZtLnVzZXIudXNlcm5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0udXNlci51c2VybmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2bS51c2VyLmZpcnN0XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLm1hbmFnZVxuICogQ09OVFJPTExFUjogVXNlcnNDb250cm9sbGVyXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubWFuYWdlJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1VzZXJzQ29udHJvbGxlcicsIFVzZXJzQ29udHJvbGxlcik7XG5cblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFVzZXJzQ29udHJvbGxlcigkc3RhdGUsIGNvbmZpZywgY29tbW9uLCBVc2VyKSB7XG4gICAgICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZhciBrZXlDb2RlcyA9IGNvbmZpZy5rZXlDb2RlcztcbiAgICAgICAgdmFyIGV2ZW50cyA9IGNvbmZpZy5ldmVudHM7XG5cbiAgICAgICAgdm0uZmlsdGVyZWRVc2VycyA9IFtdO1xuICAgICAgICB2bS5nb3RvVXNlciA9IGdvdG9Vc2VyO1xuICAgICAgICB2bS5yZWZyZXNoID0gcmVmcmVzaDtcbiAgICAgICAgdm0uc2VhcmNoID0gc2VhcmNoO1xuICAgICAgICB2bS51c2VyU2VhcmNoID0gJyc7XG4gICAgICAgIHZtLnVzZXJzID0gW107XG5cblxuICAgICAgICBhY3RpdmF0ZSgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICAgICAgY29tbW9uLiRicm9hZGNhc3QoZXZlbnRzLmNvbnRyb2xsZXJBY3RpdmF0ZVN1Y2Nlc3MpO1xuICAgICAgICAgICAgZ2V0VXNlcnMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFwcGx5RmlsdGVyKCkge1xuICAgICAgICAgICAgdm0uZmlsdGVyZWRVc2VycyA9IHZtLnVzZXJzLmZpbHRlcih1c2VyRmlsdGVyKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlcnMoZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICB2bS5sb2FkaW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgaWYgKGZvcmNlUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgIGlmICh2bS51c2Vycykge1xuICAgICAgICAgICAgICAgICAgICB2bS51c2Vycy5jbGVhckNhY2hlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgVXNlci5nZXRMaXN0KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLnVzZXJzID0gdm0uZmlsdGVyZWRVc2VycyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLnVzZXJzO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuXG4gICAgICAgIGZ1bmN0aW9uIGdvdG9Vc2VyKHVzZXIpIHtcbiAgICAgICAgICAgIGlmICh1c2VyICYmIHVzZXIuaWQpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ21hbmFnZS51c2Vycy5kZXRhaWwnLCB7aWQ6IHVzZXIuaWR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlZnJlc2goKSB7XG4gICAgICAgICAgICB2bS51c2VyU2VhcmNoID0gJyc7XG4gICAgICAgICAgICBnZXRVc2Vycyh0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNlYXJjaCgkZXZlbnQpIHtcbiAgICAgICAgICAgIGlmICgkZXZlbnQua2V5Q29kZSA9PT0ga2V5Q29kZXMuZXNjKSB7XG4gICAgICAgICAgICAgICAgdm0udXNlclNlYXJjaCA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXBwbHlGaWx0ZXIoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVzZXJGaWx0ZXIodXNlcikge1xuICAgICAgICAgICAgdmFyIGlzTWF0Y2ggPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHZtLnVzZXJTZWFyY2gpIHtcbiAgICAgICAgICAgICAgICBpc01hdGNoID0gY29tbW9uLnRleHRDb250YWlucyh1c2VyLm5hbWUsIHZtLnVzZXJTZWFyY2gpO1xuICAgICAgICAgICAgICAgIGlzTWF0Y2ggfD0gY29tbW9uLnRleHRDb250YWlucyh1c2VyLnVzZXJuYW1lLCB2bS51c2VyU2VhcmNoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGlzTWF0Y2g7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLndpZGdldHNcbiAqIERJUkVDVElWRTogbnRGYVxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLndpZGdldHMnKVxuICAgICAgICAuZGlyZWN0aXZlKCdudEZhJywgbnRGYSk7XG5cbiAgICBudEZhLiRpbmplY3QgPSBbXTtcblxuICAgIGZ1bmN0aW9uIG50RmEoKSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgbGluazogbGlua0Z1bmNcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICB2YXIgaSA9IGFuZ3VsYXIuZWxlbWVudCgnPGkgY2xhc3M9XCJmYVwiIC8+Jyk7XG4gICAgICAgICAgICB2YXIgY2xhc3NlcyA9IGF0dHJzLm5hbWUuc3BsaXQoJyAnKTtcblxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGNsYXNzZXMsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGkuYWRkQ2xhc3MoJ2ZhLScgKyB2YWx1ZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZWxlbWVudC5yZXBsYWNlV2l0aChpKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbiIsIi8qKlxuICogbm90b3NwbHVzLndpZGdldHNcbiAqIERJUkVDVElWRTogbnRTcGlubmVyXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMud2lkZ2V0cycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ250U3Bpbm5lcicsIG50U3Bpbm5lcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBudFNwaW5uZXIoKSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgICAgICAgIGNvbXBpbGU6IGNvbXBpbGVcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgIGZ1bmN0aW9uIGNvbXBpbGUoZWxlbSwgYXR0cnMpIHtcbiAgICAgICAgICAgIGlmIChlbGVtWzBdLnRhZ05hbWUgPT09ICdUQUJMRScpIHtcbiAgICAgICAgICAgICAgICBhZGRTcGlubmVyVG9UQm9keShlbGVtLCBhdHRycyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGFkZFNwaW5uZXJUb0VsZW1lbnQoZWxlbSwgYXR0cnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYWRkU3Bpbm5lclRvVEJvZHkoZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHZhciB0Ym9keSA9IGVsZW1lbnQuZmluZCgndGJvZHknKTtcbiAgICAgICAgICAgIHZhciBodG1sID0gWyc8dHIgbmctc2hvdz1cIicgKyBhdHRycy5zcGlubmVyU2hvdyArICdcIj4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8dGQgJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGF0dHJzLmhhc093blByb3BlcnR5KCdjb2xzcGFuJykgPyAnY29sc3Bhbj1cIicgKyBhdHRycy5jb2xzcGFuICsgJ1wiICcgOiAnJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT1cInRleHQtYWxpZ246Y2VudGVyXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3JjPVwiL2ltZy9idXN5L2J1c3lhdG9tLmdpZlwiIHN0eWxlPVwid2lkdGg6NDBweDtoZWlnaHQ6NDBweDtcIj4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L3RkPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPC90cj4nXS5qb2luKCcnKTtcblxuICAgICAgICAgICAgdGJvZHkucHJlcGVuZChodG1sKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBhZGRTcGlubmVyVG9FbGVtZW50KGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICB2YXIgaHRtbCA9IFsnPGRpdiBuZy1zaG93PVwiJyArIGF0dHJzLnNwaW5uZXJTaG93ICsgJ1wiIGNsYXNzPVwiY29sLW1kLTEyIHRleHQtY2VudGVyXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3JjPVwiL2ltZy9idXN5L2J1c3lhdG9tLmdpZlwiIHN0eWxlPVwid2lkdGg6NDBweDtoZWlnaHQ6NDBweDtcIj4nLFxuICAgICAgICAgICAgICAgICc8L2Rpdj4nLFxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY2xlYXJmaXhcIj48L2Rpdj4nXS5qb2luKCcnKTtcblxuICAgICAgICAgICAgZWxlbWVudC5wcmVwZW5kKGh0bWwpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuIiwiLyoqXG4gKiBub3Rvc3BsdXMud2lkZ2V0c1xuICogRkFDVE9SWTogc3Bpbm5lclNlcnZpY2VcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLndpZGdldHMnKVxuICAgICAgICAuZmFjdG9yeSgnc3Bpbm5lclNlcnZpY2UnLCBzcGlubmVyU2VydmljZSk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBzcGlubmVyU2VydmljZSgpIHtcbiAgICAgICAgdmFyIHNwaW5uZXJzID0ge307XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgX3JlZ2lzdGVyOiByZWdpc3RlcixcbiAgICAgICAgICAgIF91bnJlZ2lzdGVyOiB1bnJlZ2lzdGVyLFxuICAgICAgICAgICAgX3VucmVnaXN0ZXJBbGw6IHVucmVnaXN0ZXJBbGwsXG4gICAgICAgICAgICBzaG93OiBzaG93LFxuICAgICAgICAgICAgaGlkZTogaGlkZSxcbiAgICAgICAgICAgIHNob3dHcm91cDogc2hvd0dyb3VwLFxuICAgICAgICAgICAgaGlkZUdyb3VwOiBoaWRlR3JvdXAsXG4gICAgICAgICAgICBzaG93QWxsOiBzaG93QWxsLFxuICAgICAgICAgICAgaGlkZUFsbDogaGlkZUFsbFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vXG4gICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyKGRhdGEpIHtcbiAgICAgICAgICAgIGlmKCFkYXRhLmhhc093blByb3BlcnR5KCduYW1lJykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NwaW5uZXIgbXVzdCBzcGVjaWZ5IGEgbmFtZSB3aGVuIHJlZ2lzdGVyaW5nIHdpdGggdGhlIHNwaW5uZXIgc2VydmljZS4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHNwaW5uZXJzLmhhc093blByb3BlcnR5KGRhdGEubmFtZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Egc3Bpbm5lciB3aXRoIHRoZSBuYW1lIFwiJyArIGRhdGEubmFtZSArICdcIiBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzcGlubmVyc1tkYXRhLm5hbWVdID0gZGF0YTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVucmVnaXN0ZXIobmFtZSkge1xuICAgICAgICAgICAgaWYoc3Bpbm5lcnMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgc3Bpbm5lcnNbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1bnJlZ2lzdGVyQWxsKCkge1xuICAgICAgICAgICAgZm9yKHZhciBuYW1lIGluIHNwaW5uZXJzKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNwaW5uZXJzW25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2hvdyhuYW1lKSB7XG4gICAgICAgICAgICB2YXIgc3Bpbm5lciAgPSBzcGlubmVyc1tuYW1lXTtcbiAgICAgICAgICAgIGlmKCFzcGlubmVyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgIG5ldyBFcnJvcignTm8gc3Bpbm5lciBuYW1lZCBcIicgKyBuYW1lICsgJ1wiIGlzIHJlZ2lzdGVyZWQuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzcGlubmVyLnNob3coKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGhpZGUobmFtZSkge1xuICAgICAgICAgICAgdmFyIHNwaW5uZXIgID0gc3Bpbm5lcnNbbmFtZV07XG4gICAgICAgICAgICBpZighc3Bpbm5lcikge1xuICAgICAgICAgICAgICAgIHRocm93ICBuZXcgRXJyb3IoJ05vIHNwaW5uZXIgbmFtZWQgXCInICsgbmFtZSArICdcIiBpcyByZWdpc3RlcmVkLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzaG93R3JvdXAoZ3JvdXApIHtcbiAgICAgICAgICAgIHZhciBncm91cEV4aXN0cyA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yKHZhciBuYW1lIGluIHNwaW5uZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwaW5uZXIgPSBzcGlubmVyc1tuYW1lXTtcbiAgICAgICAgICAgICAgICBpZihzcGlubmVyLmdyb3VwID09PSBncm91cCkge1xuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBFeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKCFncm91cEV4aXN0cykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc3Bpbm5lcnMgZm91bmQgd2l0aCBncm91cCBcIicgKyBncm91cCArICdcIi4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBoaWRlR3JvdXAoZ3JvdXApIHtcbiAgICAgICAgICAgIHZhciBncm91cEV4aXN0cyA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yKHZhciBuYW1lIGluIHNwaW5uZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwaW5uZXIgPSBzcGlubmVyc1tuYW1lXTtcbiAgICAgICAgICAgICAgICBpZihzcGlubmVyLmdyb3VwID09PSBncm91cCkge1xuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBFeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKCFncm91cEV4aXN0cykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc3Bpbm5lcnMgZm91bmQgd2l0aCBncm91cCBcIicgKyBncm91cCArICdcIi4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzaG93QWxsKCkge1xuICAgICAgICAgICAgZm9yKHZhciBuYW1lIGluIHNwaW5uZXJzKSB7XG4gICAgICAgICAgICAgICAgc3Bpbm5lcnNbbmFtZV0uc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhpZGVBbGwoKSB7XG4gICAgICAgICAgICBmb3IodmFyIG5hbWUgaW4gc3Bpbm5lcnMpIHtcbiAgICAgICAgICAgICAgICBzcGlubmVyc1tuYW1lXS5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLndpZGdldHNcbiAqIERJUkVDVElWRTogbnRNaW5pU2lkZUJhclxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLndpZGdldHMnKVxuICAgICAgICAuZGlyZWN0aXZlKCdudE1pbmlTaWRlYmFyJywgbnRNaW5pU2lkZWJhcik7XG5cbiAgICBmdW5jdGlvbiBudE1pbmlTaWRlYmFyKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiBbXG4gICAgICAgICAgICAgICAgJzxhIGNsYXNzPVwibmF2YmFyLW1pbmltYWxpemUgbWluaW1hbGl6ZS1zdHlsLTIgYnRuIGJ0bi1wcmltYXJ5XCIgaHJlZj1cIlwiIG5nLWNsaWNrPVwidm0ubWluaW1hbGl6ZSgpXCI+JyxcbiAgICAgICAgICAgICAgICAnPGkgY2xhc3M9XCJmYSBmYS1iYXJzXCI+PC9pPicsXG4gICAgICAgICAgICAgICAgJzwvYT4nXG4gICAgICAgICAgICBdLmpvaW4oJycpLFxuXG4gICAgICAgICAgICBjb250cm9sbGVyOiBNaW5pbWl6ZUNvbnRyb2xsZXIsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlIC8vIGJlY2F1c2UgdGhlIHNjb3BlIGlzIGlzb2xhdGVkXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIC8qIEBuZ0luamVjdCAqL1xuICAgICAgICBmdW5jdGlvbiBNaW5pbWl6ZUNvbnRyb2xsZXIoJHRpbWVvdXQpIHtcbiAgICAgICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgICAgICB2bS5taW5pbWFsaXplID0gbWluaW1hbGl6ZTtcblxuICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAgICAgZnVuY3Rpb24gbWluaW1hbGl6ZSgpIHtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJ2JvZHknKS50b2dnbGVDbGFzcygnbWluaS1uYXZiYXInKTtcbiAgICAgICAgICAgICAgICBpZiAoIWFuZ3VsYXIuZWxlbWVudCgnYm9keScpLmhhc0NsYXNzKCdtaW5pLW5hdmJhcicpIHx8IGFuZ3VsYXIuZWxlbWVudCgnYm9keScpLmhhc0NsYXNzKCdib2R5LXNtYWxsJykpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSGlkZSBtZW51IGluIG9yZGVyIHRvIHNtb290aGx5IHR1cm4gb24gd2hlbiBtYXhpbWl6ZSBtZW51XG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnI3NpZGUtbWVudScpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yIHNtb290aGx5IHR1cm4gb24gbWVudVxuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJyNzaWRlLW1lbnUnKS5mYWRlSW4oNTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhbmd1bGFyLmVsZW1lbnQoJ2JvZHknKS5oYXNDbGFzcygnZml4ZWQtc2lkZWJhcicpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnI3NpZGUtbWVudScpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCcjc2lkZS1tZW51JykuZmFkZUluKDUwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBhbGwgaW5saW5lIHN0eWxlIGZyb20ganF1ZXJ5IGZhZGVJbiBmdW5jdGlvbiB0byByZXNldCBtZW51IHN0YXRlXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnI3NpZGUtbWVudScpLnJlbW92ZUF0dHIoJ3N0eWxlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuIiwiLyoqXG4gKiBub3Rvc3BsdXMud2lkZ2V0c1xuICogRElSRUNUSVZFOiBudFBhZ2luYXRpb25cbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy53aWRnZXRzJylcbiAgICAgICAgLmRpcmVjdGl2ZSgnbnRQYWdpbmF0aW9uJywgbnRQYWdpbmF0aW9uKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIG50UGFnaW5hdGlvbigkY29tcGlsZSkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIHRvdGFsSXRlbXM6ICc9JyxcbiAgICAgICAgICAgICAgICBpdGVtc1BlclBhZ2U6ICc9JyxcbiAgICAgICAgICAgICAgICBjdXJyZW50UGFnZTogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGluazogbGlua0Z1bmMsXG4gICAgICAgICAgICBjb250cm9sbGVyOiBQYWdpbmF0ZUNvbnRyb2xsZXIsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlIC8vIGJlY2F1c2UgdGhlIHNjb3BlIGlzIGlzb2xhdGVkXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmtGdW5jKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgdmFyIHBhZ2luYXRpb24gPSBhbmd1bGFyLmVsZW1lbnQoJzxwYWdpbmF0aW9uIC8+JylcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1ib3VuZGFyeS1saW5rcycsIHRydWUpO1xuICAgICAgICAgICAgcGFnaW5hdGlvbi5hdHRyKCdkYXRhLXRvdGFsLWl0ZW1zJywgJ3RvdGFsSXRlbXMnKTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1pdGVtcy1wZXItcGFnZScsICdpdGVtc1BlclBhZ2UnKTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1tYXgtc2l6ZScsIDUpO1xuICAgICAgICAgICAgcGFnaW5hdGlvbi5hdHRyKCdkYXRhLW5nLW1vZGVsJywgJ2N1cnJlbnRQYWdlJyk7XG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtcHJldmlvdXMtdGV4dCcsICfigLknKTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1uZXh0LXRleHQnLCAn4oC6Jyk7XG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtZmlyc3QtdGV4dCcsICfCqycpO1xuICAgICAgICAgICAgcGFnaW5hdGlvbi5hdHRyKCdkYXRhLWxhc3QtdGV4dCcsICfCuycpO1xuICAgICAgICAgICAgcGFnaW5hdGlvbi5hdHRyKCdkYXRhLW5nLWhpZGUnLCAnaGlkZScpO1xuICAgICAgICAgICAgaWYgKGF0dHJzWydjbGFzcyddKSB7XG4gICAgICAgICAgICAgICAgcGFnaW5hdGlvbi5hdHRyKCdjbGFzcycsIGF0dHJzWydjbGFzcyddKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJGNvbXBpbGUocGFnaW5hdGlvbikoc2NvcGUpO1xuICAgICAgICAgICAgZWxlbWVudC5yZXBsYWNlV2l0aChwYWdpbmF0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIEBuZ0luamVjdCAqL1xuICAgICAgICBmdW5jdGlvbiBQYWdpbmF0ZUNvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgICAgICB2bS5oaWRlID0gZmFsc2U7XG4gICAgICAgICAgICB2bS5pdGVtc1BlclBhZ2UgPSAxMDtcbiAgICAgICAgICAgIHZtLmN1cnJlbnRQZ2UgPSAwO1xuXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCd2bS50b3RhbEl0ZW1zJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZtLmhpZGUgPSAodm0udG90YWxJdGVtcyA8PSB2bS5pdGVtc1BlclBhZ2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG4iLCIvKipcbiAqIG5vdG9zcGx1c1xuICogRElSRUNUSVZFOiBudFNpZGVOYXZpZ2F0aW9uXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMud2lkZ2V0cycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ250U2lkZU5hdmlnYXRpb24nLCBudFNpZGVOYXZpZ2F0aW9uKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIG50U2lkZU5hdmlnYXRpb24oJHRpbWVvdXQpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgbGluazogbGlua0Z1bmNcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLm1ldGlzTWVudSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuXG4iLCIvKipcbiAqIG5vdG9zcGx1cy53aWRnZXRzXG4gKiBGSUxURVI6IG9mZnNldFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLndpZGdldHMnKVxuICAgICAgICAuZmlsdGVyKCdvZmZzZXQnLCBmaWx0ZXIpO1xuXG5cbiAgICBmdW5jdGlvbiBmaWx0ZXIoKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBvZmZzZXQoaW5wdXQsIHN0YXJ0KSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQpIHtcbiAgICAgICAgICAgICAgICBzdGFydCA9IHBhcnNlSW50KHN0YXJ0LCAxMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlucHV0LnNsaWNlKHN0YXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==