(function() {
    'use strict';

    angular
        .module('notosplus', [
            //shared modules
            'notosplus.core',
            'notosplus.widgets',
            'notosplus.auth',
            'notosplus.data',
            'notosplus.layout',

            //app modules
            'notosplus.dashboard',
            'notosplus.manage',
            'notosplus.library'
        ]);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.auth', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.data', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.layout', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.library', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.manage', []);
})();
(function () {
    'use strict';

    angular
        .module('notosplus.widgets', []);
})();

angular
    .module('notosplus.core', [
        //Angular
        'ngAnimate', 'ngSanitize', 'ngResource',

        //3rd party
        'ui.bootstrap',
        'ncy-angular-breadcrumb',
        'breeze.angular',   // tells breeze to use $q instead of Q.js
        'breeze.directives',// breeze validation directive (zValidate),
        'ngzWip',
        'ngplus',
        'restangular',
        'checklist-model',

        //cross app modules
        'blocks.exception',
        'blocks.logger',
        'blocks.router'
    ]);
(function () {
    'use strict';

    angular
        .module('notosplus.dashboard', [

        ]);
})();
(function () {
    'use strict';

    angular
        .module('blocks.exception', ['blocks.logger']);
})();
(function () {
    'use strict';

    angular
        .module('blocks.logger', []);
})();
(function () {
    'use strict';

    angular
        .module('blocks.router', [
            'ui.router'
        ]);
})();
/**
 * notosplus.auth
 * FACTORY: Profile
 */

(function () {
    'use strict';

    angular
        .module('notosplus.auth')
        .factory('ProfileService', ProfileService);

    /* @ngInject */
    function ProfileService($http, exception, $q, common, config) {
        var cache = null;
        var _realm = null;
        var events = config.events;

        var service = {
            current: current,
            realm: realm,
            setRealm: setRealm
        };

        return service;
        //////////////

        function current(forceRefresh) {
            if (cache && !forceRefresh) {
                //should return promise
                return $q.when(cache);
            }

            return $http.get('/api/user/profile')
                .then(getCurrentComplete)
                .catch(function (message) {
                    exception.catcher('Profiel van de huidige gebruiker opvragen, lukt niet.')(message);
                });


            function getCurrentComplete(response, status, headers, config) {
                cache = response.data;
                service.setRealm(response.data.realm);
                return response.data;
            }

        }

        function realm() {
            return _realm; //synchronous, as async data was here at initialization
        }

        function setRealm(realm) {
            //realm.domain_name= realm.domain_name.replace(/\./g, '_');
            _realm = realm;
            common.$broadcast(events.realmChanged, realm);
        }

    }
    ProfileService.$inject = ["$http", "exception", "$q", "common", "config"];
})();
/**
 * notosplus.data
 * FACTORY: HTTPCache
 */

(function () {
    'use strict';

    angular
        .module('notosplus.data')
        .factory('HTTPCache', HTTPCache);

    /* @ngInject */
    function HTTPCache(Restangular, $cacheFactory) {
        var cache;
        cache = $cacheFactory('http');

        return Restangular.withConfig(function (RestangularConfigurer) {
            RestangularConfigurer.setDefaultHttpFields({cache: cache});
            RestangularConfigurer.setResponseInterceptor(function (response, operation) {
                if (operation === 'put' || operation === 'post' || operation === 'delete') {
                    cache.removeAll();
                }
                return response;
            });

            // Custom Global Method(s) for Restangularized Elements.
            RestangularConfigurer.setOnElemRestangularized(function(elem, isCollection) {
                elem.clearCache = function() {
                    cache.removeAll();
                }
                return elem;
            });
        });
    }
    HTTPCache.$inject = ["Restangular", "$cacheFactory"];
})();
/**
 * notosplus.layout
 * CONTROLLER: shell
 */
(function () {
    'use strict';

    angular
        .module('notosplus.layout')
        .controller('ShellController', ShellController);

    /* @ngInject */
    function ShellController(Init, $rootScope, config, ProfileService, logger) {
        /*jshint validthis: true */
        var vm = this;

        vm.busyMessage = 'Even geduld...';
        vm.isBusy = true;
        vm.showSplash = false;
        vm.avatar = null;
        vm.profile = {};
        vm.loggedInOrganization = null;

        var events = config.events;

        activate();
        /////////////

        function activate() {

            if (!Init.isInitialized()) {
                vm.showSplash = true;
                Init.initializing(true);
                getProfile().then(function (data) {

                    vm.profile = data;
                    vm.profile.fullName = vm.profile.first_name + ' ' + vm.profile.last_name;
                    //vm.profile.organizations = profile.organizations;

                    vm.avatar =
                        vm.profile.avatar ||
                        (vm.profile.gender === 'F' ? '/img/user/female.png' : '/img/user/male.png') ||
                        '/img/user/male.png';

                    initialized();
                });
            }
        }

        function getProfile() {
            return ProfileService.current().then(function (data) {
                vm.profile = data;
                return vm.profile;
            });
        }

        function toggleSpinner(on) {
            vm.isBusy = on;
        }

        $rootScope.$on('$stateChangeStart',
            function (event, next, current) {
                toggleSpinner(true);
            }
        );

        $rootScope.$on(events.controllerActivateSuccess,
            function (data) {
                toggleSpinner(false);
            }
        );
        $rootScope.$on(events.realmChanged,
            function (scope, realm) {
                vm.realm = realm;
            });

        function initialized() {
            vm.showSplash = false;

            logger.info('Welkom ' + vm.profile.first_name);
        }

    }
    ShellController.$inject = ["Init", "$rootScope", "config", "ProfileService", "logger"];
})();
/**
 * ROUTES: notosplus.library
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'library',
                config: {
                    abstract: true,
                    url: '/library'
                }
            },
            {
                state: 'library.books',
                config: {
                    url: '/books',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/library/books/books.html'
                        }
                    },
                    title: 'Boeken'
                }
            },
            {
                state: 'library.websites',
                config: {
                    url: '/websites',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/library/websites/websites.html'
                        }
                    },
                    title: 'Websites'
                }
            }
        ];
    };
})();
/**
 * ROUTES: notosplus.manage
 */
(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'manage',
                config: {
                    abstract: true,
                    url: '/manage',
                    title: 'Beheer'
                }
            },
            {
                state: 'manage.users',
                config: {
                    url: '/users',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/manage/users/users.html',
                            controller: 'UsersController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Gebruikers'
                }
            },
            {
                state: 'manage.users.detail',
                config: {
                    url: '/:id',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/manage/users/userdetail.html',
                            controller: 'UserDetailController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Gebruiker bewerken'
                }
            }
        ];
    };
})();
/**
 * notosplus.core
 * FACTORY: bootstrap.dialog
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('Dialog', modalDialog);

    /* @ngInject */
    function modalDialog($modal, $templateCache) {
        var service = {
            deleteDialog: deleteDialog,
            confirmationDialog: confirmationDialog,
            resetPasswordDialog: resetPasswordDialog
        };

        registerModelDialog($templateCache);
        registerResetPasswordDialog($templateCache);

        return service;
        ////////////////

        function deleteDialog(itemName) {
            var title = 'Ben je zeker?';
            itemName = itemName || 'item';
            var msg = 'Verwijder ' + itemName + '?';

            return confirmationDialog(title, msg);
        }

        function confirmationDialog(title, msg, okText, cancelText) {
            var modalOptions = {
                templateUrl: 'modalDialog.tpl.html',
                controller: ModalInstance,
                keyboard: true,
                resolve: {
                    options: function () {
                        return {
                            title: title,
                            message: msg,
                            okText: okText,
                            cancelText: cancelText,
                            password: '',
                            confirmPassword: ''
                        };
                    }
                }
            };

            return $modal.open(modalOptions).result;
        }

        function resetPasswordDialog(title, msg, okText, cancelText) {
            var modalOptions = {
                templateUrl: 'resetPasswordDialog.tpl.html',
                controller: ResetPasswordModalInstance,
                keyboard: true,
                resolve: {
                    options: function () {
                        return {
                            title: title,
                            message: msg,
                            okText: okText,
                            cancelText: cancelText,
                            password: '',
                            confirmPassword: ''
                        };
                    }
                }
            };

            return $modal.open(modalOptions).result;
        }
    }
    modalDialog.$inject = ["$modal", "$templateCache"];

    /* @ngInject */
    function ModalInstance($scope, $modalInstance, options) {
        $scope.title = options.title || 'Titel';
        $scope.message = options.message || '';
        $scope.okText = options.okText || 'Ok';
        $scope.cancelText = options.cancelText || 'Annuleren';
        $scope.ok = function () {
            $modalInstance.close('ok');
        };
        $scope.cancel = function () {
            $modalInstance.dismiss('cancel');
        };
    }
    ModalInstance.$inject = ["$scope", "$modalInstance", "options"];

    /* @ngInject */
    function ResetPasswordModalInstance($scope, $modalInstance, options) {
        $scope.title = options.title || 'Paswoord opnieuw instellen';
        $scope.message = options.message || 'Geef het nieuwe paswoord in.';
        $scope.okText = options.okText || 'Wijzig';
        $scope.cancelText = options.cancelText || 'Annuleren';
        $scope.password = '';
        $scope.confirmPassword = '';
        $scope.ok = function () {
            $modalInstance.close({password: $scope.password});
        };
        $scope.cancel = function () {
            $modalInstance.dismiss('cancel');
        };
    }
    ResetPasswordModalInstance.$inject = ["$scope", "$modalInstance", "options"];

    function registerModelDialog($templateCache) {
        $templateCache.put('modalDialog.tpl.html',
            '<div>' +
            '    <div class="modal-header">' +
            '        <button type="button" class="close" data-dismiss="modal" ' +
            '            aria-hidden="true" data-ng-click="cancel()">&times;</button>' +
            '        <h3>{{title}}</h3>' +
            '    </div>' +
            '    <div class="modal-body">' +
            '        <p>{{message}}</p>' +
            '    </div>' +
            '    <div class="modal-footer">' +
            '        <button class="btn btn-primary" data-ng-click="ok()">{{okText}}</button>' +
            '        <button class="btn btn-info" data-ng-click="cancel()">{{cancelText}}</button>' +
            '    </div>' +
            '</div>');
    }

    function registerResetPasswordDialog($templateCache) {
        $templateCache.put('resetPasswordDialog.tpl.html',
            '<div>' +
            '    <div class="modal-header">' +
            '        <button type="button" class="close" data-dismiss="modal" ' +
            '            aria-hidden="true" data-ng-click="cancel()">&times;</button>' +
            '        <h3>{{title}}</h3>' +
            '    </div>' +
            '    <div class="modal-body">' +
            '        <p>{{message}}</p>' +
            '        <div class="form-group">' +
            '           <label class="control-label">Paswoord</label>' +
            '           <input type="password" data-ng-model="password" placeholder="Nieuw paswoord" class="form-control">' +
            '        </div>' +
            '        <div class="form-group">' +
            '           <label class="control-label">Herhaal password</label>' +
            '           <input type="password" data-ng-model="confirmPassword" placeholder="Herhaal paswoord" class="form-control">' +
            '        </div>' +
            '        <div class="form-group">' +
            '           <span class="text-danger" data-ng-show="password !== confirmPassword && password !== \'\'">De paswoorden komen niet overeen.</span>' +
            '        </div>' +
            '    </div>' +
            '    <div class="modal-footer">' +
            '        <button class="btn btn-primary" data-ng-click="ok()" data-ng-disabled="password !== confirmPassword || password === \'\'">{{okText}}</button>' +
            '        <button class="btn btn-info" data-ng-click="cancel()">{{cancelText}}</button>' +
            '    </div>' +
            '</div>');
    }
})();
/**
 * notosplus.core
 * FACTORY: common
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('common', common);

    function common($q, $rootScope, $timeout, logger) {
        var throttles = {};

        var service = {
            // common angular dependencies
            $broadcast: $broadcast,
            $q: $q,
            $timeout: $timeout,
            // generic
            isNumber: isNumber,
            debouncedThrottle: debouncedThrottle,
            logger: logger,
            textContains: textContains
        }

        return service;
        ////////////////////////

        function $broadcast() {
            return $rootScope.$broadcast.apply($rootScope, arguments);
        }


        function debouncedThrottle(key, callback, delay, immediate) {
            // Perform some action (callback) after a delay.
            // Track the callback by key, so if the same callback
            // is issued again, restart the delay.
            var defaultDelay = 1000;
            delay = delay || defaultDelay;
            if (throttles[key]) {
                $timeout.cancel(throttles[key]);
                throttles[key] = undefined;
            }
            if (immediate) {
                callback();
            } else {
                throttles[key] = $timeout(callback, delay);
            }
        }

        function isNumber(val) {
            // negative or positive
            return (/^[-]?\d+$/).test(val);
        }

        function textContains(text, searchText) {
            return text && -1 !== text.toLowerCase().indexOf(searchText.toLowerCase());
        }
    }
    common.$inject = ["$q", "$rootScope", "$timeout", "logger"];
})();
/**
 * notosplus.data
 * FACTORY: breezeConfig
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('breezeConfig', breezeConfig);

    /* @ngInject */
    function breezeConfig(breeze) {
        var service = {
            remoteServiceName: '/api/breeze',
            breeze: breeze
        }

        return service;
        ////////////////
    }
    breezeConfig.$inject = ["breeze"];

})();
(function () {
    'use strict';

    var core = angular.module('notosplus.core');

    core.config(toastrConfig);

    /* @ngInject */
    function toastrConfig(toastr) {
        toastr.options.timeOut = 4000;
        toastr.options.closeButton = true;
        toastr.options.progressBar = true;
        toastr.options.positionClass = 'toast-bottom-right';
    }
    toastrConfig.$inject = ["toastr"];

    var keyCodes = {
        backspace: 8,
        tab: 9,
        enter: 13,
        esc: 27,
        space: 32,
        pageup: 33,
        pagedown: 34,
        end: 35,
        home: 36,
        left: 37,
        up: 38,
        right: 39,
        down: 40,
        insert: 45,
        del: 46
    };

    var events = {
        controllerActivateSuccess: 'controller.activateSuccess',
        entitiesChanged: 'datacontext.entitiesChanged',
        entitiesImported: 'datacontext.entitiesImported',
        hasChangesChanged: 'datacontext.hasChangesChanged',
        storage: {
            error: 'store.error',
            storeChanged: 'store.changed',
            wipChanged: 'wip.changed'
        },
        loggedInOrganizationChanged: 'profile.loggedInAtChanged'
    };


    var config = {
        appErrorPrefix: '[noTos+ Fout] ',
        appTitle: 'noTos+',
        keyCodes: keyCodes,
        version: '1.0.0',
        events: events
    };

    core.value('config', config);

    core.config(configure);

    /* @ngInject */
    function configure($urlRouterProvider, $stateProvider,
                       routehelperConfigProvider, $breadcrumbProvider,
                       zStorageConfigProvider, zDirectivesConfigProvider,
                       RestangularProvider) {

        configureRouting();
        configureBreadcrumb();

        configureZStorage();
        configureZValidate();

        configureRestangular();


        function configureRouting() {
            routehelperConfigProvider.config.$urlRouterProvider = $urlRouterProvider;
            routehelperConfigProvider.config.$stateProvider = $stateProvider;

            routehelperConfigProvider.config.title = config.appTitle;
        }

        function configureBreadcrumb() {
            $breadcrumbProvider.setOptions({
                prefixStateName: 'index',
                template: 'bootstrap3',
                includeAbstract: true
            });
        }

        function configureZStorage() {
            // Setup our Breeze-based offline storage
            zStorageConfigProvider.config = {
                // zStorage
                enabled: false,
                key: 'noTosPlus',
                events: config.events.storage,

                // zStorageWip
                wipKey: 'noTosPlus.wip',
                appErrorPrefix: config.appErrorPrefix,
                newGuid: breeze.core.getUuid,

                // zStorageCore
                version: config.version
            };
        }

        function configureZValidate() {
            zDirectivesConfigProvider.zValidateTemplate =
                '<span class="invalid"><i class="fa fa-warning-sign"></i>' +
                'Onbegrijpelijk! %error%</span>';

        }

        function configureRestangular() {
            var baseUrl = '/api';

            RestangularProvider.setBaseUrl(baseUrl);
        }
    }
    configure.$inject = ["$urlRouterProvider", "$stateProvider", "routehelperConfigProvider", "$breadcrumbProvider", "zStorageConfigProvider", "zDirectivesConfigProvider", "RestangularProvider"];
})();
/* global toastr:false, moment:false */
(function() {
    'use strict';

    angular
        .module('notosplus.core')
        .constant('toastr', toastr)
        .constant('moment', moment);
})();
/**
 * notosplus.core
 * FACTORY: Init
 */

(function () {
    'use strict';

    angular
        .module('notosplus.core')
        .factory('Init', Init);

    /* @ngInject */
    function Init() {
        var wasInitialized = false;

        var service = {
            isInitialized: isInitialized,
            initializing: initializing
        }

        return service;
        ////////////////

        function isInitialized() {
            return wasInitialized;
        }
        function initializing(init) {
            wasInitialized = init;
        }

    }
})();
/**
 * ROUTES: notosplus.dashboard
 */
(function () {
    'use strict';

    angular
        .module('notosplus.dashboard')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'index',
                config: {
                    abstract: true,
                    url: '/index',
                    ncyBreadcrumb: {
                        label: 'start'
                    }
                }
            },
            {
                state: 'index.dashboard',
                config: {
                    url: '/dashboard',
                    views: {
                        'content@': {
                            templateUrl: 'js/modules/dashboard/dashboard.html'
                        }
                    },
                    title: 'Dashboard',
                    ncyBreadcrumb: {
                        label: 'Dashboard'
                    }
                }
            }
        ];
    };
})();
// Include in index.html so that app level exceptions are handled.
// Exclude from testRunner.html which should run exactly what it wants to run
(function() {
    'use strict';

    angular
        .module('blocks.exception')
        .provider('exceptionHandler', exceptionHandlerProvider)
        .config(config);

    /**
     * Must configure the exception handling
     * @return {[type]}
     */
    function exceptionHandlerProvider() {
        /* jshint validthis:true */
        this.config = {
            appErrorPrefix: undefined
        };

        this.configure = function (appErrorPrefix) {
            this.config.appErrorPrefix = appErrorPrefix;
        };

        this.$get = function() {
            return {config: this.config};
        };
    }

    /**
     * Configure by setting an optional string value for appErrorPrefix.
     * Accessible via config.appErrorPrefix (via config value).
     * @param  {[type]} $provide
     * @return {[type]}
     * @ngInject
     */
    function config($provide) {
        $provide.decorator('$exceptionHandler', extendExceptionHandler);
    }
    config.$inject = ["$provide"];

    /**
     * Extend the $exceptionHandler service to also display a toast.
     * @param  {Object} $delegate
     * @param  {Object} exceptionHandler
     * @param  {Object} logger
     * @return {Function} the decorated $exceptionHandler service
     */
    function extendExceptionHandler($delegate, exceptionHandler, logger) {
        return function(exception, cause) {
            var appErrorPrefix = exceptionHandler.config.appErrorPrefix || '';
            var errorData = {exception: exception, cause: cause};
            exception.message = appErrorPrefix + exception.message;
            $delegate(exception, cause);
            /**
             * Could add the error to a service's collection,
             * add errors to $rootScope, log errors to remote web server,
             * or log locally. Or throw hard. It is entirely up to you.
             * throw exception;
             *
             * @example
             *     throw { message: 'error message we added' };
             */
            logger.error(exception.message, errorData);
        };
    }
    extendExceptionHandler.$inject = ["$delegate", "exceptionHandler", "logger"];
})();
/**
 * blocks.exception
 * FACTORY: exception
 */

(function () {
    'use strict';

    angular
        .module('blocks.exception')
        .factory('exception', exception);

    /* @ngInject */
    function exception(logger) {
        var service = {
            catcher: catcher
        };
        return service;

        function catcher(message) {
            return function(reason) {
                logger.error(message, reason);
            };
        }
    }
    exception.$inject = ["logger"];
})();
/**
 * blocks.logger
 * FACTORY: logger
 */

(function () {
    'use strict';

    angular
        .module('blocks.logger')
        .factory('logger', logger);

    logger.$inject = ['$log', 'toastr'];

    function logger($log, toastr) {
        var service = {
            showToasts: true,

            error: error,
            info: info,
            success: success,
            warning: warning,

            removed: removed,
            saved: saved,

            // straight to console; bypass toastr
            log: $log.log
        };

        return service;
        /////////////////////

        function error(message, data, title) {
            toastr.error(message, title);
            $log.error('Fout: ' + message, data);
        }

        function info(message, data, title) {
            toastr.info(message, title);
            $log.info('Info: ' + message, data);
        }

        function success(message, data, title) {
            toastr.success(message, title);
            $log.info('Succes: ' + message, data);
        }

        function warning(message, data, title) {
            toastr.warning(message, title);
            $log.warn('Let op: ' + message, data);
        }

        function removed(message, data, title) {
            toastr.warning(message, title);
            $log.warn('Verwijderd: ' + message, data);
        }

        function saved(message, data, title) {
            toastr.success(message, title);
            $log.info('Bewaard: ' + message, data);
        }
    }
})();
/**
 * notosplus.router
 * FACTORY: routehelper
 */

(function () {
    'use strict';

    angular
        .module('blocks.router')
        .provider('routehelperConfig', routehelperConfig)
        .factory('routehelper', routehelper);

    routehelper.$inject = ['routehelperConfig', '$rootScope', '$state'];

    function routehelperConfig() {
        /* jshint validthis:true */
        this.config = {};

        this.$get = function () {
            return {
                config: this.config
            };
        };
    }

    function routehelper(routehelperConfig, $rootScope, $state) {
        var $urlRouterProvider = routehelperConfig.config.$urlRouterProvider;
        var $stateProvider = routehelperConfig.config.$stateProvider;

        var service = {
            configureStates: configureStates,
            states: states,
            get: get
        };

        init();

        return service;
        //////////////////

        function configureStates(states) {
            states.forEach(function (state) {
                if (state.config.title) {
                    state.config.ncyBreadcrumb = {
                        label: state.config.title.toLowerCase()
                    }
                }

                $stateProvider.state(state.state, state.config);
            });
        }

        function states() {
            return $state.get();
        }

        function get(pattern) {
            var result = null;
            states().forEach(function (state) {
                if (state.name === pattern) {
                    result = state;
                }
            });
            return result;
        }


        function init() {
            updateDocTitle();
            $urlRouterProvider.otherwise('/index/dashboard');
        }

        function updateDocTitle() {
            $rootScope.$on('$stateChangeSuccess',
                function (event, current, previous) {
                    var title = routehelperConfig.config.title + (current.title ? ' | ' + current.title : '');
                    $rootScope.title = title; // data bind to <title>
                    $rootScope.$state = current;
                }
            );
        }

    }
})();
(function () {
    'use strict';

    angular
        .module('notosplus.data')
        .factory('repository.abstract', AbstractRepository);

    /* @ngInject */
    function AbstractRepository(breeze, common, zStorage, zStorageWip) {
        /* jshint validthis:true */
        var predicates = {
            isNotNullo: breeze.Predicate.create('id', '!=', 0),
            isNullo: breeze.Predicate.create('id', '==', 0)
        };
        var $q = common.$q;

        function Ctor(entityManager, entityName) {
            // instance members that are stateful
            this.entityName = entityName;
            this.getById = getById.bind(this);
            this.getEntityByIdOrFromWip = getEntityByIdOrFromWip.bind(this);
            this.logger = common.logger;
            this.manager = entityManager;
            this.queryFailed = queryFailed.bind(this); // Bind to self so we establish 'this' as the context
        }

        /* stateless methods that can be shared across all repos */
        Ctor.prototype = {
            constructor: Ctor,
            $q: $q,
            getAll: getAll,
            getAllLocal: getAllLocal,
            getLocalEntityCount: getLocalEntityCount,
            predicates: predicates,
            setIsPartialTrue: setIsPartialTrue,
            zStorage: zStorage,
            zStorageWip: zStorageWip
        };

        return Ctor;

        /* Implementation */

        function getAll(resource, ordering, predicate) {
            return breeze.EntityQuery.from(resource)
                .where(predicate)
                .orderBy(ordering)
                .using(this.manager)
                .execute();
        }

        function getAllLocal(resource, ordering, predicate) {
            if (this.manager.metadataStore.isEmpty()) {
                return this.getAll(resource, ordering, predicate);
            }
            return breeze.EntityQuery.from(resource)
                .where(predicate)
                .orderBy(ordering)
                .using(this.manager)
                .executeLocally();
        }

        function getById(id, forceRemote) {
            var self = this;
            var entityName = self.entityName;
            var manager = self.manager;
            if (!forceRemote) {
                // Check cache first (synchronous)
                var entity = manager.getEntityByKey(entityName, id);
                if (entity && !entity.isPartial) {
                    self.logger.info('Retrieved [' + entityName + '] id:' + entity.id + ' from cache.', entity);
                    if (entity.entityAspect.entityState.isDeleted()) {
                        entity = null; // hide session marked-for-delete
                    }
                    // Should not need to call $apply because it is synchronous
                    return $q.when(entity);
                }
            }

            // It was not found in cache, so let's query for it.
            // fetchEntityByKey will go remote because
            // 3rd parm is false/undefined.
            return manager.fetchEntityByKey(entityName, id)
                .then(querySucceeded).catch(self.queryFailed);

            function querySucceeded(data) {
                entity = data.entity;
                if (!entity) {
                    self.logger.info('Could not find [' + entityName + '] id:' + id, null);
                    return null;
                }
                entity.isPartial = false;
                self.logger.info('Retrieved [' + entityName + '] id ' + entity.id + ' from remote data source', entity);
                zStorage.save();
                return entity;
            }
        }

        function getEntityByIdOrFromWip(val) {
            var self = this;
            var entityName = self.entityName;
            // val could be an ID or a wipKey
            var wipEntityKey = val;

            if (common.isNumber(val)) {
                val = parseInt(val);
                wipEntityKey = zStorageWip.findWipKeyByEntityId(entityName, val);
                if (!wipEntityKey) {
                    // Returns a promise with the entity because
                    // the entity may be in storagelocal or remote (async).
                    // Bind to self so we establish 'this' as the context.
                    return getById.bind(self)(val);
                }
            }

            var wipResult = null;
            var importedEntity = zStorageWip.loadWipEntity(wipEntityKey);
            if (importedEntity) {
                // Need to re-validate the entity we are re-hydrating
                importedEntity.entityAspect.validateEntity();
                wipResult = {entity: importedEntity, key: wipEntityKey};
            } else {
                self.logger.info('Could not find [' + entityName + '] id in WIP:' + wipEntityKey, null);
            }
            return $q.when(wipResult);
        }

        function getLocalEntityCount(resource) {
            var entities = breeze.EntityQuery.from(resource)
                .where(predicates.isNotNullo)
                .using(this.manager)
                .executeLocally();
            return entities.length;
        }

        function queryFailed(error) {
            var msg = 'Error retrieving data. ' + (error.message || '');
            this.logger.error(msg, error);
            return $q.reject(new Error(msg));
        }

        function setIsPartialTrue(entities) {
            // call for all "partial queries"
            for (var i = entities.length; i--;) {
                entities[i].isPartial = true;
            }
            return entities;
        }
    }
    AbstractRepository.$inject = ["breeze", "common", "zStorage", "zStorageWip"];
})();
/**
 * notosplus.data
 * FACTORY: repository.lookup
 */

(function () {
    'use strict';

    angular
        .module('notosplus.data')
        .factory('repository.lookup', RepositoryLookup);

    RepositoryLookup.$inject = ['breeze', 'model', 'repository.abstract', 'ProfileService'];

    function RepositoryLookup(breeze, model, AbstractRepository, ProfileService) {
        var entityName = 'role';
        var entityNames = model.entityNames;

        return {
            create: createRepo
        };
        //////////////////////

        function createRepo(manager) {
            var base = new AbstractRepository(manager, entityName);
            var cachedLookups;
            var repo = {
                getAll: getAll,
                get cachedData() {
                    return getCachedLookups();
                } //shortcut 'getter' syntax
            };

            return repo;
            ////////////

            function getAll() {
                return breeze.EntityQuery.from('Lookups')
                    .using(manager).execute()
                    .then(processLookups).catch(base.queryFailed);

                function processLookups(data) {
                    model.createNullos(manager);
                    //base.logger.info('Retrieved lookups', data);
                    base.zStorage.save();
                    return true;
                }
            }


            function getCachedLookups() {
                if(!cachedLookups) {
                    cachedLookups = {
                        roles: base.getAllLocal(entityNames.role, 'name')
                    }
                }
                return cachedLookups;
            }
        }
    }
})();
(function () {
    'use strict';

    angular
        .module('notosplus.data')
        .factory('repository.user', RepositoryUser);

    RepositoryUser.$inject = ['breeze', 'model', 'repository.abstract'];

    function RepositoryUser(breeze, model, AbstractRepository) {
        var entityName = model.entityNames.user;

        var orderBy = 'username';

        return {
            create: createRepo // factory function to create the repository
        };

        /* Implementation */
        function createRepo(manager) {
            var base = new AbstractRepository(manager, entityName);

            // Using the type is a little faster than the type name
            //var metadataStore = manager.metadataStore;
            // var userType = metadataStore.getEntityType(model.entityNames.user);

            var repo = {
                create: create,
                getAllLocal: getAllLocal,
                getById: base.getById,
                getEntityByIdOrFromWip: base.getEntityByIdOrFromWip,
                getPartials: getPartials,
            };

            return repo;
            /////////////

            function predicateForOrganization(orgId) {
                var kl = breeze.Predicate.create('relatedTo.reference.id', '==', orgId);
                var emp = breeze.Predicate.create('relatedTo.kind.name', '==', 'EMPLOYEE');
                var predicate = breeze.Predicate.and([kl, emp]);
                return predicate;
            }

            function create() {
                return manager.createEntity('User');
            }

            function getAllLocal(orgId, includeNullo) {
                return base.getAllLocal('User', orderBy, predicateForOrganization(orgId));
            }

            function getPartials(orgId, forceRemote) {
                var users;
                if (!forceRemote) {
                    users = getAllLocal(false, orgId);
                    if (users.length) {
                        return base.$q.when(users);
                    }
                }

                var predicate = predicateForOrganization(orgId);

                return breeze.EntityQuery.from('User')
                    .expand('relatedTo,relatedTo.kind')
                    .orderBy(orderBy)
                    .toType('User')
                    .where(predicate)
                    .using(manager).execute()
                    .then(querySucceeded).catch(base.queryFailed);

                function querySucceeded(data) {
                    users = data.results;
                    for (var i = users.length; i--;) {
                        users[i].isPartial = true;
                    }
                    base.logger.info('Retrieved [User Partials] from remote data source', users.length);
                    base.zStorage.save();

                    return users;
                }
            }

        }
    }
})();
/**
 * notosplus.library
 * CONTROLLER: WebsiteDetailController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .controller('WebsiteDetailController', WebsiteDetailController);

    /* @ngInject */
    function WebsiteDetailController() {
        /*jshint validthis: true */
        var vm = this;

        activate();
        ////////////
    }
})();
/**
 * notosplus.library
 * CONTROLLER: WebsitesController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.library')
        .controller('WebsitesController', WebsitesController);

    /* @ngInject */
    function WebsitesController() {
        /*jshint validthis: true */
        var vm = this;

        activate();
        ////////////////

        function activate() {

        }
    }
})();
/**
 * notosplus.manage
 * FACTORY: User
 */

(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .factory('User', User);


    /* @ngInject */
    function User(HTTPCache, ProfileService) {

        var service = HTTPCache.service('/organization/' + ProfileService.realm().id + '/user');


        return service;



        //return $resource('/api/user/:id');

        /*var service = {
            getList: getList,
            get: get,
            save: save,
            remove: remove
        };

        return service;
        //////////////////

        function getList() {
            return Restangular.all('user').getList();
        }

        function get(id) {
            return Restangular.one('user', id).get()
                .then(function (data) {
                    var user = data;
                    return user;
                });
        }

        function save(user) {
            if (user.hasOwnProperty('id') && user.id) {
                return Restangular.post(user);
            } else {
                return Restangular.one('user').post(user);
            }
        }

        function remove() {
            if (user.hasOwneProperty('id') && user.id) {
                return Restangular.one('user', user.id).remove();
            }
        }*/
    }
    User.$inject = ["HTTPCache", "ProfileService"];
})();
/**
 * notosplus.manage
 * CONTROLLER: UserAddController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .controller('UserDetailController', UserDetailController);

    /* @ngInject */
    function UserDetailController($state, $stateParams,
                                  common, config, User, Dialog, ProfileService) {
        /*jshint validthis: true */
        var vm = this;
        var logger = common.logger;
        var $q = common.$q;
        var events = config.events;


        vm.cancel = cancel;
        vm.hasChanges = false;
        vm.loading = false;
        vm.isSaving = false;
        vm.isResetPwd = false;
        vm.resetPwd = resetPassword;
        vm.save = save;
        vm.remove = remove;
        vm.user = null;
        vm.users = [];
        vm.defaultUsername = defaultUsername;
        vm.defaultDomain = ProfileService.current().domain_name;

        Object.defineProperty(vm, 'canSave', {get: canSave});

        activate();

        function activate() {
            //onDestroy();
            //onHasChanges();

            getRequestedUser();

            common.$broadcast(events.controllerActivateSuccess);
        }

        function cancel() {
            goToUsers();
        }

        function canSave() {
            return !vm.isSaving;
        }

        function getRequestedUser() {
            vm.loading = true;
            var val = $stateParams.id;
            if (val === 'new') {
                vm.user = User.one();
                vm.isResetPwd = true;
                vm.loading = false;

                return vm.user;
            }

            User.one(val).get()
                .then(function (data) {
                    if (data) {
                        vm.user = data;

                        vm.loading = false;
                        return vm.user;

                    } else {
                        logger.warning('Could not find user id = ' + val);
                        goToUsers();
                    }
                    vm.loading = false;
                })
                .catch(function (error) {
                    logger.error('Error while getting speaker id = ' + val + '; ' + error);
                    goToUsers();
                });
        }

        function goToUsers() {
            $state.go('manage.users');
        }

        function save() {

            if (!canSave()) {
                return $q.when(null);
            } // Must return a promise

            vm.isSaving = true;

            return vm.user.save().then(function () {
                vm.isSaving = false;

                goToUsers();
            }).catch(function (error) {
                vm.isSaving = false;
            });

        }

        function resetPassword() {
            return Dialog.resetPasswordDialog()
                .then(patchResettedPassword);

            function patchResettedPassword(data) {
                vm.user.one('password').patch(data)
                    .then(passwordWasResetted);

                function passwordWasResetted(user) {
                    common.logger.info('Paswoord opnieuw ingesteld voor ' + user.full_name);
                }
            }
        }

        function remove() {
            return Dialog.deleteDialog(vm.user.full_name)
                .then(removeUser);

            function removeUser() {
                vm.user.remove().then(function () {
                    vm.user.clearCache();
                    logger.warning(vm.user.full_name + ' werd met succes verwijderd.');
                    goToUsers();
                }).catch(function (response) {
                    Dialog.confirmationDialog('Verwijderen mislukt',
                        'Het verwijderen van ' + vm.user.full_name + ' is mislukt. Probeer het later opnieuw.');
                });
            }
        }

        function defaultUsername() {
            if(vm.user.username) {
                return vm.user.username;
            }
            return vm.user.first
        }
    }
    UserDetailController.$inject = ["$state", "$stateParams", "common", "config", "User", "Dialog", "ProfileService"];
})();
/**
 * notosplus.manage
 * CONTROLLER: UsersController
 */
(function () {
    'use strict';

    angular
        .module('notosplus.manage')
        .controller('UsersController', UsersController);


    /* @ngInject */
    function UsersController($state, config, common, User) {
        /*jshint validthis: true */
        var vm = this;

        var keyCodes = config.keyCodes;
        var events = config.events;

        vm.filteredUsers = [];
        vm.gotoUser = gotoUser;
        vm.refresh = refresh;
        vm.search = search;
        vm.userSearch = '';
        vm.users = [];


        activate();

        function activate() {
            common.$broadcast(events.controllerActivateSuccess);
            getUsers();
        }

        function applyFilter() {
            vm.filteredUsers = vm.users.filter(userFilter);
        }


        function getUsers(forceRefresh) {
            vm.loading = true;

            if (forceRefresh) {
                if (vm.users) {
                    vm.users.clearCache();
                }
            }
            User.getList().then(function (data) {
                vm.users = vm.filteredUsers = data;
                vm.loading = false;

                return vm.users;
            });
        }


        function gotoUser(user) {
            if (user && user.id) {
                $state.go('manage.users.detail', {id: user.id});
            }
        }

        function refresh() {
            vm.userSearch = '';
            getUsers(true);
        }

        function search($event) {
            if ($event.keyCode === keyCodes.esc) {
                vm.userSearch = '';
            }
            applyFilter();
        }

        function userFilter(user) {
            var isMatch = true;
            if (vm.userSearch) {
                isMatch = common.textContains(user.name, vm.userSearch);
                isMatch |= common.textContains(user.username, vm.userSearch);
            }

            return isMatch;
        }
    }
    UsersController.$inject = ["$state", "config", "common", "User"];
})();
/**
 * notosplus.widgets
 * DIRECTIVE: ntFa
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntFa', ntFa);

    ntFa.$inject = [];

    function ntFa() {
        var directive = {
            restrict: 'E',
            link: linkFunc
        };

        return directive;
        //////////////////////

        function linkFunc(scope, element, attrs) {
            var i = angular.element('<i class="fa" />');
            var classes = attrs.name.split(' ');

            angular.forEach(classes, function (value) {
                i.addClass('fa-' + value);
            });

            element.replaceWith(i);
        }
    }
})();


/**
 * notosplus.widgets
 * DIRECTIVE: ntSpinner
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntSpinner', ntSpinner);

    /* @ngInject */
    function ntSpinner() {
        var directive = {
            restrict: 'EA',
            compile: compile
        };

        return directive;
        //////////////////////
        function compile(elem, attrs) {
            if (elem[0].tagName === 'TABLE') {
                addSpinnerToTBody(elem, attrs);
            } else {
                addSpinnerToElement(elem, attrs);
            }
        }

        function addSpinnerToTBody(element, attrs) {
            var tbody = element.find('tbody');
            var html = ['<tr ng-show="' + attrs.spinnerShow + '">',
                            '<td ',
                                (attrs.hasOwnProperty('colspan') ? 'colspan="' + attrs.colspan + '" ' : ''),
                            ' style="text-align:center">',
                                '<img src="/img/busy/busyatom.gif" style="width:40px;height:40px;">',
                            '</td>',
                        '</tr>'].join('');

            tbody.prepend(html);
        }
        function addSpinnerToElement(element, attrs) {
            var html = ['<div ng-show="' + attrs.spinnerShow + '" class="col-md-12 text-center">',
                    '<img src="/img/busy/busyatom.gif" style="width:40px;height:40px;">',
                '</div>',
                '<div class="clearfix"></div>'].join('');

            element.prepend(html);
        }
    }
})();


/**
 * notosplus.widgets
 * FACTORY: spinnerService
 */

(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .factory('spinnerService', spinnerService);

    /* @ngInject */
    function spinnerService() {
        var spinners = {};
        var service = {
            _register: register,
            _unregister: unregister,
            _unregisterAll: unregisterAll,
            show: show,
            hide: hide,
            showGroup: showGroup,
            hideGroup: hideGroup,
            showAll: showAll,
            hideAll: hideAll
        }

        return service;
        //////////////
        function register(data) {
            if(!data.hasOwnProperty('name')) {
                throw new Error('Spinner must specify a name when registering with the spinner service.');
            }
            if(spinners.hasOwnProperty(data.name)) {
                throw new Error('A spinner with the name "' + data.name + '" has already been registered.');
            }
            spinners[data.name] = data;
        }

        function unregister(name) {
            if(spinners.hasOwnProperty(name)) {
                delete spinners[name];
            }
        }

        function unregisterAll() {
            for(var name in spinners) {
                delete spinners[name];
            }
        }

        function show(name) {
            var spinner  = spinners[name];
            if(!spinner) {
                throw  new Error('No spinner named "' + name + '" is registered.');
            }
            spinner.show();
        }

        function hide(name) {
            var spinner  = spinners[name];
            if(!spinner) {
                throw  new Error('No spinner named "' + name + '" is registered.');
            }
            spinner.hide();
        }

        function showGroup(group) {
            var groupExists = false;
            for(var name in spinners) {
                var spinner = spinners[name];
                if(spinner.group === group) {
                    spinner.show();
                    groupExists = true;
                }
            }
            if(!groupExists) {
                throw new Error('No spinners found with group "' + group + '".');
            }
        }
        function hideGroup(group) {
            var groupExists = false;
            for(var name in spinners) {
                var spinner = spinners[name];
                if(spinner.group === group) {
                    spinner.hide();
                    groupExists = true;
                }
            }
            if(!groupExists) {
                throw new Error('No spinners found with group "' + group + '".');
            }
        }
        function showAll() {
            for(var name in spinners) {
                spinners[name].show();
            }
        }
        function hideAll() {
            for(var name in spinners) {
                spinners[name].hide();
            }
        }
    }
})();
/**
 * notosplus.widgets
 * DIRECTIVE: ntMiniSideBar
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntMiniSidebar', ntMiniSidebar);

    function ntMiniSidebar() {
        var directive = {
            restrict: 'A',
            template: [
                '<a class="navbar-minimalize minimalize-styl-2 btn btn-primary" href="" ng-click="vm.minimalize()">',
                '<i class="fa fa-bars"></i>',
                '</a>'
            ].join(''),

            controller: MinimizeController,
            controllerAs: 'vm',
            bindToController: true // because the scope is isolated
        };

        MinimizeController.$inject = ["$timeout"];
        return directive;
        //////////////////////

        /* @ngInject */
        function MinimizeController($timeout) {
            var vm = this;
            vm.minimalize = minimalize;

            //////////////////////////////////
            function minimalize() {
                angular.element('body').toggleClass('mini-navbar');
                if (!angular.element('body').hasClass('mini-navbar') || angular.element('body').hasClass('body-small')) {
                    // Hide menu in order to smoothly turn on when maximize menu
                    angular.element('#side-menu').hide();
                    // For smoothly turn on menu
                    $timeout(
                        function () {
                            angular.element('#side-menu').fadeIn(500);
                        }, 100);
                } else if (angular.element('body').hasClass('fixed-sidebar')) {
                    angular.element('#side-menu').hide();
                    $timeout(
                        function () {
                            angular.element('#side-menu').fadeIn(500);
                        }, 300);
                } else {
                    // Remove all inline style from jquery fadeIn function to reset menu state
                    angular.element('#side-menu').removeAttr('style');
                }
            }
        }
    }
})();


/**
 * notosplus
 * DIRECTIVE: ntSideNavigation
 */
(function () {
    'use strict';

    angular
        .module('notosplus.widgets')
        .directive('ntSideNavigation', ntSideNavigation);

    /* @ngInject */
    function ntSideNavigation($timeout) {
        var directive = {
            restrict: 'EA',
            link: linkFunc
        };

        return directive;
        //////////////////////

        function linkFunc(scope, element) {
            $timeout(function () {
                $(element).metisMenu();
            })
        };
    }
    ntSideNavigation.$inject = ["$timeout"];
})();


//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vdG9zcGx1cy5tb2R1bGUuanMiLCJhdXRoL2F1dGgubW9kdWxlLmpzIiwiZGF0YS9kYXRhLm1vZHVsZS5qcyIsImxheW91dC9sYXlvdXQubW9kdWxlLmpzIiwibGlicmFyeS9saWJyYXJ5Lm1vZHVsZS5qcyIsIm1hbmFnZS9tYW5hZ2UubW9kdWxlLmpzIiwid2lkZ2V0cy93aWRnZXRzLm1vZHVsZS5qcyIsImNvcmUvY29yZS5tb2R1bGUuanMiLCJkYXNoYm9hcmQvZGFzaGJvYXJkLm1vZHVsZS5qcyIsImJsb2Nrcy9leGNlcHRpb24vZXhjZXB0aW9uLm1vZHVsZS5qcyIsImJsb2Nrcy9sb2dnZXIvbG9nZ2VyLm1vZHVsZS5qcyIsImJsb2Nrcy9yb3V0ZXIvcm91dGVyLm1vZHVsZS5qcyIsImF1dGgvcHJvZmlsZS5qcyIsImRhdGEvcmVzdGFuZ3VsYXIuY2FjaGUuanMiLCJsYXlvdXQvc2hlbGwuY29udHJvbGxlci5qcyIsImxpYnJhcnkvbGlicmFyeS5yb3V0ZXMuanMiLCJtYW5hZ2UvbWFuYWdlLnJvdXRlcy5qcyIsImNvcmUvYm9vdHN0cmFwLmRpYWxvZy5qcyIsImNvcmUvY29tbW9uLmpzIiwiY29yZS9jb25maWcuYnJlZXplLmpzIiwiY29yZS9jb25maWcuanMiLCJjb3JlL2NvbnN0YW50cy5qcyIsImNvcmUvaW5pdC5qcyIsImRhc2hib2FyZC9kYXNoYm9hcmQucm91dGVzLmpzIiwiYmxvY2tzL2V4Y2VwdGlvbi9leGNlcHRpb24taGFuZGxlci5wcm92aWRlci5qcyIsImJsb2Nrcy9leGNlcHRpb24vZXhjZXB0aW9uLmpzIiwiYmxvY2tzL2xvZ2dlci9sb2dnZXIuanMiLCJibG9ja3Mvcm91dGVyL3JvdXRlaGVscGVyLmpzIiwiZGF0YS9yZXBvc2l0b3JpZXMvcmVwb3NpdG9yeS5hYnN0cmFjdC5qcyIsImRhdGEvcmVwb3NpdG9yaWVzL3JlcG9zaXRvcnkubG9va3VwLmpzIiwiZGF0YS9yZXBvc2l0b3JpZXMvcmVwb3NpdG9yeS51c2VyLmpzIiwibGlicmFyeS93ZWJzaXRlcy93ZWJzaXRlZGV0YWlsLmNvbnRyb2xsZXIuanMiLCJsaWJyYXJ5L3dlYnNpdGVzL3dlYnNpdGVzLmNvbnRyb2xsZXIuanMiLCJtYW5hZ2UvdXNlcnMvdXNlci5qcyIsIm1hbmFnZS91c2Vycy91c2VyZGV0YWlsLmNvbnRyb2xsZXIuanMiLCJtYW5hZ2UvdXNlcnMvdXNlcnMuY29udHJvbGxlci5qcyIsIndpZGdldHMvaWNvbnMvbnRGYS5qcyIsIndpZGdldHMvbG9hZGluZy9udFNwaW5uZXIuanMiLCJ3aWRnZXRzL2xvYWRpbmcvc3Bpbm5lclNlcnZpY2UuanMiLCJ3aWRnZXRzL25hdmlnYXRpb24vbnRNaW5pU2lkZWJhci5qcyIsIndpZGdldHMvbmF2aWdhdGlvbi9udFNpZGVOYXZpZ2F0aW9uLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUEsV0FBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxhQUFBOztZQUVBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7OztZQUdBO1lBQ0E7WUFDQTs7O0FDZkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLGtCQUFBOztBQ0pBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxrQkFBQTs7QUNKQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUEsb0JBQUE7O0FDSkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLHFCQUFBOztBQ0pBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxvQkFBQTs7QUNKQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUEscUJBQUE7OztBQ0hBO0tBQ0EsT0FBQSxrQkFBQTs7UUFFQSxhQUFBLGNBQUE7OztRQUdBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7OztRQUdBO1FBQ0E7UUFDQTs7QUNuQkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLHVCQUFBOzs7O0FDSkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxP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QUFBLEtBQUEsWUFBQSxHQUFBLFFBQUE7Ozs7Ozs7OztBQzVFQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxJQUFBOzs7SUFHQSxTQUFBLGFBQUEsYUFBQTtRQUNBLFlBQUEsZ0JBQUE7OzJDQUNBOztJQUVBLFNBQUEsWUFBQTtRQUNBLE9BQUE7WUFDQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsVUFBQTtvQkFDQSxLQUFBOzs7WUFHQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsS0FBQTtvQkFDQSxPQUFBO3dCQUNBLFlBQUE7NEJBQ0EsYUFBQTs7O29CQUdBLE9BQUE7OztZQUdBO2dCQUNBLE9BQUE7Z0JBQ0EsUUFBQTtvQkFDQSxLQUFBO29CQUNBLE9BQUE7d0JBQ0EsWUFBQTs0QkFDQSxhQUFBOzs7b0JBR0EsT0FBQTs7OztLQUlBOzs7OztBQzlDQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxJQUFBOzs7SUFHQSxTQUFBLGFBQUEsYUFBQTtRQUNBLFlBQUEsZ0JBQUE7OzJDQUNBOztJQUVBLFNBQUEsWUFBQTtRQUNBLE9BQUE7WUFDQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsVUFBQTtvQkFDQSxLQUFBO29CQUNBLE9BQUE7OztZQUdBO2dCQUNBLE9BQUE7Z0JBQ0EsUUFBQTtvQkFDQSxLQUFBO29CQUNBLE9BQUE7d0JBQ0EsWUFBQTs0QkFDQSxhQUFBOzRCQUNBLFlBQUE7NEJBQ0EsY0FBQTs7O29CQUdBLE9BQUE7OztZQUdBO2dCQUNBLE9BQUE7Z0JBQ0EsUUFBQTtvQkFDQSxLQUFBO29CQUNBLE9BQUE7d0JBQ0EsWUFBQTs0QkFDQSxhQUFBOzRCQUNBLFlBQUE7NEJBQ0EsY0FBQTs7O29CQUdBLE9BQUE7Ozs7S0FJQTs7Ozs7OztBQ2pEQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLFVBQUE7OztJQUdBLFNBQUEsWUFBQSxRQUFBLGdCQUFBO1FBQ0EsSUFBQSxVQUFBO1lBQ0EsY0FBQTtZQUNBLG9CQUFBO1lBQ0EscUJBQUE7OztRQUdBLG9CQUFBO1FBQ0EsNEJBQUE7O1FBRUEsT0FBQTs7O1FBR0EsU0FBQSxhQUFBLFVBQUE7WUFDQSxJQUFBLFFBQUE7WUFDQSxXQUFBLFlBQUE7WUFDQSxJQUFBLE1BQUEsZUFBQSxXQUFBOztZQUVBLE9BQUEsbUJBQUEsT0FBQTs7O1FBR0EsU0FBQSxtQkFBQSxPQUFBLEtBQUEsUUFBQSxZQUFBO1lBQ0EsSUFBQSxlQUFBO2dCQUNBLGFBQUE7Z0JBQ0EsWUFBQTtnQkFDQSxVQUFBO2dCQUNBLFNBQUE7b0JBQ0EsU0FBQSxZQUFBO3dCQUNBLE9BQUE7NEJBQ0EsT0FBQTs0QkFDQSxTQUFBOzRCQUNBLFFBQUE7NEJBQ0EsWUFBQTs0QkFDQSxVQUFBOzRCQUNBLGlCQUFBOzs7Ozs7WUFNQSxPQUFBLE9BQUEsS0FBQSxjQUFBOzs7UUFHQSxTQUFBLG9CQUFBLE9BQUEsS0FBQSxRQUFBLFlBQUE7WUFDQSxJQUFBLGVBQUE7Z0JBQ0EsYUFBQTtnQkFDQSxZQUFBO2dCQUNBLFVBQUE7Z0JBQ0EsU0FBQTtvQkFDQSxTQUFBLFlBQUE7d0JBQ0EsT0FBQTs0QkFDQSxPQUFBOzRCQUNBLFNBQUE7NEJBQ0EsUUFBQTs0QkFDQSxZQUFBOzRCQUNBLFVBQUE7NEJBQ0EsaUJBQUE7Ozs7OztZQU1BLE9BQUEsT0FBQSxLQUFBLGNBQUE7Ozs7OztJQUtBLFNBQUEsY0FBQSxRQUFBLGdCQUFBLFNBQUE7UUFDQSxPQUFBLFFBQUEsUUFBQSxTQUFBO1FBQ0EsT0FBQSxVQUFBLFFBQUEsV0FBQTtRQUNBLE9BQUEsU0FBQSxRQUFBLFVBQUE7UUFDQSxPQUFBLGFBQUEsUUFBQSxjQUFBO1FBQ0EsT0FBQSxLQUFBLFlBQUE7WUFDQSxlQUFBLE1BQUE7O1FBRUEsT0FBQSxTQUFBLFlBQUE7WUFDQSxlQUFBLFFBQUE7Ozs7OztJQUtBLFNBQUEsMkJBQUEsUUFBQSxnQkFBQSxTQUFBO1FBQ0EsT0FBQSxRQUFBLFFBQUEsU0FBQTtRQUNBLE9BQUEsVUFBQSxRQUFBLFdBQUE7UUFDQSxPQUFBLFNBQUEsUUFBQSxVQUFBO1FBQ0EsT0FBQSxhQUFBLFFBQUEsY0FBQTtRQUNBLE9BQUEsV0FBQTtRQUNBLE9BQUEsa0JBQUE7UUFDQSxPQUFBLEtBQUEsWUFBQTtZQUNBLGVBQUEsTUFBQSxDQUFBLFVBQUEsT0FBQTs7UUFFQSxPQUFBLFNBQUEsWUFBQTtZQUNBLGVBQUEsUUFBQTs7Ozs7SUFJQSxTQUFBLG9CQUFBLGdCQUFBO1FBQ0EsZUFBQSxJQUFBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTs7O0lBR0EsU0FBQSw0QkFBQSxnQkFBQTtRQUNBLGVBQUEsSUFBQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBOzs7Ozs7OztBQ3BKQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLFVBQUE7O0lBRUEsU0FBQSxPQUFBLElBQUEsWUFBQSxVQUFBLFFBQUE7UUFDQSxJQUFBLFlBQUE7O1FBRUEsSUFBQSxVQUFBOztZQUVBLFlBQUE7WUFDQSxJQUFBO1lBQ0EsVUFBQTs7WUFFQSxVQUFBO1lBQ0EsbUJBQUE7WUFDQSxRQUFBO1lBQ0EsY0FBQTs7O1FBR0EsT0FBQTs7O1FBR0EsU0FBQSxhQUFBO1lBQ0EsT0FBQSxXQUFBLFdBQUEsTUFBQSxZQUFBOzs7O1FBSUEsU0FBQSxrQkFBQSxLQUFBLFVBQUEsT0FBQSxXQUFBOzs7O1lBSUEsSUFBQSxlQUFBO1lBQ0EsUUFBQSxTQUFBO1lBQ0EsSUFBQSxVQUFBLE1BQUE7Z0JBQ0EsU0FBQSxPQUFBLFVBQUE7Z0JBQ0EsVUFBQSxPQUFBOztZQUVBLElBQUEsV0FBQTtnQkFDQTttQkFDQTtnQkFDQSxVQUFBLE9BQUEsU0FBQSxVQUFBOzs7O1FBSUEsU0FBQSxTQUFBLEtBQUE7O1lBRUEsT0FBQSxDQUFBLGFBQUEsS0FBQTs7O1FBR0EsU0FBQSxhQUFBLE1BQUEsWUFBQTtZQUNBLE9BQUEsUUFBQSxDQUFBLE1BQUEsS0FBQSxjQUFBLFFBQUEsV0FBQTs7Ozs7Ozs7OztBQ3JEQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLGdCQUFBOzs7SUFHQSxTQUFBLGFBQUEsUUFBQTtRQUNBLElBQUEsVUFBQTtZQUNBLG1CQUFBO1lBQ0EsUUFBQTs7O1FBR0EsT0FBQTs7Ozs7O0FDbkJBLENBQUEsWUFBQTtJQUNBOztJQUVBLElBQUEsT0FBQSxRQUFBLE9BQUE7O0lBRUEsS0FBQSxPQUFBOzs7SUFHQSxTQUFBLGFBQUEsUUFBQTtRQUNBLE9BQUEsUUFBQSxVQUFBO1FBQ0EsT0FBQSxRQUFBLGNBQUE7UUFDQSxPQUFBLFFBQUEsY0FBQTtRQUNBLE9BQUEsUUFBQSxnQkFBQTs7OztJQUdBLElBQUEsV0FBQTtRQUNBLFdBQUE7UUFDQSxLQUFBO1FBQ0EsT0FBQTtRQUNBLEtBQUE7UUFDQSxPQUFBO1FBQ0EsUUFBQTtRQUNBLFVBQUE7UUFDQSxLQUFBO1FBQ0EsTUFBQTtRQUNBLE1BQUE7UUFDQSxJQUFBO1FBQ0EsT0FBQTtRQUNBLE1BQUE7UUFDQSxRQUFBO1FBQ0EsS0FBQTs7O0lBR0EsSUFBQSxTQUFBO1FBQ0EsMkJBQUE7UUFDQSxpQkFBQTtRQUNBLGtCQUFBO1FBQ0EsbUJBQUE7UUFDQSxTQUFBO1lBQ0EsT0FBQTtZQUNBLGNBQUE7WUFDQSxZQUFBOztRQUVBLDZCQUFBOzs7O0lBSUEsSUFBQSxTQUFBO1FBQ0EsZ0JBQUE7UUFDQSxVQUFBO1FBQ0EsVUFBQTtRQUNBLFNBQUE7UUFDQSxRQUFBOzs7SUFHQSxLQUFBLE1BQUEsVUFBQTs7SUFFQSxLQUFBLE9BQUE7OztJQUdBLFNBQUEsVUFBQSxvQkFBQTt1QkFDQSwyQkFBQTt1QkFDQSx3QkFBQTt1QkFDQSxxQkFBQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7OztRQUdBLFNBQUEsbUJBQUE7WUFDQSwwQkFBQSxPQUFBLHFCQUFBO1lBQ0EsMEJBQUEsT0FBQSxpQkFBQTs7WUFFQSwwQkFBQSxPQUFBLFFBQUEsT0FBQTs7O1FBR0EsU0FBQSxzQkFBQTtZQUNBLG9CQUFBLFdBQUE7Z0JBQ0EsaUJBQUE7Z0JBQ0EsVUFBQTtnQkFDQSxpQkFBQTs7OztRQUlBLFNBQUEsb0JBQUE7O1lBRUEsdUJBQUEsU0FBQTs7Z0JBRUEsU0FBQTtnQkFDQSxLQUFBO2dCQUNBLFFBQUEsT0FBQSxPQUFBOzs7Z0JBR0EsUUFBQTtnQkFDQSxnQkFBQSxPQUFBO2dCQUNBLFNBQUEsT0FBQSxLQUFBOzs7Z0JBR0EsU0FBQSxPQUFBOzs7O1FBSUEsU0FBQSxxQkFBQTtZQUNBLDBCQUFBO2dCQUNBO2dCQUNBOzs7O1FBSUEsU0FBQSx1QkFBQTtZQUNBLElBQUEsVUFBQTs7WUFFQSxvQkFBQSxXQUFBOzs7Ozs7QUNwSEEsQ0FBQSxXQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsU0FBQSxVQUFBO1NBQ0EsU0FBQSxVQUFBOzs7Ozs7O0FDRkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxRQUFBOzs7SUFHQSxTQUFBLE9BQUE7UUFDQSxJQUFBLGlCQUFBOztRQUVBLElBQUEsVUFBQTtZQUNBLGVBQUE7WUFDQSxjQUFBOzs7UUFHQSxPQUFBOzs7UUFHQSxTQUFBLGdCQUFBO1lBQ0EsT0FBQTs7UUFFQSxTQUFBLGFBQUEsTUFBQTtZQUNBLGlCQUFBOzs7Ozs7OztBQ3pCQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxJQUFBOzs7SUFHQSxTQUFBLGFBQUEsYUFBQTtRQUNBLFlBQUEsZ0JBQUE7OzJDQUNBOztJQUVBLFNBQUEsWUFBQTtRQUNBLE9BQUE7WUFDQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsVUFBQTtvQkFDQSxLQUFBO29CQUNBLGVBQUE7d0JBQ0EsT0FBQTs7OztZQUlBO2dCQUNBLE9BQUE7Z0JBQ0EsUUFBQTtvQkFDQSxLQUFBO29CQUNBLE9BQUE7d0JBQ0EsWUFBQTs0QkFDQSxhQUFBOzs7b0JBR0EsT0FBQTtvQkFDQSxlQUFBO3dCQUNBLE9BQUE7Ozs7O0tBS0E7Ozs7QUN6Q0EsQ0FBQSxXQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsU0FBQSxvQkFBQTtTQUNBLE9BQUE7Ozs7OztJQU1BLFNBQUEsMkJBQUE7O1FBRUEsS0FBQSxTQUFBO1lBQ0EsZ0JBQUE7OztRQUdBLEtBQUEsWUFBQSxVQUFBLGdCQUFBO1lBQ0EsS0FBQSxPQUFBLGlCQUFBOzs7UUFHQSxLQUFBLE9BQUEsV0FBQTtZQUNBLE9BQUEsQ0FBQSxRQUFBLEtBQUE7Ozs7Ozs7Ozs7O0lBV0EsU0FBQSxPQUFBLFVBQUE7UUFDQSxTQUFBLFVBQUEscUJBQUE7Ozs7Ozs7Ozs7O0lBVUEsU0FBQSx1QkFBQSxXQUFBLGtCQUFBLFFBQUE7UUFDQSxPQUFBLFNBQUEsV0FBQSxPQUFBO1lBQ0EsSUFBQSxpQkFBQSxpQkFBQSxPQUFBLGtCQUFBO1lBQ0EsSUFBQSxZQUFBLENBQUEsV0FBQSxXQUFBLE9BQUE7WUFDQSxVQUFBLFVBQUEsaUJBQUEsVUFBQTtZQUNBLFVBQUEsV0FBQTs7Ozs7Ozs7OztZQVVBLE9BQUEsTUFBQSxVQUFBLFNBQUE7Ozs7Ozs7Ozs7QUN6REEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxhQUFBOzs7SUFHQSxTQUFBLFVBQUEsUUFBQTtRQUNBLElBQUEsVUFBQTtZQUNBLFNBQUE7O1FBRUEsT0FBQTs7UUFFQSxTQUFBLFFBQUEsU0FBQTtZQUNBLE9BQUEsU0FBQSxRQUFBO2dCQUNBLE9BQUEsTUFBQSxTQUFBOzs7Ozs7Ozs7OztBQ2hCQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLFVBQUE7O0lBRUEsT0FBQSxVQUFBLENBQUEsUUFBQTs7SUFFQSxTQUFBLE9BQUEsTUFBQSxRQUFBO1FBQ0EsSUFBQSxVQUFBO1lBQ0EsWUFBQTs7WUFFQSxPQUFBO1lBQ0EsTUFBQTtZQUNBLFNBQUE7WUFDQSxTQUFBOztZQUVBLFNBQUE7WUFDQSxPQUFBOzs7WUFHQSxLQUFBLEtBQUE7OztRQUdBLE9BQUE7OztRQUdBLFNBQUEsTUFBQSxTQUFBLE1BQUEsT0FBQTtZQUNBLE9BQUEsTUFBQSxTQUFBO1lBQ0EsS0FBQSxNQUFBLFdBQUEsU0FBQTs7O1FBR0EsU0FBQSxLQUFBLFNBQUEsTUFBQSxPQUFBO1lBQ0EsT0FBQSxLQUFBLFNBQUE7WUFDQSxLQUFBLEtBQUEsV0FBQSxTQUFBOzs7UUFHQSxTQUFBLFFBQUEsU0FBQSxNQUFBLE9BQUE7WUFDQSxPQUFBLFFBQUEsU0FBQTtZQUNBLEtBQUEsS0FBQSxhQUFBLFNBQUE7OztRQUdBLFNBQUEsUUFBQSxTQUFBLE1BQUEsT0FBQTtZQUNBLE9BQUEsUUFBQSxTQUFBO1lBQ0EsS0FBQSxLQUFBLGFBQUEsU0FBQTs7O1FBR0EsU0FBQSxRQUFBLFNBQUEsTUFBQSxPQUFBO1lBQ0EsT0FBQSxRQUFBLFNBQUE7WUFDQSxLQUFBLEtBQUEsaUJBQUEsU0FBQTs7O1FBR0EsU0FBQSxNQUFBLFNBQUEsTUFBQSxPQUFBO1lBQ0EsT0FBQSxRQUFBLFNBQUE7WUFDQSxLQUFBLEtBQUEsY0FBQSxTQUFBOzs7Ozs7Ozs7QUN2REEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsU0FBQSxxQkFBQTtTQUNBLFFBQUEsZUFBQTs7SUFFQSxZQUFBLFVBQUEsQ0FBQSxxQkFBQSxjQUFBOztJQUVBLFNBQUEsb0JBQUE7O1FBRUEsS0FBQSxTQUFBOztRQUVBLEtBQUEsT0FBQSxZQUFBO1lBQ0EsT0FBQTtnQkFDQSxRQUFBLEtBQUE7Ozs7O0lBS0EsU0FBQSxZQUFBLG1CQUFBLFlBQUEsUUFBQTtRQUNBLElBQUEscUJBQUEsa0JBQUEsT0FBQTtRQUNBLElBQUEsaUJBQUEsa0JBQUEsT0FBQTs7UUFFQSxJQUFBLFVBQUE7WUFDQSxpQkFBQTtZQUNBLFFBQUE7WUFDQSxLQUFBOzs7UUFHQTs7UUFFQSxPQUFBOzs7UUFHQSxTQUFBLGdCQUFBLFFBQUE7WUFDQSxPQUFBLFFBQUEsVUFBQSxPQUFBO2dCQUNBLElBQUEsTUFBQSxPQUFBLE9BQUE7b0JBQ0EsTUFBQSxPQUFBLGdCQUFBO3dCQUNBLE9BQUEsTUFBQSxPQUFBLE1BQUE7Ozs7Z0JBSUEsZUFBQSxNQUFBLE1BQUEsT0FBQSxNQUFBOzs7O1FBSUEsU0FBQSxTQUFBO1lBQ0EsT0FBQSxPQUFBOzs7UUFHQSxTQUFBLElBQUEsU0FBQTtZQUNBLElBQUEsU0FBQTtZQUNBLFNBQUEsUUFBQSxVQUFBLE9BQUE7Z0JBQ0EsSUFBQSxNQUFBLFNBQUEsU0FBQTtvQkFDQSxTQUFBOzs7WUFHQSxPQUFBOzs7O1FBSUEsU0FBQSxPQUFBO1lBQ0E7WUFDQSxtQkFBQSxVQUFBOzs7UUFHQSxTQUFBLGlCQUFBO1lBQ0EsV0FBQSxJQUFBO2dCQUNBLFVBQUEsT0FBQSxTQUFBLFVBQUE7b0JBQ0EsSUFBQSxRQUFBLGtCQUFBLE9BQUEsU0FBQSxRQUFBLFFBQUEsUUFBQSxRQUFBLFFBQUE7b0JBQ0EsV0FBQSxRQUFBO29CQUNBLFdBQUEsU0FBQTs7Ozs7OztBQzlFQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLHVCQUFBOzs7SUFHQSxTQUFBLG1CQUFBLFFBQUEsUUFBQSxVQUFBLGFBQUE7O1FBRUEsSUFBQSxhQUFBO1lBQ0EsWUFBQSxPQUFBLFVBQUEsT0FBQSxNQUFBLE1BQUE7WUFDQSxTQUFBLE9BQUEsVUFBQSxPQUFBLE1BQUEsTUFBQTs7UUFFQSxJQUFBLEtBQUEsT0FBQTs7UUFFQSxTQUFBLEtBQUEsZUFBQSxZQUFBOztZQUVBLEtBQUEsYUFBQTtZQUNBLEtBQUEsVUFBQSxRQUFBLEtBQUE7WUFDQSxLQUFBLHlCQUFBLHVCQUFBLEtBQUE7WUFDQSxLQUFBLFNBQUEsT0FBQTtZQUNBLEtBQUEsVUFBQTtZQUNBLEtBQUEsY0FBQSxZQUFBLEtBQUE7Ozs7UUFJQSxLQUFBLFlBQUE7WUFDQSxhQUFBO1lBQ0EsSUFBQTtZQUNBLFFBQUE7WUFDQSxhQUFBO1lBQ0EscUJBQUE7WUFDQSxZQUFBO1lBQ0Esa0JBQUE7WUFDQSxVQUFBO1lBQ0EsYUFBQTs7O1FB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QUEsR0FBQSxNQUFBLE9BQUE7Ozs7UUFJQSxTQUFBLFNBQUEsY0FBQTtZQUNBLEdBQUEsVUFBQTs7WUFFQSxJQUFBLGNBQUE7Z0JBQ0EsSUFBQSxHQUFBLE9BQUE7b0JBQ0EsR0FBQSxNQUFBOzs7WUFHQSxLQUFBLFVBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsR0FBQSxRQUFBLEdBQUEsZ0JBQUE7Z0JBQ0EsR0FBQSxVQUFBOztnQkFFQSxPQUFBLEdBQUE7Ozs7O1FBS0EsU0FBQSxTQUFBLE1BQUE7WUFDQSxJQUFBLFFBQUEsS0FBQSxJQUFBO2dCQUNBLE9BQUEsR0FBQSx1QkFBQSxDQUFBLElBQUEsS0FBQTs7OztRQUlBLFNBQUEsVUFBQTtZQUNBLEdBQUEsYUFBQTtZQUNBLFNBQUE7OztRQUdBLFNBQUEsT0FBQSxRQUFBO1lBQ0EsSUFBQSxPQUFBLFlBQUEsU0FBQSxLQUFBO2dCQUNBLEdBQUEsYUFBQTs7WUFFQTs7O1FBR0EsU0FBQSxXQUFBLE1BQUE7WUFDQSxJQUFBLFVBQUE7WUFDQSxJQUFBLEdBQUEsWUFBQTtnQkFDQSxVQUFBLE9BQUEsYUFBQSxLQUFBLE1BQUEsR0FBQTtnQkFDQSxXQUFBLE9BQUEsYUFBQSxLQUFBLFVBQUEsR0FBQTs7O1lBR0EsT0FBQTs7Ozs7Ozs7O0FDOUVBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFVBQUEsUUFBQTs7SUFFQSxLQUFBLFVBQUE7O0lBRUEsU0FBQSxPQUFBO1FBQ0EsSUFBQSxZQUFBO1lBQ0EsVUFBQTtZQUNBLE1BQUE7OztRQUdBLE9BQUE7OztRQUdBLFNBQUEsU0FBQSxPQUFBLFNBQUEsT0FBQTtZQUNBLElBQUEsSUFBQSxRQUFBLFFBQUE7WUFDQSxJQUFBLFVBQUEsTUFBQSxLQUFBLE1BQUE7O1lBRUEsUUFBQSxRQUFBLFNBQUEsVUFBQSxPQUFBO2dCQUNBLEVBQUEsU0FBQSxRQUFBOzs7WUFHQSxRQUFBLFlBQUE7Ozs7Ozs7Ozs7QUMxQkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsVUFBQSxhQUFB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QUE7WUFDQSxjQUFBO1lBQ0Esa0JBQUE7Ozs7UUFHQSxPQUFBOzs7O1FBSUEsU0FBQSxtQkFBQSxVQUFBO1lBQ0EsSUFBQSxLQUFBO1lBQ0EsR0FBQSxhQUFBOzs7WUFHQSxTQUFBLGFBQUE7Z0JBQ0EsUUFBQSxRQUFBLFFBQUEsWUFBQTtnQkFDQSxJQUFBLENBQUEsUUFBQSxRQUFBLFFBQUEsU0FBQSxrQkFBQSxRQUFBLFFBQUEsUUFBQSxTQUFBLGVBQUE7O29CQUVBLFFBQUEsUUFBQSxjQUFBOztvQkFFQTt3QkFDQSxZQUFBOzRCQUNBLFFBQUEsUUFBQSxjQUFBLE9BQUE7MkJBQ0E7dUJBQ0EsSUFBQSxRQUFBLFFBQUEsUUFBQSxTQUFBLGtCQUFBO29CQUNBLFFBQUEsUUFBQSxjQUFBO29CQUNBO3dCQUNBLFlBQUE7NEJBQ0EsUUFBQSxRQUFBLGNBQUEsT0FBQTsyQkFDQTt1QkFDQTs7b0JBRUEsUUFBQSxRQUFBLGNBQUEsV0FBQTs7Ozs7Ozs7Ozs7O0FDaERBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFVBQUEsb0JBQUE7OztJQUdBLFNBQUEsaUJBQUEsVUFBQTtRQUNBLElBQUEsWUFBQTtZQUNBLFVBQUE7WUFDQSxNQUFBOzs7UUFHQSxPQUFBOzs7UUFHQSxTQUFBLFNBQUEsT0FBQSxTQUFBO1lBQ0EsU0FBQSxZQUFBO2dCQUNBLEVBQUEsU0FBQTs7U0FFQTs7Ozs7QUFJQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzJywgW1xuICAgICAgICAgICAgLy9zaGFyZWQgbW9kdWxlc1xuICAgICAgICAgICAgJ25vdG9zcGx1cy5jb3JlJyxcbiAgICAgICAgICAgICdub3Rvc3BsdXMud2lkZ2V0cycsXG4gICAgICAgICAgICAnbm90b3NwbHVzLmF1dGgnLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy5kYXRhJyxcbiAgICAgICAgICAgICdub3Rvc3BsdXMubGF5b3V0JyxcblxuICAgICAgICAgICAgLy9hcHAgbW9kdWxlc1xuICAgICAgICAgICAgJ25vdG9zcGx1cy5kYXNoYm9hcmQnLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy5tYW5hZ2UnLFxuICAgICAgICAgICAgJ25vdG9zcGx1cy5saWJyYXJ5J1xuICAgICAgICBdKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5hdXRoJywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmRhdGEnLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubGF5b3V0JywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxpYnJhcnknLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubWFuYWdlJywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLndpZGdldHMnLCBbXSk7XG59KSgpOyIsIlxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jb3JlJywgW1xuICAgICAgICAvL0FuZ3VsYXJcbiAgICAgICAgJ25nQW5pbWF0ZScsICduZ1Nhbml0aXplJywgJ25nUmVzb3VyY2UnLFxuXG4gICAgICAgIC8vM3JkIHBhcnR5XG4gICAgICAgICd1aS5ib290c3RyYXAnLFxuICAgICAgICAnbmN5LWFuZ3VsYXItYnJlYWRjcnVtYicsXG4gICAgICAgICdicmVlemUuYW5ndWxhcicsICAgLy8gdGVsbHMgYnJlZXplIHRvIHVzZSAkcSBpbnN0ZWFkIG9mIFEuanNcbiAgICAgICAgJ2JyZWV6ZS5kaXJlY3RpdmVzJywvLyBicmVlemUgdmFsaWRhdGlvbiBkaXJlY3RpdmUgKHpWYWxpZGF0ZSksXG4gICAgICAgICduZ3pXaXAnLFxuICAgICAgICAnbmdwbHVzJyxcbiAgICAgICAgJ3Jlc3Rhbmd1bGFyJyxcbiAgICAgICAgJ2NoZWNrbGlzdC1tb2RlbCcsXG5cbiAgICAgICAgLy9jcm9zcyBhcHAgbW9kdWxlc1xuICAgICAgICAnYmxvY2tzLmV4Y2VwdGlvbicsXG4gICAgICAgICdibG9ja3MubG9nZ2VyJyxcbiAgICAgICAgJ2Jsb2Nrcy5yb3V0ZXInXG4gICAgXSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5kYXNoYm9hcmQnLCBbXG5cbiAgICAgICAgXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJywgWydibG9ja3MubG9nZ2VyJ10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicsIFtdKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInLCBbXG4gICAgICAgICAgICAndWkucm91dGVyJ1xuICAgICAgICBdKTtcbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuYXV0aFxuICogRkFDVE9SWTogUHJvZmlsZVxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuYXV0aCcpXG4gICAgICAgIC5mYWN0b3J5KCdQcm9maWxlU2VydmljZScsIFByb2ZpbGVTZXJ2aWNlKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFByb2ZpbGVTZXJ2aWNlKCRodHRwLCBleGNlcHRpb24sICRxLCBjb21tb24sIGNvbmZpZykge1xuICAgICAgICB2YXIgY2FjaGUgPSBudWxsO1xuICAgICAgICB2YXIgX3JlYWxtID0gbnVsbDtcbiAgICAgICAgdmFyIGV2ZW50cyA9IGNvbmZpZy5ldmVudHM7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBjdXJyZW50OiBjdXJyZW50LFxuICAgICAgICAgICAgcmVhbG06IHJlYWxtLFxuICAgICAgICAgICAgc2V0UmVhbG06IHNldFJlYWxtXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gY3VycmVudChmb3JjZVJlZnJlc2gpIHtcbiAgICAgICAgICAgIGlmIChjYWNoZSAmJiAhZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgLy9zaG91bGQgcmV0dXJuIHByb21pc2VcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEud2hlbihjYWNoZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlci9wcm9maWxlJylcbiAgICAgICAgICAgICAgICAudGhlbihnZXRDdXJyZW50Q29tcGxldGUpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4Y2VwdGlvbi5jYXRjaGVyKCdQcm9maWVsIHZhbiBkZSBodWlkaWdlIGdlYnJ1aWtlciBvcHZyYWdlbiwgbHVrdCBuaWV0LicpKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRDb21wbGV0ZShyZXNwb25zZSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBjYWNoZSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgc2VydmljZS5zZXRSZWFsbShyZXNwb25zZS5kYXRhLnJlYWxtKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVhbG0oKSB7XG4gICAgICAgICAgICByZXR1cm4gX3JlYWxtOyAvL3N5bmNocm9ub3VzLCBhcyBhc3luYyBkYXRhIHdhcyBoZXJlIGF0IGluaXRpYWxpemF0aW9uXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRSZWFsbShyZWFsbSkge1xuICAgICAgICAgICAgLy9yZWFsbS5kb21haW5fbmFtZT0gcmVhbG0uZG9tYWluX25hbWUucmVwbGFjZSgvXFwuL2csICdfJyk7XG4gICAgICAgICAgICBfcmVhbG0gPSByZWFsbTtcbiAgICAgICAgICAgIGNvbW1vbi4kYnJvYWRjYXN0KGV2ZW50cy5yZWFsbUNoYW5nZWQsIHJlYWxtKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5kYXRhXG4gKiBGQUNUT1JZOiBIVFRQQ2FjaGVcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmRhdGEnKVxuICAgICAgICAuZmFjdG9yeSgnSFRUUENhY2hlJywgSFRUUENhY2hlKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEhUVFBDYWNoZShSZXN0YW5ndWxhciwgJGNhY2hlRmFjdG9yeSkge1xuICAgICAgICB2YXIgY2FjaGU7XG4gICAgICAgIGNhY2hlID0gJGNhY2hlRmFjdG9yeSgnaHR0cCcpO1xuXG4gICAgICAgIHJldHVybiBSZXN0YW5ndWxhci53aXRoQ29uZmlnKGZ1bmN0aW9uIChSZXN0YW5ndWxhckNvbmZpZ3VyZXIpIHtcbiAgICAgICAgICAgIFJlc3Rhbmd1bGFyQ29uZmlndXJlci5zZXREZWZhdWx0SHR0cEZpZWxkcyh7Y2FjaGU6IGNhY2hlfSk7XG4gICAgICAgICAgICBSZXN0YW5ndWxhckNvbmZpZ3VyZXIuc2V0UmVzcG9uc2VJbnRlcmNlcHRvcihmdW5jdGlvbiAocmVzcG9uc2UsIG9wZXJhdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChvcGVyYXRpb24gPT09ICdwdXQnIHx8IG9wZXJhdGlvbiA9PT0gJ3Bvc3QnIHx8IG9wZXJhdGlvbiA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGUucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBDdXN0b20gR2xvYmFsIE1ldGhvZChzKSBmb3IgUmVzdGFuZ3VsYXJpemVkIEVsZW1lbnRzLlxuICAgICAgICAgICAgUmVzdGFuZ3VsYXJDb25maWd1cmVyLnNldE9uRWxlbVJlc3Rhbmd1bGFyaXplZChmdW5jdGlvbihlbGVtLCBpc0NvbGxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBlbGVtLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGUucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMubGF5b3V0XG4gKiBDT05UUk9MTEVSOiBzaGVsbFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxheW91dCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdTaGVsbENvbnRyb2xsZXInLCBTaGVsbENvbnRyb2xsZXIpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gU2hlbGxDb250cm9sbGVyKEluaXQsICRyb290U2NvcGUsIGNvbmZpZywgUHJvZmlsZVNlcnZpY2UsIGxvZ2dlcikge1xuICAgICAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5idXN5TWVzc2FnZSA9ICdFdmVuIGdlZHVsZC4uLic7XG4gICAgICAgIHZtLmlzQnVzeSA9IHRydWU7XG4gICAgICAgIHZtLnNob3dTcGxhc2ggPSBmYWxzZTtcbiAgICAgICAgdm0uYXZhdGFyID0gbnVsbDtcbiAgICAgICAgdm0ucHJvZmlsZSA9IHt9O1xuICAgICAgICB2bS5sb2dnZWRJbk9yZ2FuaXphdGlvbiA9IG51bGw7XG5cbiAgICAgICAgdmFyIGV2ZW50cyA9IGNvbmZpZy5ldmVudHM7XG5cbiAgICAgICAgYWN0aXZhdGUoKTtcbiAgICAgICAgLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuXG4gICAgICAgICAgICBpZiAoIUluaXQuaXNJbml0aWFsaXplZCgpKSB7XG4gICAgICAgICAgICAgICAgdm0uc2hvd1NwbGFzaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgSW5pdC5pbml0aWFsaXppbmcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgZ2V0UHJvZmlsZSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2bS5wcm9maWxlID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgdm0ucHJvZmlsZS5mdWxsTmFtZSA9IHZtLnByb2ZpbGUuZmlyc3RfbmFtZSArICcgJyArIHZtLnByb2ZpbGUubGFzdF9uYW1lO1xuICAgICAgICAgICAgICAgICAgICAvL3ZtLnByb2ZpbGUub3JnYW5pemF0aW9ucyA9IHByb2ZpbGUub3JnYW5pemF0aW9ucztcblxuICAgICAgICAgICAgICAgICAgICB2bS5hdmF0YXIgPVxuICAgICAgICAgICAgICAgICAgICAgICAgdm0ucHJvZmlsZS5hdmF0YXIgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICh2bS5wcm9maWxlLmdlbmRlciA9PT0gJ0YnID8gJy9pbWcvdXNlci9mZW1hbGUucG5nJyA6ICcvaW1nL3VzZXIvbWFsZS5wbmcnKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgJy9pbWcvdXNlci9tYWxlLnBuZyc7XG5cbiAgICAgICAgICAgICAgICAgICAgaW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2ZpbGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvZmlsZVNlcnZpY2UuY3VycmVudCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS5wcm9maWxlID0gZGF0YTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0ucHJvZmlsZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlU3Bpbm5lcihvbikge1xuICAgICAgICAgICAgdm0uaXNCdXN5ID0gb247XG4gICAgICAgIH1cblxuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLFxuICAgICAgICAgICAgZnVuY3Rpb24gKGV2ZW50LCBuZXh0LCBjdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgdG9nZ2xlU3Bpbm5lcih0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICAkcm9vdFNjb3BlLiRvbihldmVudHMuY29udHJvbGxlckFjdGl2YXRlU3VjY2VzcyxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdG9nZ2xlU3Bpbm5lcihmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgICRyb290U2NvcGUuJG9uKGV2ZW50cy5yZWFsbUNoYW5nZWQsXG4gICAgICAgICAgICBmdW5jdGlvbiAoc2NvcGUsIHJlYWxtKSB7XG4gICAgICAgICAgICAgICAgdm0ucmVhbG0gPSByZWFsbTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemVkKCkge1xuICAgICAgICAgICAgdm0uc2hvd1NwbGFzaCA9IGZhbHNlO1xuXG4gICAgICAgICAgICBsb2dnZXIuaW5mbygnV2Vsa29tICcgKyB2bS5wcm9maWxlLmZpcnN0X25hbWUpO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIi8qKlxuICogUk9VVEVTOiBub3Rvc3BsdXMubGlicmFyeVxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxpYnJhcnknKVxuICAgICAgICAucnVuKGNvbmZpZ1JvdXRlcyk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWdSb3V0ZXMocm91dGVoZWxwZXIpIHtcbiAgICAgICAgcm91dGVoZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGlicmFyeScsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvbGlicmFyeSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGlicmFyeS5ib29rcycsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9ib29rcycsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL2xpYnJhcnkvYm9va3MvYm9va3MuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdCb2VrZW4nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xpYnJhcnkud2Vic2l0ZXMnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvd2Vic2l0ZXMnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvbW9kdWxlcy9saWJyYXJ5L3dlYnNpdGVzL3dlYnNpdGVzLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnV2Vic2l0ZXMnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH07XG59KSgpOyIsIi8qKlxuICogUk9VVEVTOiBub3Rvc3BsdXMubWFuYWdlXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubWFuYWdlJylcbiAgICAgICAgLnJ1bihjb25maWdSb3V0ZXMpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlnUm91dGVzKHJvdXRlaGVscGVyKSB7XG4gICAgICAgIHJvdXRlaGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ21hbmFnZScsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvbWFuYWdlJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdCZWhlZXInXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ21hbmFnZS51c2VycycsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy91c2VycycsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL21hbmFnZS91c2Vycy91c2Vycy5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVXNlcnNDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdHZWJydWlrZXJzJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdtYW5hZ2UudXNlcnMuZGV0YWlsJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLzppZCcsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL21hbmFnZS91c2Vycy91c2VyZGV0YWlsLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdVc2VyRGV0YWlsQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnR2VicnVpa2VyIGJld2Vya2VuJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9O1xufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5jb3JlXG4gKiBGQUNUT1JZOiBib290c3RyYXAuZGlhbG9nXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jb3JlJylcbiAgICAgICAgLmZhY3RvcnkoJ0RpYWxvZycsIG1vZGFsRGlhbG9nKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIG1vZGFsRGlhbG9nKCRtb2RhbCwgJHRlbXBsYXRlQ2FjaGUpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBkZWxldGVEaWFsb2c6IGRlbGV0ZURpYWxvZyxcbiAgICAgICAgICAgIGNvbmZpcm1hdGlvbkRpYWxvZzogY29uZmlybWF0aW9uRGlhbG9nLFxuICAgICAgICAgICAgcmVzZXRQYXNzd29yZERpYWxvZzogcmVzZXRQYXNzd29yZERpYWxvZ1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlZ2lzdGVyTW9kZWxEaWFsb2coJHRlbXBsYXRlQ2FjaGUpO1xuICAgICAgICByZWdpc3RlclJlc2V0UGFzc3dvcmREaWFsb2coJHRlbXBsYXRlQ2FjaGUpO1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlRGlhbG9nKGl0ZW1OYW1lKSB7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSAnQmVuIGplIHpla2VyPyc7XG4gICAgICAgICAgICBpdGVtTmFtZSA9IGl0ZW1OYW1lIHx8ICdpdGVtJztcbiAgICAgICAgICAgIHZhciBtc2cgPSAnVmVyd2lqZGVyICcgKyBpdGVtTmFtZSArICc/JztcblxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1hdGlvbkRpYWxvZyh0aXRsZSwgbXNnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbmZpcm1hdGlvbkRpYWxvZyh0aXRsZSwgbXNnLCBva1RleHQsIGNhbmNlbFRleHQpIHtcbiAgICAgICAgICAgIHZhciBtb2RhbE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2RhbERpYWxvZy50cGwuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogTW9kYWxJbnN0YW5jZSxcbiAgICAgICAgICAgICAgICBrZXlib2FyZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1zZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBva1RleHQ6IG9rVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5jZWxUZXh0OiBjYW5jZWxUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtUGFzc3dvcmQ6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuICRtb2RhbC5vcGVuKG1vZGFsT3B0aW9ucykucmVzdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRQYXNzd29yZERpYWxvZyh0aXRsZSwgbXNnLCBva1RleHQsIGNhbmNlbFRleHQpIHtcbiAgICAgICAgICAgIHZhciBtb2RhbE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdyZXNldFBhc3N3b3JkRGlhbG9nLnRwbC5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBSZXNldFBhc3N3b3JkTW9kYWxJbnN0YW5jZSxcbiAgICAgICAgICAgICAgICBrZXlib2FyZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1zZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBva1RleHQ6IG9rVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5jZWxUZXh0OiBjYW5jZWxUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtUGFzc3dvcmQ6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuICRtb2RhbC5vcGVuKG1vZGFsT3B0aW9ucykucmVzdWx0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gTW9kYWxJbnN0YW5jZSgkc2NvcGUsICRtb2RhbEluc3RhbmNlLCBvcHRpb25zKSB7XG4gICAgICAgICRzY29wZS50aXRsZSA9IG9wdGlvbnMudGl0bGUgfHwgJ1RpdGVsJztcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBvcHRpb25zLm1lc3NhZ2UgfHwgJyc7XG4gICAgICAgICRzY29wZS5va1RleHQgPSBvcHRpb25zLm9rVGV4dCB8fCAnT2snO1xuICAgICAgICAkc2NvcGUuY2FuY2VsVGV4dCA9IG9wdGlvbnMuY2FuY2VsVGV4dCB8fCAnQW5udWxlcmVuJztcbiAgICAgICAgJHNjb3BlLm9rID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoJ29rJyk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBSZXNldFBhc3N3b3JkTW9kYWxJbnN0YW5jZSgkc2NvcGUsICRtb2RhbEluc3RhbmNlLCBvcHRpb25zKSB7XG4gICAgICAgICRzY29wZS50aXRsZSA9IG9wdGlvbnMudGl0bGUgfHwgJ1Bhc3dvb3JkIG9wbmlldXcgaW5zdGVsbGVuJztcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBvcHRpb25zLm1lc3NhZ2UgfHwgJ0dlZWYgaGV0IG5pZXV3ZSBwYXN3b29yZCBpbi4nO1xuICAgICAgICAkc2NvcGUub2tUZXh0ID0gb3B0aW9ucy5va1RleHQgfHwgJ1dpanppZyc7XG4gICAgICAgICRzY29wZS5jYW5jZWxUZXh0ID0gb3B0aW9ucy5jYW5jZWxUZXh0IHx8ICdBbm51bGVyZW4nO1xuICAgICAgICAkc2NvcGUucGFzc3dvcmQgPSAnJztcbiAgICAgICAgJHNjb3BlLmNvbmZpcm1QYXNzd29yZCA9ICcnO1xuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSh7cGFzc3dvcmQ6ICRzY29wZS5wYXNzd29yZH0pO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJNb2RlbERpYWxvZygkdGVtcGxhdGVDYWNoZSkge1xuICAgICAgICAkdGVtcGxhdGVDYWNoZS5wdXQoJ21vZGFsRGlhbG9nLnRwbC5odG1sJyxcbiAgICAgICAgICAgICc8ZGl2PicgK1xuICAgICAgICAgICAgJyAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCIgZGF0YS1kaXNtaXNzPVwibW9kYWxcIiAnICtcbiAgICAgICAgICAgICcgICAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIiBkYXRhLW5nLWNsaWNrPVwiY2FuY2VsKClcIj4mdGltZXM7PC9idXR0b24+JyArXG4gICAgICAgICAgICAnICAgICAgICA8aDM+e3t0aXRsZX19PC9oMz4nICtcbiAgICAgICAgICAgICcgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8cD57e21lc3NhZ2V9fTwvcD4nICtcbiAgICAgICAgICAgICcgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1mb290ZXJcIj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIiBkYXRhLW5nLWNsaWNrPVwib2soKVwiPnt7b2tUZXh0fX08L2J1dHRvbj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLWluZm9cIiBkYXRhLW5nLWNsaWNrPVwiY2FuY2VsKClcIj57e2NhbmNlbFRleHR9fTwvYnV0dG9uPicgK1xuICAgICAgICAgICAgJyAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICc8L2Rpdj4nKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWdpc3RlclJlc2V0UGFzc3dvcmREaWFsb2coJHRlbXBsYXRlQ2FjaGUpIHtcbiAgICAgICAgJHRlbXBsYXRlQ2FjaGUucHV0KCdyZXNldFBhc3N3b3JkRGlhbG9nLnRwbC5odG1sJyxcbiAgICAgICAgICAgICc8ZGl2PicgK1xuICAgICAgICAgICAgJyAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCIgZGF0YS1kaXNtaXNzPVwibW9kYWxcIiAnICtcbiAgICAgICAgICAgICcgICAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIiBkYXRhLW5nLWNsaWNrPVwiY2FuY2VsKClcIj4mdGltZXM7PC9idXR0b24+JyArXG4gICAgICAgICAgICAnICAgICAgICA8aDM+e3t0aXRsZX19PC9oMz4nICtcbiAgICAgICAgICAgICcgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+JyArXG4gICAgICAgICAgICAnICAgICAgICA8cD57e21lc3NhZ2V9fTwvcD4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+JyArXG4gICAgICAgICAgICAnICAgICAgICAgICA8bGFiZWwgY2xhc3M9XCJjb250cm9sLWxhYmVsXCI+UGFzd29vcmQ8L2xhYmVsPicgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgPGlucHV0IHR5cGU9XCJwYXNzd29yZFwiIGRhdGEtbmctbW9kZWw9XCJwYXNzd29yZFwiIHBsYWNlaG9sZGVyPVwiTmlldXcgcGFzd29vcmRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwiY29udHJvbC1sYWJlbFwiPkhlcmhhYWwgcGFzc3dvcmQ8L2xhYmVsPicgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgPGlucHV0IHR5cGU9XCJwYXNzd29yZFwiIGRhdGEtbmctbW9kZWw9XCJjb25maXJtUGFzc3dvcmRcIiBwbGFjZWhvbGRlcj1cIkhlcmhhYWwgcGFzd29vcmRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPC9kaXY+JyArXG4gICAgICAgICAgICAnICAgICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJ0ZXh0LWRhbmdlclwiIGRhdGEtbmctc2hvdz1cInBhc3N3b3JkICE9PSBjb25maXJtUGFzc3dvcmQgJiYgcGFzc3dvcmQgIT09IFxcJ1xcJ1wiPkRlIHBhc3dvb3JkZW4ga29tZW4gbmlldCBvdmVyZWVuLjwvc3Bhbj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDwvZGl2PicgK1xuICAgICAgICAgICAgJyAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICcgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPicgK1xuICAgICAgICAgICAgJyAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIGRhdGEtbmctY2xpY2s9XCJvaygpXCIgZGF0YS1uZy1kaXNhYmxlZD1cInBhc3N3b3JkICE9PSBjb25maXJtUGFzc3dvcmQgfHwgcGFzc3dvcmQgPT09IFxcJ1xcJ1wiPnt7b2tUZXh0fX08L2J1dHRvbj4nICtcbiAgICAgICAgICAgICcgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLWluZm9cIiBkYXRhLW5nLWNsaWNrPVwiY2FuY2VsKClcIj57e2NhbmNlbFRleHR9fTwvYnV0dG9uPicgK1xuICAgICAgICAgICAgJyAgICA8L2Rpdj4nICtcbiAgICAgICAgICAgICc8L2Rpdj4nKTtcbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmNvcmVcbiAqIEZBQ1RPUlk6IGNvbW1vblxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuY29yZScpXG4gICAgICAgIC5mYWN0b3J5KCdjb21tb24nLCBjb21tb24pO1xuXG4gICAgZnVuY3Rpb24gY29tbW9uKCRxLCAkcm9vdFNjb3BlLCAkdGltZW91dCwgbG9nZ2VyKSB7XG4gICAgICAgIHZhciB0aHJvdHRsZXMgPSB7fTtcblxuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIC8vIGNvbW1vbiBhbmd1bGFyIGRlcGVuZGVuY2llc1xuICAgICAgICAgICAgJGJyb2FkY2FzdDogJGJyb2FkY2FzdCxcbiAgICAgICAgICAgICRxOiAkcSxcbiAgICAgICAgICAgICR0aW1lb3V0OiAkdGltZW91dCxcbiAgICAgICAgICAgIC8vIGdlbmVyaWNcbiAgICAgICAgICAgIGlzTnVtYmVyOiBpc051bWJlcixcbiAgICAgICAgICAgIGRlYm91bmNlZFRocm90dGxlOiBkZWJvdW5jZWRUaHJvdHRsZSxcbiAgICAgICAgICAgIGxvZ2dlcjogbG9nZ2VyLFxuICAgICAgICAgICAgdGV4dENvbnRhaW5zOiB0ZXh0Q29udGFpbnNcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiAkYnJvYWRjYXN0KCkge1xuICAgICAgICAgICAgcmV0dXJuICRyb290U2NvcGUuJGJyb2FkY2FzdC5hcHBseSgkcm9vdFNjb3BlLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG5cblxuICAgICAgICBmdW5jdGlvbiBkZWJvdW5jZWRUaHJvdHRsZShrZXksIGNhbGxiYWNrLCBkZWxheSwgaW1tZWRpYXRlKSB7XG4gICAgICAgICAgICAvLyBQZXJmb3JtIHNvbWUgYWN0aW9uIChjYWxsYmFjaykgYWZ0ZXIgYSBkZWxheS5cbiAgICAgICAgICAgIC8vIFRyYWNrIHRoZSBjYWxsYmFjayBieSBrZXksIHNvIGlmIHRoZSBzYW1lIGNhbGxiYWNrXG4gICAgICAgICAgICAvLyBpcyBpc3N1ZWQgYWdhaW4sIHJlc3RhcnQgdGhlIGRlbGF5LlxuICAgICAgICAgICAgdmFyIGRlZmF1bHREZWxheSA9IDEwMDA7XG4gICAgICAgICAgICBkZWxheSA9IGRlbGF5IHx8IGRlZmF1bHREZWxheTtcbiAgICAgICAgICAgIGlmICh0aHJvdHRsZXNba2V5XSkge1xuICAgICAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aHJvdHRsZXNba2V5XSk7XG4gICAgICAgICAgICAgICAgdGhyb3R0bGVzW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW1tZWRpYXRlKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3R0bGVzW2tleV0gPSAkdGltZW91dChjYWxsYmFjaywgZGVsYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaXNOdW1iZXIodmFsKSB7XG4gICAgICAgICAgICAvLyBuZWdhdGl2ZSBvciBwb3NpdGl2ZVxuICAgICAgICAgICAgcmV0dXJuICgvXlstXT9cXGQrJC8pLnRlc3QodmFsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHRleHRDb250YWlucyh0ZXh0LCBzZWFyY2hUZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGV4dCAmJiAtMSAhPT0gdGV4dC50b0xvd2VyQ2FzZSgpLmluZGV4T2Yoc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMuZGF0YVxuICogRkFDVE9SWTogYnJlZXplQ29uZmlnXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5jb3JlJylcbiAgICAgICAgLmZhY3RvcnkoJ2JyZWV6ZUNvbmZpZycsIGJyZWV6ZUNvbmZpZyk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBicmVlemVDb25maWcoYnJlZXplKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgcmVtb3RlU2VydmljZU5hbWU6ICcvYXBpL2JyZWV6ZScsXG4gICAgICAgICAgICBicmVlemU6IGJyZWV6ZVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy9cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgY29yZSA9IGFuZ3VsYXIubW9kdWxlKCdub3Rvc3BsdXMuY29yZScpO1xuXG4gICAgY29yZS5jb25maWcodG9hc3RyQ29uZmlnKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIHRvYXN0ckNvbmZpZyh0b2FzdHIpIHtcbiAgICAgICAgdG9hc3RyLm9wdGlvbnMudGltZU91dCA9IDQwMDA7XG4gICAgICAgIHRvYXN0ci5vcHRpb25zLmNsb3NlQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgdG9hc3RyLm9wdGlvbnMucHJvZ3Jlc3NCYXIgPSB0cnVlO1xuICAgICAgICB0b2FzdHIub3B0aW9ucy5wb3NpdGlvbkNsYXNzID0gJ3RvYXN0LWJvdHRvbS1yaWdodCc7XG4gICAgfVxuXG4gICAgdmFyIGtleUNvZGVzID0ge1xuICAgICAgICBiYWNrc3BhY2U6IDgsXG4gICAgICAgIHRhYjogOSxcbiAgICAgICAgZW50ZXI6IDEzLFxuICAgICAgICBlc2M6IDI3LFxuICAgICAgICBzcGFjZTogMzIsXG4gICAgICAgIHBhZ2V1cDogMzMsXG4gICAgICAgIHBhZ2Vkb3duOiAzNCxcbiAgICAgICAgZW5kOiAzNSxcbiAgICAgICAgaG9tZTogMzYsXG4gICAgICAgIGxlZnQ6IDM3LFxuICAgICAgICB1cDogMzgsXG4gICAgICAgIHJpZ2h0OiAzOSxcbiAgICAgICAgZG93bjogNDAsXG4gICAgICAgIGluc2VydDogNDUsXG4gICAgICAgIGRlbDogNDZcbiAgICB9O1xuXG4gICAgdmFyIGV2ZW50cyA9IHtcbiAgICAgICAgY29udHJvbGxlckFjdGl2YXRlU3VjY2VzczogJ2NvbnRyb2xsZXIuYWN0aXZhdGVTdWNjZXNzJyxcbiAgICAgICAgZW50aXRpZXNDaGFuZ2VkOiAnZGF0YWNvbnRleHQuZW50aXRpZXNDaGFuZ2VkJyxcbiAgICAgICAgZW50aXRpZXNJbXBvcnRlZDogJ2RhdGFjb250ZXh0LmVudGl0aWVzSW1wb3J0ZWQnLFxuICAgICAgICBoYXNDaGFuZ2VzQ2hhbmdlZDogJ2RhdGFjb250ZXh0Lmhhc0NoYW5nZXNDaGFuZ2VkJyxcbiAgICAgICAgc3RvcmFnZToge1xuICAgICAgICAgICAgZXJyb3I6ICdzdG9yZS5lcnJvcicsXG4gICAgICAgICAgICBzdG9yZUNoYW5nZWQ6ICdzdG9yZS5jaGFuZ2VkJyxcbiAgICAgICAgICAgIHdpcENoYW5nZWQ6ICd3aXAuY2hhbmdlZCdcbiAgICAgICAgfSxcbiAgICAgICAgbG9nZ2VkSW5Pcmdhbml6YXRpb25DaGFuZ2VkOiAncHJvZmlsZS5sb2dnZWRJbkF0Q2hhbmdlZCdcbiAgICB9O1xuXG5cbiAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICBhcHBFcnJvclByZWZpeDogJ1tub1RvcysgRm91dF0gJyxcbiAgICAgICAgYXBwVGl0bGU6ICdub1RvcysnLFxuICAgICAgICBrZXlDb2Rlczoga2V5Q29kZXMsXG4gICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgIGV2ZW50czogZXZlbnRzXG4gICAgfTtcblxuICAgIGNvcmUudmFsdWUoJ2NvbmZpZycsIGNvbmZpZyk7XG5cbiAgICBjb3JlLmNvbmZpZyhjb25maWd1cmUpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlndXJlKCR1cmxSb3V0ZXJQcm92aWRlciwgJHN0YXRlUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgIHJvdXRlaGVscGVyQ29uZmlnUHJvdmlkZXIsICRicmVhZGNydW1iUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgIHpTdG9yYWdlQ29uZmlnUHJvdmlkZXIsIHpEaXJlY3RpdmVzQ29uZmlnUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgIFJlc3Rhbmd1bGFyUHJvdmlkZXIpIHtcblxuICAgICAgICBjb25maWd1cmVSb3V0aW5nKCk7XG4gICAgICAgIGNvbmZpZ3VyZUJyZWFkY3J1bWIoKTtcblxuICAgICAgICBjb25maWd1cmVaU3RvcmFnZSgpO1xuICAgICAgICBjb25maWd1cmVaVmFsaWRhdGUoKTtcblxuICAgICAgICBjb25maWd1cmVSZXN0YW5ndWxhcigpO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlUm91dGluZygpIHtcbiAgICAgICAgICAgIHJvdXRlaGVscGVyQ29uZmlnUHJvdmlkZXIuY29uZmlnLiR1cmxSb3V0ZXJQcm92aWRlciA9ICR1cmxSb3V0ZXJQcm92aWRlcjtcbiAgICAgICAgICAgIHJvdXRlaGVscGVyQ29uZmlnUHJvdmlkZXIuY29uZmlnLiRzdGF0ZVByb3ZpZGVyID0gJHN0YXRlUHJvdmlkZXI7XG5cbiAgICAgICAgICAgIHJvdXRlaGVscGVyQ29uZmlnUHJvdmlkZXIuY29uZmlnLnRpdGxlID0gY29uZmlnLmFwcFRpdGxlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlQnJlYWRjcnVtYigpIHtcbiAgICAgICAgICAgICRicmVhZGNydW1iUHJvdmlkZXIuc2V0T3B0aW9ucyh7XG4gICAgICAgICAgICAgICAgcHJlZml4U3RhdGVOYW1lOiAnaW5kZXgnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnYm9vdHN0cmFwMycsXG4gICAgICAgICAgICAgICAgaW5jbHVkZUFic3RyYWN0OiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVpTdG9yYWdlKCkge1xuICAgICAgICAgICAgLy8gU2V0dXAgb3VyIEJyZWV6ZS1iYXNlZCBvZmZsaW5lIHN0b3JhZ2VcbiAgICAgICAgICAgIHpTdG9yYWdlQ29uZmlnUHJvdmlkZXIuY29uZmlnID0ge1xuICAgICAgICAgICAgICAgIC8vIHpTdG9yYWdlXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAga2V5OiAnbm9Ub3NQbHVzJyxcbiAgICAgICAgICAgICAgICBldmVudHM6IGNvbmZpZy5ldmVudHMuc3RvcmFnZSxcblxuICAgICAgICAgICAgICAgIC8vIHpTdG9yYWdlV2lwXG4gICAgICAgICAgICAgICAgd2lwS2V5OiAnbm9Ub3NQbHVzLndpcCcsXG4gICAgICAgICAgICAgICAgYXBwRXJyb3JQcmVmaXg6IGNvbmZpZy5hcHBFcnJvclByZWZpeCxcbiAgICAgICAgICAgICAgICBuZXdHdWlkOiBicmVlemUuY29yZS5nZXRVdWlkLFxuXG4gICAgICAgICAgICAgICAgLy8gelN0b3JhZ2VDb3JlXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogY29uZmlnLnZlcnNpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjb25maWd1cmVaVmFsaWRhdGUoKSB7XG4gICAgICAgICAgICB6RGlyZWN0aXZlc0NvbmZpZ1Byb3ZpZGVyLnpWYWxpZGF0ZVRlbXBsYXRlID1cbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJpbnZhbGlkXCI+PGkgY2xhc3M9XCJmYSBmYS13YXJuaW5nLXNpZ25cIj48L2k+JyArXG4gICAgICAgICAgICAgICAgJ09uYmVncmlqcGVsaWprISAlZXJyb3IlPC9zcGFuPic7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVJlc3Rhbmd1bGFyKCkge1xuICAgICAgICAgICAgdmFyIGJhc2VVcmwgPSAnL2FwaSc7XG5cbiAgICAgICAgICAgIFJlc3Rhbmd1bGFyUHJvdmlkZXIuc2V0QmFzZVVybChiYXNlVXJsKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyogZ2xvYmFsIHRvYXN0cjpmYWxzZSwgbW9tZW50OmZhbHNlICovXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuY29yZScpXG4gICAgICAgIC5jb25zdGFudCgndG9hc3RyJywgdG9hc3RyKVxuICAgICAgICAuY29uc3RhbnQoJ21vbWVudCcsIG1vbWVudCk7XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmNvcmVcbiAqIEZBQ1RPUlk6IEluaXRcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmNvcmUnKVxuICAgICAgICAuZmFjdG9yeSgnSW5pdCcsIEluaXQpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gSW5pdCgpIHtcbiAgICAgICAgdmFyIHdhc0luaXRpYWxpemVkID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBpc0luaXRpYWxpemVkOiBpc0luaXRpYWxpemVkLFxuICAgICAgICAgICAgaW5pdGlhbGl6aW5nOiBpbml0aWFsaXppbmdcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gaXNJbml0aWFsaXplZCgpIHtcbiAgICAgICAgICAgIHJldHVybiB3YXNJbml0aWFsaXplZDtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXppbmcoaW5pdCkge1xuICAgICAgICAgICAgd2FzSW5pdGlhbGl6ZWQgPSBpbml0O1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIi8qKlxuICogUk9VVEVTOiBub3Rvc3BsdXMuZGFzaGJvYXJkXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuZGFzaGJvYXJkJylcbiAgICAgICAgLnJ1bihjb25maWdSb3V0ZXMpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlnUm91dGVzKHJvdXRlaGVscGVyKSB7XG4gICAgICAgIHJvdXRlaGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2luZGV4JyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9pbmRleCcsXG4gICAgICAgICAgICAgICAgICAgIG5jeUJyZWFkY3J1bWI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnc3RhcnQnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnaW5kZXguZGFzaGJvYXJkJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2Rhc2hib2FyZCcsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL2Rhc2hib2FyZC9kYXNoYm9hcmQuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEYXNoYm9hcmQnLFxuICAgICAgICAgICAgICAgICAgICBuY3lCcmVhZGNydW1iOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0Rhc2hib2FyZCdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9O1xufSkoKTsiLCIvLyBJbmNsdWRlIGluIGluZGV4Lmh0bWwgc28gdGhhdCBhcHAgbGV2ZWwgZXhjZXB0aW9ucyBhcmUgaGFuZGxlZC5cbi8vIEV4Y2x1ZGUgZnJvbSB0ZXN0UnVubmVyLmh0bWwgd2hpY2ggc2hvdWxkIHJ1biBleGFjdGx5IHdoYXQgaXQgd2FudHMgdG8gcnVuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcbiAgICAgICAgLnByb3ZpZGVyKCdleGNlcHRpb25IYW5kbGVyJywgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKVxuICAgICAgICAuY29uZmlnKGNvbmZpZyk7XG5cbiAgICAvKipcbiAgICAgKiBNdXN0IGNvbmZpZ3VyZSB0aGUgZXhjZXB0aW9uIGhhbmRsaW5nXG4gICAgICogQHJldHVybiB7W3R5cGVdfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcigpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgICAgICAgYXBwRXJyb3JQcmVmaXg6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuY29uZmlndXJlID0gZnVuY3Rpb24gKGFwcEVycm9yUHJlZml4KSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5hcHBFcnJvclByZWZpeCA9IGFwcEVycm9yUHJlZml4O1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtjb25maWc6IHRoaXMuY29uZmlnfTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25maWd1cmUgYnkgc2V0dGluZyBhbiBvcHRpb25hbCBzdHJpbmcgdmFsdWUgZm9yIGFwcEVycm9yUHJlZml4LlxuICAgICAqIEFjY2Vzc2libGUgdmlhIGNvbmZpZy5hcHBFcnJvclByZWZpeCAodmlhIGNvbmZpZyB2YWx1ZSkuXG4gICAgICogQHBhcmFtICB7W3R5cGVdfSAkcHJvdmlkZVxuICAgICAqIEByZXR1cm4ge1t0eXBlXX1cbiAgICAgKiBAbmdJbmplY3RcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25maWcoJHByb3ZpZGUpIHtcbiAgICAgICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckZXhjZXB0aW9uSGFuZGxlcicsIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dGVuZCB0aGUgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZSB0byBhbHNvIGRpc3BsYXkgYSB0b2FzdC5cbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICRkZWxlZ2F0ZVxuICAgICAqIEBwYXJhbSAge09iamVjdH0gZXhjZXB0aW9uSGFuZGxlclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gbG9nZ2VyXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IHRoZSBkZWNvcmF0ZWQgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIoJGRlbGVnYXRlLCBleGNlcHRpb25IYW5kbGVyLCBsb2dnZXIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGV4Y2VwdGlvbiwgY2F1c2UpIHtcbiAgICAgICAgICAgIHZhciBhcHBFcnJvclByZWZpeCA9IGV4Y2VwdGlvbkhhbmRsZXIuY29uZmlnLmFwcEVycm9yUHJlZml4IHx8ICcnO1xuICAgICAgICAgICAgdmFyIGVycm9yRGF0YSA9IHtleGNlcHRpb246IGV4Y2VwdGlvbiwgY2F1c2U6IGNhdXNlfTtcbiAgICAgICAgICAgIGV4Y2VwdGlvbi5tZXNzYWdlID0gYXBwRXJyb3JQcmVmaXggKyBleGNlcHRpb24ubWVzc2FnZTtcbiAgICAgICAgICAgICRkZWxlZ2F0ZShleGNlcHRpb24sIGNhdXNlKTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ291bGQgYWRkIHRoZSBlcnJvciB0byBhIHNlcnZpY2UncyBjb2xsZWN0aW9uLFxuICAgICAgICAgICAgICogYWRkIGVycm9ycyB0byAkcm9vdFNjb3BlLCBsb2cgZXJyb3JzIHRvIHJlbW90ZSB3ZWIgc2VydmVyLFxuICAgICAgICAgICAgICogb3IgbG9nIGxvY2FsbHkuIE9yIHRocm93IGhhcmQuIEl0IGlzIGVudGlyZWx5IHVwIHRvIHlvdS5cbiAgICAgICAgICAgICAqIHRocm93IGV4Y2VwdGlvbjtcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgICAgICogICAgIHRocm93IHsgbWVzc2FnZTogJ2Vycm9yIG1lc3NhZ2Ugd2UgYWRkZWQnIH07XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihleGNlcHRpb24ubWVzc2FnZSwgZXJyb3JEYXRhKTtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpOyIsIi8qKlxuICogYmxvY2tzLmV4Y2VwdGlvblxuICogRkFDVE9SWTogZXhjZXB0aW9uXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxuICAgICAgICAuZmFjdG9yeSgnZXhjZXB0aW9uJywgZXhjZXB0aW9uKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbihsb2dnZXIpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBjYXRjaGVyOiBjYXRjaGVyXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGNhdGNoZXIobWVzc2FnZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihtZXNzYWdlLCByZWFzb24pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBibG9ja3MubG9nZ2VyXG4gKiBGQUNUT1JZOiBsb2dnZXJcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicpXG4gICAgICAgIC5mYWN0b3J5KCdsb2dnZXInLCBsb2dnZXIpO1xuXG4gICAgbG9nZ2VyLiRpbmplY3QgPSBbJyRsb2cnLCAndG9hc3RyJ107XG5cbiAgICBmdW5jdGlvbiBsb2dnZXIoJGxvZywgdG9hc3RyKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgc2hvd1RvYXN0czogdHJ1ZSxcblxuICAgICAgICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgICAgICAgaW5mbzogaW5mbyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gICAgICAgICAgICB3YXJuaW5nOiB3YXJuaW5nLFxuXG4gICAgICAgICAgICByZW1vdmVkOiByZW1vdmVkLFxuICAgICAgICAgICAgc2F2ZWQ6IHNhdmVkLFxuXG4gICAgICAgICAgICAvLyBzdHJhaWdodCB0byBjb25zb2xlOyBieXBhc3MgdG9hc3RyXG4gICAgICAgICAgICBsb2c6ICRsb2cubG9nXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5lcnJvcignRm91dDogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgdG9hc3RyLmluZm8obWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5pbmZvKCdJbmZvOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmluZm8oJ1N1Y2NlczogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy53YXJuKCdMZXQgb3A6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZWQobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cud2FybignVmVyd2lqZGVyZDogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZWQobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuaW5mbygnQmV3YWFyZDogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5yb3V0ZXJcbiAqIEZBQ1RPUlk6IHJvdXRlaGVscGVyXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInKVxuICAgICAgICAucHJvdmlkZXIoJ3JvdXRlaGVscGVyQ29uZmlnJywgcm91dGVoZWxwZXJDb25maWcpXG4gICAgICAgIC5mYWN0b3J5KCdyb3V0ZWhlbHBlcicsIHJvdXRlaGVscGVyKTtcblxuICAgIHJvdXRlaGVscGVyLiRpbmplY3QgPSBbJ3JvdXRlaGVscGVyQ29uZmlnJywgJyRyb290U2NvcGUnLCAnJHN0YXRlJ107XG5cbiAgICBmdW5jdGlvbiByb3V0ZWhlbHBlckNvbmZpZygpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHRoaXMuY29uZmlnID0ge307XG5cbiAgICAgICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjb25maWc6IHRoaXMuY29uZmlnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJvdXRlaGVscGVyKHJvdXRlaGVscGVyQ29uZmlnLCAkcm9vdFNjb3BlLCAkc3RhdGUpIHtcbiAgICAgICAgdmFyICR1cmxSb3V0ZXJQcm92aWRlciA9IHJvdXRlaGVscGVyQ29uZmlnLmNvbmZpZy4kdXJsUm91dGVyUHJvdmlkZXI7XG4gICAgICAgIHZhciAkc3RhdGVQcm92aWRlciA9IHJvdXRlaGVscGVyQ29uZmlnLmNvbmZpZy4kc3RhdGVQcm92aWRlcjtcblxuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGNvbmZpZ3VyZVN0YXRlczogY29uZmlndXJlU3RhdGVzLFxuICAgICAgICAgICAgc3RhdGVzOiBzdGF0ZXMsXG4gICAgICAgICAgICBnZXQ6IGdldFxuICAgICAgICB9O1xuXG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlU3RhdGVzKHN0YXRlcykge1xuICAgICAgICAgICAgc3RhdGVzLmZvckVhY2goZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmNvbmZpZy50aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5jb25maWcubmN5QnJlYWRjcnVtYiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBzdGF0ZS5jb25maWcudGl0bGUudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoc3RhdGUuc3RhdGUsIHN0YXRlLmNvbmZpZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHN0YXRlcygpIHtcbiAgICAgICAgICAgIHJldHVybiAkc3RhdGUuZ2V0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXQocGF0dGVybikge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICAgICAgICBzdGF0ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5uYW1lID09PSBwYXR0ZXJuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHN0YXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIHVwZGF0ZURvY1RpdGxlKCk7XG4gICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvaW5kZXgvZGFzaGJvYXJkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVEb2NUaXRsZSgpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJyxcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZXZlbnQsIGN1cnJlbnQsIHByZXZpb3VzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHJvdXRlaGVscGVyQ29uZmlnLmNvbmZpZy50aXRsZSArIChjdXJyZW50LnRpdGxlID8gJyB8ICcgKyBjdXJyZW50LnRpdGxlIDogJycpO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gdGl0bGU7IC8vIGRhdGEgYmluZCB0byA8dGl0bGU+XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJHN0YXRlID0gY3VycmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMuZGF0YScpXG4gICAgICAgIC5mYWN0b3J5KCdyZXBvc2l0b3J5LmFic3RyYWN0JywgQWJzdHJhY3RSZXBvc2l0b3J5KTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEFic3RyYWN0UmVwb3NpdG9yeShicmVlemUsIGNvbW1vbiwgelN0b3JhZ2UsIHpTdG9yYWdlV2lwKSB7XG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgICB2YXIgcHJlZGljYXRlcyA9IHtcbiAgICAgICAgICAgIGlzTm90TnVsbG86IGJyZWV6ZS5QcmVkaWNhdGUuY3JlYXRlKCdpZCcsICchPScsIDApLFxuICAgICAgICAgICAgaXNOdWxsbzogYnJlZXplLlByZWRpY2F0ZS5jcmVhdGUoJ2lkJywgJz09JywgMClcbiAgICAgICAgfTtcbiAgICAgICAgdmFyICRxID0gY29tbW9uLiRxO1xuXG4gICAgICAgIGZ1bmN0aW9uIEN0b3IoZW50aXR5TWFuYWdlciwgZW50aXR5TmFtZSkge1xuICAgICAgICAgICAgLy8gaW5zdGFuY2UgbWVtYmVycyB0aGF0IGFyZSBzdGF0ZWZ1bFxuICAgICAgICAgICAgdGhpcy5lbnRpdHlOYW1lID0gZW50aXR5TmFtZTtcbiAgICAgICAgICAgIHRoaXMuZ2V0QnlJZCA9IGdldEJ5SWQuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuZ2V0RW50aXR5QnlJZE9yRnJvbVdpcCA9IGdldEVudGl0eUJ5SWRPckZyb21XaXAuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyID0gY29tbW9uLmxvZ2dlcjtcbiAgICAgICAgICAgIHRoaXMubWFuYWdlciA9IGVudGl0eU1hbmFnZXI7XG4gICAgICAgICAgICB0aGlzLnF1ZXJ5RmFpbGVkID0gcXVlcnlGYWlsZWQuYmluZCh0aGlzKTsgLy8gQmluZCB0byBzZWxmIHNvIHdlIGVzdGFibGlzaCAndGhpcycgYXMgdGhlIGNvbnRleHRcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHN0YXRlbGVzcyBtZXRob2RzIHRoYXQgY2FuIGJlIHNoYXJlZCBhY3Jvc3MgYWxsIHJlcG9zICovXG4gICAgICAgIEN0b3IucHJvdG90eXBlID0ge1xuICAgICAgICAgICAgY29uc3RydWN0b3I6IEN0b3IsXG4gICAgICAgICAgICAkcTogJHEsXG4gICAgICAgICAgICBnZXRBbGw6IGdldEFsbCxcbiAgICAgICAgICAgIGdldEFsbExvY2FsOiBnZXRBbGxMb2NhbCxcbiAgICAgICAgICAgIGdldExvY2FsRW50aXR5Q291bnQ6IGdldExvY2FsRW50aXR5Q291bnQsXG4gICAgICAgICAgICBwcmVkaWNhdGVzOiBwcmVkaWNhdGVzLFxuICAgICAgICAgICAgc2V0SXNQYXJ0aWFsVHJ1ZTogc2V0SXNQYXJ0aWFsVHJ1ZSxcbiAgICAgICAgICAgIHpTdG9yYWdlOiB6U3RvcmFnZSxcbiAgICAgICAgICAgIHpTdG9yYWdlV2lwOiB6U3RvcmFnZVdpcFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBDdG9yO1xuXG4gICAgICAgIC8qIEltcGxlbWVudGF0aW9uICovXG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0QWxsKHJlc291cmNlLCBvcmRlcmluZywgcHJlZGljYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gYnJlZXplLkVudGl0eVF1ZXJ5LmZyb20ocmVzb3VyY2UpXG4gICAgICAgICAgICAgICAgLndoZXJlKHByZWRpY2F0ZSlcbiAgICAgICAgICAgICAgICAub3JkZXJCeShvcmRlcmluZylcbiAgICAgICAgICAgICAgICAudXNpbmcodGhpcy5tYW5hZ2VyKVxuICAgICAgICAgICAgICAgIC5leGVjdXRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRBbGxMb2NhbChyZXNvdXJjZSwgb3JkZXJpbmcsIHByZWRpY2F0ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubWFuYWdlci5tZXRhZGF0YVN0b3JlLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEFsbChyZXNvdXJjZSwgb3JkZXJpbmcsIHByZWRpY2F0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYnJlZXplLkVudGl0eVF1ZXJ5LmZyb20ocmVzb3VyY2UpXG4gICAgICAgICAgICAgICAgLndoZXJlKHByZWRpY2F0ZSlcbiAgICAgICAgICAgICAgICAub3JkZXJCeShvcmRlcmluZylcbiAgICAgICAgICAgICAgICAudXNpbmcodGhpcy5tYW5hZ2VyKVxuICAgICAgICAgICAgICAgIC5leGVjdXRlTG9jYWxseSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0QnlJZChpZCwgZm9yY2VSZW1vdGUpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHZhciBlbnRpdHlOYW1lID0gc2VsZi5lbnRpdHlOYW1lO1xuICAgICAgICAgICAgdmFyIG1hbmFnZXIgPSBzZWxmLm1hbmFnZXI7XG4gICAgICAgICAgICBpZiAoIWZvcmNlUmVtb3RlKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgY2FjaGUgZmlyc3QgKHN5bmNocm9ub3VzKVxuICAgICAgICAgICAgICAgIHZhciBlbnRpdHkgPSBtYW5hZ2VyLmdldEVudGl0eUJ5S2V5KGVudGl0eU5hbWUsIGlkKTtcbiAgICAgICAgICAgICAgICBpZiAoZW50aXR5ICYmICFlbnRpdHkuaXNQYXJ0aWFsKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLmluZm8oJ1JldHJpZXZlZCBbJyArIGVudGl0eU5hbWUgKyAnXSBpZDonICsgZW50aXR5LmlkICsgJyBmcm9tIGNhY2hlLicsIGVudGl0eSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbnRpdHkuZW50aXR5QXNwZWN0LmVudGl0eVN0YXRlLmlzRGVsZXRlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkgPSBudWxsOyAvLyBoaWRlIHNlc3Npb24gbWFya2VkLWZvci1kZWxldGVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBTaG91bGQgbm90IG5lZWQgdG8gY2FsbCAkYXBwbHkgYmVjYXVzZSBpdCBpcyBzeW5jaHJvbm91c1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHEud2hlbihlbnRpdHkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSXQgd2FzIG5vdCBmb3VuZCBpbiBjYWNoZSwgc28gbGV0J3MgcXVlcnkgZm9yIGl0LlxuICAgICAgICAgICAgLy8gZmV0Y2hFbnRpdHlCeUtleSB3aWxsIGdvIHJlbW90ZSBiZWNhdXNlXG4gICAgICAgICAgICAvLyAzcmQgcGFybSBpcyBmYWxzZS91bmRlZmluZWQuXG4gICAgICAgICAgICByZXR1cm4gbWFuYWdlci5mZXRjaEVudGl0eUJ5S2V5KGVudGl0eU5hbWUsIGlkKVxuICAgICAgICAgICAgICAgIC50aGVuKHF1ZXJ5U3VjY2VlZGVkKS5jYXRjaChzZWxmLnF1ZXJ5RmFpbGVkKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gcXVlcnlTdWNjZWVkZWQoZGF0YSkge1xuICAgICAgICAgICAgICAgIGVudGl0eSA9IGRhdGEuZW50aXR5O1xuICAgICAgICAgICAgICAgIGlmICghZW50aXR5KSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLmluZm8oJ0NvdWxkIG5vdCBmaW5kIFsnICsgZW50aXR5TmFtZSArICddIGlkOicgKyBpZCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbnRpdHkuaXNQYXJ0aWFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgc2VsZi5sb2dnZXIuaW5mbygnUmV0cmlldmVkIFsnICsgZW50aXR5TmFtZSArICddIGlkICcgKyBlbnRpdHkuaWQgKyAnIGZyb20gcmVtb3RlIGRhdGEgc291cmNlJywgZW50aXR5KTtcbiAgICAgICAgICAgICAgICB6U3RvcmFnZS5zYXZlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVudGl0eTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEVudGl0eUJ5SWRPckZyb21XaXAodmFsKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZW50aXR5TmFtZSA9IHNlbGYuZW50aXR5TmFtZTtcbiAgICAgICAgICAgIC8vIHZhbCBjb3VsZCBiZSBhbiBJRCBvciBhIHdpcEtleVxuICAgICAgICAgICAgdmFyIHdpcEVudGl0eUtleSA9IHZhbDtcblxuICAgICAgICAgICAgaWYgKGNvbW1vbi5pc051bWJlcih2YWwpKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gcGFyc2VJbnQodmFsKTtcbiAgICAgICAgICAgICAgICB3aXBFbnRpdHlLZXkgPSB6U3RvcmFnZVdpcC5maW5kV2lwS2V5QnlFbnRpdHlJZChlbnRpdHlOYW1lLCB2YWwpO1xuICAgICAgICAgICAgICAgIGlmICghd2lwRW50aXR5S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJldHVybnMgYSBwcm9taXNlIHdpdGggdGhlIGVudGl0eSBiZWNhdXNlXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBlbnRpdHkgbWF5IGJlIGluIHN0b3JhZ2Vsb2NhbCBvciByZW1vdGUgKGFzeW5jKS5cbiAgICAgICAgICAgICAgICAgICAgLy8gQmluZCB0byBzZWxmIHNvIHdlIGVzdGFibGlzaCAndGhpcycgYXMgdGhlIGNvbnRleHQuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRCeUlkLmJpbmQoc2VsZikodmFsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB3aXBSZXN1bHQgPSBudWxsO1xuICAgICAgICAgICAgdmFyIGltcG9ydGVkRW50aXR5ID0gelN0b3JhZ2VXaXAubG9hZFdpcEVudGl0eSh3aXBFbnRpdHlLZXkpO1xuICAgICAgICAgICAgaWYgKGltcG9ydGVkRW50aXR5KSB7XG4gICAgICAgICAgICAgICAgLy8gTmVlZCB0byByZS12YWxpZGF0ZSB0aGUgZW50aXR5IHdlIGFyZSByZS1oeWRyYXRpbmdcbiAgICAgICAgICAgICAgICBpbXBvcnRlZEVudGl0eS5lbnRpdHlBc3BlY3QudmFsaWRhdGVFbnRpdHkoKTtcbiAgICAgICAgICAgICAgICB3aXBSZXN1bHQgPSB7ZW50aXR5OiBpbXBvcnRlZEVudGl0eSwga2V5OiB3aXBFbnRpdHlLZXl9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLmxvZ2dlci5pbmZvKCdDb3VsZCBub3QgZmluZCBbJyArIGVudGl0eU5hbWUgKyAnXSBpZCBpbiBXSVA6JyArIHdpcEVudGl0eUtleSwgbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEud2hlbih3aXBSZXN1bHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0TG9jYWxFbnRpdHlDb3VudChyZXNvdXJjZSkge1xuICAgICAgICAgICAgdmFyIGVudGl0aWVzID0gYnJlZXplLkVudGl0eVF1ZXJ5LmZyb20ocmVzb3VyY2UpXG4gICAgICAgICAgICAgICAgLndoZXJlKHByZWRpY2F0ZXMuaXNOb3ROdWxsbylcbiAgICAgICAgICAgICAgICAudXNpbmcodGhpcy5tYW5hZ2VyKVxuICAgICAgICAgICAgICAgIC5leGVjdXRlTG9jYWxseSgpO1xuICAgICAgICAgICAgcmV0dXJuIGVudGl0aWVzLmxlbmd0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHF1ZXJ5RmFpbGVkKGVycm9yKSB7XG4gICAgICAgICAgICB2YXIgbXNnID0gJ0Vycm9yIHJldHJpZXZpbmcgZGF0YS4gJyArIChlcnJvci5tZXNzYWdlIHx8ICcnKTtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKG1zZywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChuZXcgRXJyb3IobXNnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRJc1BhcnRpYWxUcnVlKGVudGl0aWVzKSB7XG4gICAgICAgICAgICAvLyBjYWxsIGZvciBhbGwgXCJwYXJ0aWFsIHF1ZXJpZXNcIlxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGVudGl0aWVzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgICAgIGVudGl0aWVzW2ldLmlzUGFydGlhbCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZW50aXRpZXM7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmRhdGFcbiAqIEZBQ1RPUlk6IHJlcG9zaXRvcnkubG9va3VwXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5kYXRhJylcbiAgICAgICAgLmZhY3RvcnkoJ3JlcG9zaXRvcnkubG9va3VwJywgUmVwb3NpdG9yeUxvb2t1cCk7XG5cbiAgICBSZXBvc2l0b3J5TG9va3VwLiRpbmplY3QgPSBbJ2JyZWV6ZScsICdtb2RlbCcsICdyZXBvc2l0b3J5LmFic3RyYWN0JywgJ1Byb2ZpbGVTZXJ2aWNlJ107XG5cbiAgICBmdW5jdGlvbiBSZXBvc2l0b3J5TG9va3VwKGJyZWV6ZSwgbW9kZWwsIEFic3RyYWN0UmVwb3NpdG9yeSwgUHJvZmlsZVNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGVudGl0eU5hbWUgPSAncm9sZSc7XG4gICAgICAgIHZhciBlbnRpdHlOYW1lcyA9IG1vZGVsLmVudGl0eU5hbWVzO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjcmVhdGU6IGNyZWF0ZVJlcG9cbiAgICAgICAgfTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVJlcG8obWFuYWdlcikge1xuICAgICAgICAgICAgdmFyIGJhc2UgPSBuZXcgQWJzdHJhY3RSZXBvc2l0b3J5KG1hbmFnZXIsIGVudGl0eU5hbWUpO1xuICAgICAgICAgICAgdmFyIGNhY2hlZExvb2t1cHM7XG4gICAgICAgICAgICB2YXIgcmVwbyA9IHtcbiAgICAgICAgICAgICAgICBnZXRBbGw6IGdldEFsbCxcbiAgICAgICAgICAgICAgICBnZXQgY2FjaGVkRGF0YSgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENhY2hlZExvb2t1cHMoKTtcbiAgICAgICAgICAgICAgICB9IC8vc2hvcnRjdXQgJ2dldHRlcicgc3ludGF4XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gcmVwbztcbiAgICAgICAgICAgIC8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRBbGwoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJyZWV6ZS5FbnRpdHlRdWVyeS5mcm9tKCdMb29rdXBzJylcbiAgICAgICAgICAgICAgICAgICAgLnVzaW5nKG1hbmFnZXIpLmV4ZWN1dGUoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihwcm9jZXNzTG9va3VwcykuY2F0Y2goYmFzZS5xdWVyeUZhaWxlZCk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBwcm9jZXNzTG9va3VwcyhkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsLmNyZWF0ZU51bGxvcyhtYW5hZ2VyKTtcbiAgICAgICAgICAgICAgICAgICAgLy9iYXNlLmxvZ2dlci5pbmZvKCdSZXRyaWV2ZWQgbG9va3VwcycsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBiYXNlLnpTdG9yYWdlLnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldENhY2hlZExvb2t1cHMoKSB7XG4gICAgICAgICAgICAgICAgaWYoIWNhY2hlZExvb2t1cHMpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVkTG9va3VwcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzOiBiYXNlLmdldEFsbExvY2FsKGVudGl0eU5hbWVzLnJvbGUsICduYW1lJylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVkTG9va3VwcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5kYXRhJylcbiAgICAgICAgLmZhY3RvcnkoJ3JlcG9zaXRvcnkudXNlcicsIFJlcG9zaXRvcnlVc2VyKTtcblxuICAgIFJlcG9zaXRvcnlVc2VyLiRpbmplY3QgPSBbJ2JyZWV6ZScsICdtb2RlbCcsICdyZXBvc2l0b3J5LmFic3RyYWN0J107XG5cbiAgICBmdW5jdGlvbiBSZXBvc2l0b3J5VXNlcihicmVlemUsIG1vZGVsLCBBYnN0cmFjdFJlcG9zaXRvcnkpIHtcbiAgICAgICAgdmFyIGVudGl0eU5hbWUgPSBtb2RlbC5lbnRpdHlOYW1lcy51c2VyO1xuXG4gICAgICAgIHZhciBvcmRlckJ5ID0gJ3VzZXJuYW1lJztcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY3JlYXRlOiBjcmVhdGVSZXBvIC8vIGZhY3RvcnkgZnVuY3Rpb24gdG8gY3JlYXRlIHRoZSByZXBvc2l0b3J5XG4gICAgICAgIH07XG5cbiAgICAgICAgLyogSW1wbGVtZW50YXRpb24gKi9cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlUmVwbyhtYW5hZ2VyKSB7XG4gICAgICAgICAgICB2YXIgYmFzZSA9IG5ldyBBYnN0cmFjdFJlcG9zaXRvcnkobWFuYWdlciwgZW50aXR5TmFtZSk7XG5cbiAgICAgICAgICAgIC8vIFVzaW5nIHRoZSB0eXBlIGlzIGEgbGl0dGxlIGZhc3RlciB0aGFuIHRoZSB0eXBlIG5hbWVcbiAgICAgICAgICAgIC8vdmFyIG1ldGFkYXRhU3RvcmUgPSBtYW5hZ2VyLm1ldGFkYXRhU3RvcmU7XG4gICAgICAgICAgICAvLyB2YXIgdXNlclR5cGUgPSBtZXRhZGF0YVN0b3JlLmdldEVudGl0eVR5cGUobW9kZWwuZW50aXR5TmFtZXMudXNlcik7XG5cbiAgICAgICAgICAgIHZhciByZXBvID0ge1xuICAgICAgICAgICAgICAgIGNyZWF0ZTogY3JlYXRlLFxuICAgICAgICAgICAgICAgIGdldEFsbExvY2FsOiBnZXRBbGxMb2NhbCxcbiAgICAgICAgICAgICAgICBnZXRCeUlkOiBiYXNlLmdldEJ5SWQsXG4gICAgICAgICAgICAgICAgZ2V0RW50aXR5QnlJZE9yRnJvbVdpcDogYmFzZS5nZXRFbnRpdHlCeUlkT3JGcm9tV2lwLFxuICAgICAgICAgICAgICAgIGdldFBhcnRpYWxzOiBnZXRQYXJ0aWFscyxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiByZXBvO1xuICAgICAgICAgICAgLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBwcmVkaWNhdGVGb3JPcmdhbml6YXRpb24ob3JnSWQpIHtcbiAgICAgICAgICAgICAgICB2YXIga2wgPSBicmVlemUuUHJlZGljYXRlLmNyZWF0ZSgncmVsYXRlZFRvLnJlZmVyZW5jZS5pZCcsICc9PScsIG9yZ0lkKTtcbiAgICAgICAgICAgICAgICB2YXIgZW1wID0gYnJlZXplLlByZWRpY2F0ZS5jcmVhdGUoJ3JlbGF0ZWRUby5raW5kLm5hbWUnLCAnPT0nLCAnRU1QTE9ZRUUnKTtcbiAgICAgICAgICAgICAgICB2YXIgcHJlZGljYXRlID0gYnJlZXplLlByZWRpY2F0ZS5hbmQoW2tsLCBlbXBdKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJlZGljYXRlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjcmVhdGUoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hbmFnZXIuY3JlYXRlRW50aXR5KCdVc2VyJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEFsbExvY2FsKG9yZ0lkLCBpbmNsdWRlTnVsbG8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZS5nZXRBbGxMb2NhbCgnVXNlcicsIG9yZGVyQnksIHByZWRpY2F0ZUZvck9yZ2FuaXphdGlvbihvcmdJZCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRQYXJ0aWFscyhvcmdJZCwgZm9yY2VSZW1vdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdXNlcnM7XG4gICAgICAgICAgICAgICAgaWYgKCFmb3JjZVJlbW90ZSkge1xuICAgICAgICAgICAgICAgICAgICB1c2VycyA9IGdldEFsbExvY2FsKGZhbHNlLCBvcmdJZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2Vycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiYXNlLiRxLndoZW4odXNlcnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHByZWRpY2F0ZSA9IHByZWRpY2F0ZUZvck9yZ2FuaXphdGlvbihvcmdJZCk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gYnJlZXplLkVudGl0eVF1ZXJ5LmZyb20oJ1VzZXInKVxuICAgICAgICAgICAgICAgICAgICAuZXhwYW5kKCdyZWxhdGVkVG8scmVsYXRlZFRvLmtpbmQnKVxuICAgICAgICAgICAgICAgICAgICAub3JkZXJCeShvcmRlckJ5KVxuICAgICAgICAgICAgICAgICAgICAudG9UeXBlKCdVc2VyJylcbiAgICAgICAgICAgICAgICAgICAgLndoZXJlKHByZWRpY2F0ZSlcbiAgICAgICAgICAgICAgICAgICAgLnVzaW5nKG1hbmFnZXIpLmV4ZWN1dGUoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihxdWVyeVN1Y2NlZWRlZCkuY2F0Y2goYmFzZS5xdWVyeUZhaWxlZCk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBxdWVyeVN1Y2NlZWRlZChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJzID0gZGF0YS5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gdXNlcnMubGVuZ3RoOyBpLS07KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2Vyc1tpXS5pc1BhcnRpYWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJhc2UubG9nZ2VyLmluZm8oJ1JldHJpZXZlZCBbVXNlciBQYXJ0aWFsc10gZnJvbSByZW1vdGUgZGF0YSBzb3VyY2UnLCB1c2Vycy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICBiYXNlLnpTdG9yYWdlLnNhdmUoKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlcnM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmxpYnJhcnlcbiAqIENPTlRST0xMRVI6IFdlYnNpdGVEZXRhaWxDb250cm9sbGVyXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubGlicmFyeScpXG4gICAgICAgIC5jb250cm9sbGVyKCdXZWJzaXRlRGV0YWlsQ29udHJvbGxlcicsIFdlYnNpdGVEZXRhaWxDb250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFdlYnNpdGVEZXRhaWxDb250cm9sbGVyKCkge1xuICAgICAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuICAgICAgICAvLy8vLy8vLy8vLy9cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLmxpYnJhcnlcbiAqIENPTlRST0xMRVI6IFdlYnNpdGVzQ29udHJvbGxlclxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLmxpYnJhcnknKVxuICAgICAgICAuY29udHJvbGxlcignV2Vic2l0ZXNDb250cm9sbGVyJywgV2Vic2l0ZXNDb250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFdlYnNpdGVzQ29udHJvbGxlcigpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgYWN0aXZhdGUoKTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuXG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3NwbHVzLm1hbmFnZVxuICogRkFDVE9SWTogVXNlclxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMubWFuYWdlJylcbiAgICAgICAgLmZhY3RvcnkoJ1VzZXInLCBVc2VyKTtcblxuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gVXNlcihIVFRQQ2FjaGUsIFByb2ZpbGVTZXJ2aWNlKSB7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSBIVFRQQ2FjaGUuc2VydmljZSgnL29yZ2FuaXphdGlvbi8nICsgUHJvZmlsZVNlcnZpY2UucmVhbG0oKS5pZCArICcvdXNlcicpO1xuXG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cblxuXG4gICAgICAgIC8vcmV0dXJuICRyZXNvdXJjZSgnL2FwaS91c2VyLzppZCcpO1xuXG4gICAgICAgIC8qdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBnZXRMaXN0OiBnZXRMaXN0LFxuICAgICAgICAgICAgZ2V0OiBnZXQsXG4gICAgICAgICAgICBzYXZlOiBzYXZlLFxuICAgICAgICAgICAgcmVtb3ZlOiByZW1vdmVcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0TGlzdCgpIHtcbiAgICAgICAgICAgIHJldHVybiBSZXN0YW5ndWxhci5hbGwoJ3VzZXInKS5nZXRMaXN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXQoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiBSZXN0YW5ndWxhci5vbmUoJ3VzZXInLCBpZCkuZ2V0KClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZSh1c2VyKSB7XG4gICAgICAgICAgICBpZiAodXNlci5oYXNPd25Qcm9wZXJ0eSgnaWQnKSAmJiB1c2VyLmlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlc3Rhbmd1bGFyLnBvc3QodXNlcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBSZXN0YW5ndWxhci5vbmUoJ3VzZXInKS5wb3N0KHVzZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgICAgICAgaWYgKHVzZXIuaGFzT3duZVByb3BlcnR5KCdpZCcpICYmIHVzZXIuaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVzdGFuZ3VsYXIub25lKCd1c2VyJywgdXNlci5pZCkucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0qL1xuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMubWFuYWdlXG4gKiBDT05UUk9MTEVSOiBVc2VyQWRkQ29udHJvbGxlclxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3NwbHVzLm1hbmFnZScpXG4gICAgICAgIC5jb250cm9sbGVyKCdVc2VyRGV0YWlsQ29udHJvbGxlcicsIFVzZXJEZXRhaWxDb250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFVzZXJEZXRhaWxDb250cm9sbGVyKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1vbiwgY29uZmlnLCBVc2VyLCBEaWFsb2csIFByb2ZpbGVTZXJ2aWNlKSB7XG4gICAgICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2YXIgbG9nZ2VyID0gY29tbW9uLmxvZ2dlcjtcbiAgICAgICAgdmFyICRxID0gY29tbW9uLiRxO1xuICAgICAgICB2YXIgZXZlbnRzID0gY29uZmlnLmV2ZW50cztcblxuXG4gICAgICAgIHZtLmNhbmNlbCA9IGNhbmNlbDtcbiAgICAgICAgdm0uaGFzQ2hhbmdlcyA9IGZhbHNlO1xuICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHZtLmlzU2F2aW5nID0gZmFsc2U7XG4gICAgICAgIHZtLmlzUmVzZXRQd2QgPSBmYWxzZTtcbiAgICAgICAgdm0ucmVzZXRQd2QgPSByZXNldFBhc3N3b3JkO1xuICAgICAgICB2bS5zYXZlID0gc2F2ZTtcbiAgICAgICAgdm0ucmVtb3ZlID0gcmVtb3ZlO1xuICAgICAgICB2bS51c2VyID0gbnVsbDtcbiAgICAgICAgdm0udXNlcnMgPSBbXTtcbiAgICAgICAgdm0uZGVmYXVsdFVzZXJuYW1lID0gZGVmYXVsdFVzZXJuYW1lO1xuICAgICAgICB2bS5kZWZhdWx0RG9tYWluID0gUHJvZmlsZVNlcnZpY2UuY3VycmVudCgpLmRvbWFpbl9uYW1lO1xuXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh2bSwgJ2NhblNhdmUnLCB7Z2V0OiBjYW5TYXZlfSk7XG5cbiAgICAgICAgYWN0aXZhdGUoKTtcblxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgICAgIC8vb25EZXN0cm95KCk7XG4gICAgICAgICAgICAvL29uSGFzQ2hhbmdlcygpO1xuXG4gICAgICAgICAgICBnZXRSZXF1ZXN0ZWRVc2VyKCk7XG5cbiAgICAgICAgICAgIGNvbW1vbi4kYnJvYWRjYXN0KGV2ZW50cy5jb250cm9sbGVyQWN0aXZhdGVTdWNjZXNzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNhbmNlbCgpIHtcbiAgICAgICAgICAgIGdvVG9Vc2VycygpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FuU2F2ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiAhdm0uaXNTYXZpbmc7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRSZXF1ZXN0ZWRVc2VyKCkge1xuICAgICAgICAgICAgdm0ubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdmFsID0gJHN0YXRlUGFyYW1zLmlkO1xuICAgICAgICAgICAgaWYgKHZhbCA9PT0gJ25ldycpIHtcbiAgICAgICAgICAgICAgICB2bS51c2VyID0gVXNlci5vbmUoKTtcbiAgICAgICAgICAgICAgICB2bS5pc1Jlc2V0UHdkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdm0udXNlcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgVXNlci5vbmUodmFsKS5nZXQoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2bS51c2VyID0gZGF0YTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZtLnVzZXI7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKCdDb3VsZCBub3QgZmluZCB1c2VyIGlkID0gJyArIHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnb1RvVXNlcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignRXJyb3Igd2hpbGUgZ2V0dGluZyBzcGVha2VyIGlkID0gJyArIHZhbCArICc7ICcgKyBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIGdvVG9Vc2VycygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ29Ub1VzZXJzKCkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdtYW5hZ2UudXNlcnMnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNhdmUoKSB7XG5cbiAgICAgICAgICAgIGlmICghY2FuU2F2ZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRxLndoZW4obnVsbCk7XG4gICAgICAgICAgICB9IC8vIE11c3QgcmV0dXJuIGEgcHJvbWlzZVxuXG4gICAgICAgICAgICB2bS5pc1NhdmluZyA9IHRydWU7XG5cbiAgICAgICAgICAgIHJldHVybiB2bS51c2VyLnNhdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2bS5pc1NhdmluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgZ29Ub1VzZXJzKCk7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB2bS5pc1NhdmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQoKSB7XG4gICAgICAgICAgICByZXR1cm4gRGlhbG9nLnJlc2V0UGFzc3dvcmREaWFsb2coKVxuICAgICAgICAgICAgICAgIC50aGVuKHBhdGNoUmVzZXR0ZWRQYXNzd29yZCk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHBhdGNoUmVzZXR0ZWRQYXNzd29yZChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0udXNlci5vbmUoJ3Bhc3N3b3JkJykucGF0Y2goZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocGFzc3dvcmRXYXNSZXNldHRlZCk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBwYXNzd29yZFdhc1Jlc2V0dGVkKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tbW9uLmxvZ2dlci5pbmZvKCdQYXN3b29yZCBvcG5pZXV3IGluZ2VzdGVsZCB2b29yICcgKyB1c2VyLmZ1bGxfbmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgICAgICAgcmV0dXJuIERpYWxvZy5kZWxldGVEaWFsb2codm0udXNlci5mdWxsX25hbWUpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVtb3ZlVXNlcik7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlbW92ZVVzZXIoKSB7XG4gICAgICAgICAgICAgICAgdm0udXNlci5yZW1vdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdm0udXNlci5jbGVhckNhY2hlKCk7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKHZtLnVzZXIuZnVsbF9uYW1lICsgJyB3ZXJkIG1ldCBzdWNjZXMgdmVyd2lqZGVyZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgZ29Ub1VzZXJzKCk7XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIERpYWxvZy5jb25maXJtYXRpb25EaWFsb2coJ1ZlcndpamRlcmVuIG1pc2x1a3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ0hldCB2ZXJ3aWpkZXJlbiB2YW4gJyArIHZtLnVzZXIuZnVsbF9uYW1lICsgJyBpcyBtaXNsdWt0LiBQcm9iZWVyIGhldCBsYXRlciBvcG5pZXV3LicpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZGVmYXVsdFVzZXJuYW1lKCkge1xuICAgICAgICAgICAgaWYodm0udXNlci51c2VybmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2bS51c2VyLnVzZXJuYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZtLnVzZXIuZmlyc3RcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMubWFuYWdlXG4gKiBDT05UUk9MTEVSOiBVc2Vyc0NvbnRyb2xsZXJcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy5tYW5hZ2UnKVxuICAgICAgICAuY29udHJvbGxlcignVXNlcnNDb250cm9sbGVyJywgVXNlcnNDb250cm9sbGVyKTtcblxuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gVXNlcnNDb250cm9sbGVyKCRzdGF0ZSwgY29uZmlnLCBjb21tb24sIFVzZXIpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdmFyIGtleUNvZGVzID0gY29uZmlnLmtleUNvZGVzO1xuICAgICAgICB2YXIgZXZlbnRzID0gY29uZmlnLmV2ZW50cztcblxuICAgICAgICB2bS5maWx0ZXJlZFVzZXJzID0gW107XG4gICAgICAgIHZtLmdvdG9Vc2VyID0gZ290b1VzZXI7XG4gICAgICAgIHZtLnJlZnJlc2ggPSByZWZyZXNoO1xuICAgICAgICB2bS5zZWFyY2ggPSBzZWFyY2g7XG4gICAgICAgIHZtLnVzZXJTZWFyY2ggPSAnJztcbiAgICAgICAgdm0udXNlcnMgPSBbXTtcblxuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgICBjb21tb24uJGJyb2FkY2FzdChldmVudHMuY29udHJvbGxlckFjdGl2YXRlU3VjY2Vzcyk7XG4gICAgICAgICAgICBnZXRVc2VycygpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYXBwbHlGaWx0ZXIoKSB7XG4gICAgICAgICAgICB2bS5maWx0ZXJlZFVzZXJzID0gdm0udXNlcnMuZmlsdGVyKHVzZXJGaWx0ZXIpO1xuICAgICAgICB9XG5cblxuICAgICAgICBmdW5jdGlvbiBnZXRVc2Vycyhmb3JjZVJlZnJlc2gpIHtcbiAgICAgICAgICAgIHZtLmxvYWRpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBpZiAoZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZtLnVzZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLnVzZXJzLmNsZWFyQ2FjaGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBVc2VyLmdldExpc3QoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0udXNlcnMgPSB2bS5maWx0ZXJlZFVzZXJzID0gZGF0YTtcbiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdm0udXNlcnM7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgZnVuY3Rpb24gZ290b1VzZXIodXNlcikge1xuICAgICAgICAgICAgaWYgKHVzZXIgJiYgdXNlci5pZCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnbWFuYWdlLnVzZXJzLmRldGFpbCcsIHtpZDogdXNlci5pZH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVmcmVzaCgpIHtcbiAgICAgICAgICAgIHZtLnVzZXJTZWFyY2ggPSAnJztcbiAgICAgICAgICAgIGdldFVzZXJzKHRydWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2VhcmNoKCRldmVudCkge1xuICAgICAgICAgICAgaWYgKCRldmVudC5rZXlDb2RlID09PSBrZXlDb2Rlcy5lc2MpIHtcbiAgICAgICAgICAgICAgICB2bS51c2VyU2VhcmNoID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhcHBseUZpbHRlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXNlckZpbHRlcih1c2VyKSB7XG4gICAgICAgICAgICB2YXIgaXNNYXRjaCA9IHRydWU7XG4gICAgICAgICAgICBpZiAodm0udXNlclNlYXJjaCkge1xuICAgICAgICAgICAgICAgIGlzTWF0Y2ggPSBjb21tb24udGV4dENvbnRhaW5zKHVzZXIubmFtZSwgdm0udXNlclNlYXJjaCk7XG4gICAgICAgICAgICAgICAgaXNNYXRjaCB8PSBjb21tb24udGV4dENvbnRhaW5zKHVzZXIudXNlcm5hbWUsIHZtLnVzZXJTZWFyY2gpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gaXNNYXRjaDtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMud2lkZ2V0c1xuICogRElSRUNUSVZFOiBudEZhXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMud2lkZ2V0cycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ250RmEnLCBudEZhKTtcblxuICAgIG50RmEuJGluamVjdCA9IFtdO1xuXG4gICAgZnVuY3Rpb24gbnRGYSgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBsaW5rOiBsaW5rRnVuY1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHZhciBpID0gYW5ndWxhci5lbGVtZW50KCc8aSBjbGFzcz1cImZhXCIgLz4nKTtcbiAgICAgICAgICAgIHZhciBjbGFzc2VzID0gYXR0cnMubmFtZS5zcGxpdCgnICcpO1xuXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goY2xhc3NlcywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaS5hZGRDbGFzcygnZmEtJyArIHZhbHVlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBlbGVtZW50LnJlcGxhY2VXaXRoKGkpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuIiwiLyoqXG4gKiBub3Rvc3BsdXMud2lkZ2V0c1xuICogRElSRUNUSVZFOiBudFNwaW5uZXJcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zcGx1cy53aWRnZXRzJylcbiAgICAgICAgLmRpcmVjdGl2ZSgnbnRTcGlubmVyJywgbnRTcGlubmVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIG50U3Bpbm5lcigpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgY29tcGlsZTogY29tcGlsZVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgZnVuY3Rpb24gY29tcGlsZShlbGVtLCBhdHRycykge1xuICAgICAgICAgICAgaWYgKGVsZW1bMF0udGFnTmFtZSA9PT0gJ1RBQkxFJykge1xuICAgICAgICAgICAgICAgIGFkZFNwaW5uZXJUb1RCb2R5KGVsZW0sIGF0dHJzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWRkU3Bpbm5lclRvRWxlbWVudChlbGVtLCBhdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBhZGRTcGlubmVyVG9UQm9keShlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgdmFyIHRib2R5ID0gZWxlbWVudC5maW5kKCd0Ym9keScpO1xuICAgICAgICAgICAgdmFyIGh0bWwgPSBbJzx0ciBuZy1zaG93PVwiJyArIGF0dHJzLnNwaW5uZXJTaG93ICsgJ1wiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZCAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYXR0cnMuaGFzT3duUHJvcGVydHkoJ2NvbHNwYW4nKSA/ICdjb2xzcGFuPVwiJyArIGF0dHJzLmNvbHNwYW4gKyAnXCIgJyA6ICcnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPVwidGV4dC1hbGlnbjpjZW50ZXJcIj4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGltZyBzcmM9XCIvaW1nL2J1c3kvYnVzeWF0b20uZ2lmXCIgc3R5bGU9XCJ3aWR0aDo0MHB4O2hlaWdodDo0MHB4O1wiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvdGQ+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L3RyPiddLmpvaW4oJycpO1xuXG4gICAgICAgICAgICB0Ym9keS5wcmVwZW5kKGh0bWwpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGFkZFNwaW5uZXJUb0VsZW1lbnQoZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHZhciBodG1sID0gWyc8ZGl2IG5nLXNob3c9XCInICsgYXR0cnMuc3Bpbm5lclNob3cgKyAnXCIgY2xhc3M9XCJjb2wtbWQtMTIgdGV4dC1jZW50ZXJcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGltZyBzcmM9XCIvaW1nL2J1c3kvYnVzeWF0b20uZ2lmXCIgc3R5bGU9XCJ3aWR0aDo0MHB4O2hlaWdodDo0MHB4O1wiPicsXG4gICAgICAgICAgICAgICAgJzwvZGl2PicsXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjbGVhcmZpeFwiPjwvZGl2PiddLmpvaW4oJycpO1xuXG4gICAgICAgICAgICBlbGVtZW50LnByZXBlbmQoaHRtbCk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG4iLCIvKipcbiAqIG5vdG9zcGx1cy53aWRnZXRzXG4gKiBGQUNUT1JZOiBzcGlubmVyU2VydmljZVxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMud2lkZ2V0cycpXG4gICAgICAgIC5mYWN0b3J5KCdzcGlubmVyU2VydmljZScsIHNwaW5uZXJTZXJ2aWNlKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIHNwaW5uZXJTZXJ2aWNlKCkge1xuICAgICAgICB2YXIgc3Bpbm5lcnMgPSB7fTtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBfcmVnaXN0ZXI6IHJlZ2lzdGVyLFxuICAgICAgICAgICAgX3VucmVnaXN0ZXI6IHVucmVnaXN0ZXIsXG4gICAgICAgICAgICBfdW5yZWdpc3RlckFsbDogdW5yZWdpc3RlckFsbCxcbiAgICAgICAgICAgIHNob3c6IHNob3csXG4gICAgICAgICAgICBoaWRlOiBoaWRlLFxuICAgICAgICAgICAgc2hvd0dyb3VwOiBzaG93R3JvdXAsXG4gICAgICAgICAgICBoaWRlR3JvdXA6IGhpZGVHcm91cCxcbiAgICAgICAgICAgIHNob3dBbGw6IHNob3dBbGwsXG4gICAgICAgICAgICBoaWRlQWxsOiBoaWRlQWxsXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXIoZGF0YSkge1xuICAgICAgICAgICAgaWYoIWRhdGEuaGFzT3duUHJvcGVydHkoJ25hbWUnKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU3Bpbm5lciBtdXN0IHNwZWNpZnkgYSBuYW1lIHdoZW4gcmVnaXN0ZXJpbmcgd2l0aCB0aGUgc3Bpbm5lciBzZXJ2aWNlLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoc3Bpbm5lcnMuaGFzT3duUHJvcGVydHkoZGF0YS5uYW1lKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQSBzcGlubmVyIHdpdGggdGhlIG5hbWUgXCInICsgZGF0YS5uYW1lICsgJ1wiIGhhcyBhbHJlYWR5IGJlZW4gcmVnaXN0ZXJlZC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNwaW5uZXJzW2RhdGEubmFtZV0gPSBkYXRhO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdW5yZWdpc3RlcihuYW1lKSB7XG4gICAgICAgICAgICBpZihzcGlubmVycy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBzcGlubmVyc1tuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVucmVnaXN0ZXJBbGwoKSB7XG4gICAgICAgICAgICBmb3IodmFyIG5hbWUgaW4gc3Bpbm5lcnMpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgc3Bpbm5lcnNbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzaG93KG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBzcGlubmVyICA9IHNwaW5uZXJzW25hbWVdO1xuICAgICAgICAgICAgaWYoIXNwaW5uZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAgbmV3IEVycm9yKCdObyBzcGlubmVyIG5hbWVkIFwiJyArIG5hbWUgKyAnXCIgaXMgcmVnaXN0ZXJlZC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNwaW5uZXIuc2hvdygpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGlkZShuYW1lKSB7XG4gICAgICAgICAgICB2YXIgc3Bpbm5lciAgPSBzcGlubmVyc1tuYW1lXTtcbiAgICAgICAgICAgIGlmKCFzcGlubmVyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgIG5ldyBFcnJvcignTm8gc3Bpbm5lciBuYW1lZCBcIicgKyBuYW1lICsgJ1wiIGlzIHJlZ2lzdGVyZWQuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNob3dHcm91cChncm91cCkge1xuICAgICAgICAgICAgdmFyIGdyb3VwRXhpc3RzID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IodmFyIG5hbWUgaW4gc3Bpbm5lcnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3Bpbm5lciA9IHNwaW5uZXJzW25hbWVdO1xuICAgICAgICAgICAgICAgIGlmKHNwaW5uZXIuZ3JvdXAgPT09IGdyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwaW5uZXIuc2hvdygpO1xuICAgICAgICAgICAgICAgICAgICBncm91cEV4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoIWdyb3VwRXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBzcGlubmVycyBmb3VuZCB3aXRoIGdyb3VwIFwiJyArIGdyb3VwICsgJ1wiLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhpZGVHcm91cChncm91cCkge1xuICAgICAgICAgICAgdmFyIGdyb3VwRXhpc3RzID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IodmFyIG5hbWUgaW4gc3Bpbm5lcnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3Bpbm5lciA9IHNwaW5uZXJzW25hbWVdO1xuICAgICAgICAgICAgICAgIGlmKHNwaW5uZXIuZ3JvdXAgPT09IGdyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBncm91cEV4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoIWdyb3VwRXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBzcGlubmVycyBmb3VuZCB3aXRoIGdyb3VwIFwiJyArIGdyb3VwICsgJ1wiLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNob3dBbGwoKSB7XG4gICAgICAgICAgICBmb3IodmFyIG5hbWUgaW4gc3Bpbm5lcnMpIHtcbiAgICAgICAgICAgICAgICBzcGlubmVyc1tuYW1lXS5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaGlkZUFsbCgpIHtcbiAgICAgICAgICAgIGZvcih2YXIgbmFtZSBpbiBzcGlubmVycykge1xuICAgICAgICAgICAgICAgIHNwaW5uZXJzW25hbWVdLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvc3BsdXMud2lkZ2V0c1xuICogRElSRUNUSVZFOiBudE1pbmlTaWRlQmFyXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMud2lkZ2V0cycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ250TWluaVNpZGViYXInLCBudE1pbmlTaWRlYmFyKTtcblxuICAgIGZ1bmN0aW9uIG50TWluaVNpZGViYXIoKSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgdGVtcGxhdGU6IFtcbiAgICAgICAgICAgICAgICAnPGEgY2xhc3M9XCJuYXZiYXItbWluaW1hbGl6ZSBtaW5pbWFsaXplLXN0eWwtMiBidG4gYnRuLXByaW1hcnlcIiBocmVmPVwiXCIgbmctY2xpY2s9XCJ2bS5taW5pbWFsaXplKClcIj4nLFxuICAgICAgICAgICAgICAgICc8aSBjbGFzcz1cImZhIGZhLWJhcnNcIj48L2k+JyxcbiAgICAgICAgICAgICAgICAnPC9hPidcbiAgICAgICAgICAgIF0uam9pbignJyksXG5cbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IE1pbmltaXplQ29udHJvbGxlcixcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUgLy8gYmVjYXVzZSB0aGUgc2NvcGUgaXMgaXNvbGF0ZWRcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgLyogQG5nSW5qZWN0ICovXG4gICAgICAgIGZ1bmN0aW9uIE1pbmltaXplQ29udHJvbGxlcigkdGltZW91dCkge1xuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgICAgIHZtLm1pbmltYWxpemUgPSBtaW5pbWFsaXplO1xuXG4gICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgICAgICBmdW5jdGlvbiBtaW5pbWFsaXplKCkge1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnYm9keScpLnRvZ2dsZUNsYXNzKCdtaW5pLW5hdmJhcicpO1xuICAgICAgICAgICAgICAgIGlmICghYW5ndWxhci5lbGVtZW50KCdib2R5JykuaGFzQ2xhc3MoJ21pbmktbmF2YmFyJykgfHwgYW5ndWxhci5lbGVtZW50KCdib2R5JykuaGFzQ2xhc3MoJ2JvZHktc21hbGwnKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBIaWRlIG1lbnUgaW4gb3JkZXIgdG8gc21vb3RobHkgdHVybiBvbiB3aGVuIG1heGltaXplIG1lbnVcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCcjc2lkZS1tZW51JykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3Igc21vb3RobHkgdHVybiBvbiBtZW51XG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnI3NpZGUtbWVudScpLmZhZGVJbig1MDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFuZ3VsYXIuZWxlbWVudCgnYm9keScpLmhhc0NsYXNzKCdmaXhlZC1zaWRlYmFyJykpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCcjc2lkZS1tZW51JykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJyNzaWRlLW1lbnUnKS5mYWRlSW4oNTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBpbmxpbmUgc3R5bGUgZnJvbSBqcXVlcnkgZmFkZUluIGZ1bmN0aW9uIHRvIHJlc2V0IG1lbnUgc3RhdGVcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCcjc2lkZS1tZW51JykucmVtb3ZlQXR0cignc3R5bGUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG4iLCIvKipcbiAqIG5vdG9zcGx1c1xuICogRElSRUNUSVZFOiBudFNpZGVOYXZpZ2F0aW9uXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvc3BsdXMud2lkZ2V0cycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ250U2lkZU5hdmlnYXRpb24nLCBudFNpZGVOYXZpZ2F0aW9uKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIG50U2lkZU5hdmlnYXRpb24oJHRpbWVvdXQpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgbGluazogbGlua0Z1bmNcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gbGlua0Z1bmMoc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLm1ldGlzTWVudSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=